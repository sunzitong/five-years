function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,t=function(){};return{s:t,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){o=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw r}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ownKeys(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).adapter=e()}(function(){return function i(r,a,o){function s(t,e){if(!a[t]){if(!r[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=a[t]={exports:{}},r[t][0].call(n.exports,function(e){return s(r[t][1][e]||e)},n,n.exports,i,r,a,o)}return a[t].exports}for(var c="function"==typeof require&&require,e=0;e<o.length;e++)s(o[e]);return s}({1:[function(e,t,n){"use strict";e=(0,e("./adapter_factory.js").adapterFactory)({window:window});t.exports=e},{"./adapter_factory.js":2}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.adapterFactory=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).window,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},n=a.log,i=a.detectBrowser(e),r={browserDetails:i,commonShim:d,extractVersion:a.extractVersion,disableLog:a.disableLog,disableWarnings:a.disableWarnings};switch(i.browser){case"chrome":if(!o||!o.shimPeerConnection||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),r;n("adapter.js shimming chrome."),(r.browserShim=o).shimGetUserMedia(e),o.shimMediaStream(e),o.shimPeerConnection(e),o.shimOnTrack(e),o.shimAddTrackRemoveTrack(e),o.shimGetSendersWithDtmf(e),o.shimGetStats(e),o.shimSenderReceiverGetStats(e),o.fixNegotiationNeeded(e),d.shimRTCIceCandidate(e),d.shimConnectionState(e),d.shimMaxMessageSize(e),d.shimSendThrowTypeError(e),d.removeAllowExtmapMixed(e);break;case"firefox":if(!c||!c.shimPeerConnection||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),r;n("adapter.js shimming firefox."),(r.browserShim=c).shimGetUserMedia(e),c.shimPeerConnection(e),c.shimOnTrack(e),c.shimRemoveStream(e),c.shimSenderGetStats(e),c.shimReceiverGetStats(e),c.shimRTCDataChannel(e),c.shimAddTransceiver(e),c.shimCreateOffer(e),c.shimCreateAnswer(e),d.shimRTCIceCandidate(e),d.shimConnectionState(e),d.shimMaxMessageSize(e),d.shimSendThrowTypeError(e);break;case"edge":if(!s||!s.shimPeerConnection||!t.shimEdge)return n("MS edge shim is not included in this adapter release."),r;n("adapter.js shimming edge."),(r.browserShim=s).shimGetUserMedia(e),s.shimGetDisplayMedia(e),s.shimPeerConnection(e),s.shimReplaceTrack(e),d.shimMaxMessageSize(e),d.shimSendThrowTypeError(e);break;case"safari":if(!l||!t.shimSafari)return n("Safari shim is not included in this adapter release."),r;n("adapter.js shimming safari."),(r.browserShim=l).shimRTCIceServerUrls(e),l.shimCreateOfferLegacy(e),l.shimCallbacksAPI(e),l.shimLocalStreamsAPI(e),l.shimRemoteStreamsAPI(e),l.shimTrackEventTransceiver(e),l.shimGetUserMedia(e),d.shimRTCIceCandidate(e),d.shimMaxMessageSize(e),d.shimSendThrowTypeError(e),d.removeAllowExtmapMixed(e);break;default:n("Unsupported browser!")}return r};var a=i(e("./utils")),o=i(e("./chrome/chrome_shim")),s=i(e("./edge/edge_shim")),c=i(e("./firefox/firefox_shim")),l=i(e("./safari/safari_shim")),d=i(e("./common_shim"));function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=n.shimGetUserMedia=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("./getusermedia");Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}});var r=e("./getdisplaymedia");Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return r.shimGetDisplayMedia}}),n.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},n.shimOnTrack=function(a){{var e;"object"!==(void 0===a?"undefined":s(a))||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype?c.wrapPeerConnectionEvent(a,"track",function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}):(Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0}),e=a.RTCPeerConnection.prototype.setRemoteDescription,a.RTCPeerConnection.prototype.setRemoteDescription=function(){var r=this;return this._ontrackpoly||(this._ontrackpoly=function(i){i.stream.addEventListener("addtrack",function(t){var e=void 0,e=a.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find(function(e){return e.track&&e.track.id===t.track.id}):{track:t.track},n=new Event("track");n.track=t.track,n.receiver=e,n.transceiver={receiver:e},n.streams=[i.stream],r.dispatchEvent(n)}),i.stream.getTracks().forEach(function(t){var e=void 0,e=a.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find(function(e){return e.track&&e.track.id===t.id}):{track:t},n=new Event("track");n.track=t,n.receiver=e,n.transceiver={receiver:e},n.streams=[i.stream],r.dispatchEvent(n)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)})}},n.shimGetSendersWithDtmf=function(e){{var i,r,t,n,a,o;"object"===(void 0===e?"undefined":s(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype?(i=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}},e.RTCPeerConnection.prototype.getSenders||(e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()},r=e.RTCPeerConnection.prototype.addTrack,e.RTCPeerConnection.prototype.addTrack=function(e,t){var n=r.apply(this,arguments);return n||(n=i(this,e),this._senders.push(n)),n},t=e.RTCPeerConnection.prototype.removeTrack,e.RTCPeerConnection.prototype.removeTrack=function(e){t.apply(this,arguments);e=this._senders.indexOf(e);-1!==e&&this._senders.splice(e,1)}),n=e.RTCPeerConnection.prototype.addStream,e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach(function(e){t._senders.push(i(t,e))})},a=e.RTCPeerConnection.prototype.removeStream,e.RTCPeerConnection.prototype.removeStream=function(e){var n=this;this._senders=this._senders||[],a.apply(this,[e]),e.getTracks().forEach(function(t){var e=n._senders.find(function(e){return e.track===t});e&&n._senders.splice(n._senders.indexOf(e),1)})}):"object"===(void 0===e?"undefined":s(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&(o=e.RTCPeerConnection.prototype.getSenders,e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=o.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}}))}},n.shimGetStats=function(e){var o;e.RTCPeerConnection&&(o=e.RTCPeerConnection.prototype.getStats,e.RTCPeerConnection.prototype.getStats=function(){var n=this,e=Array.prototype.slice.call(arguments),t=e[0],i=e[1],e=e[2];if(0<arguments.length&&"function"==typeof t)return o.apply(this,arguments);if(0===o.length&&(0===arguments.length||"function"!=typeof t))return o.apply(this,[]);var r=function(e){var i={};return e.result().forEach(function(t){var n={id:t.id,timestamp:t.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type};t.names().forEach(function(e){n[e]=t.stat(e)}),i[n.id]=n}),i},a=function(t){return new Map(Object.keys(t).map(function(e){return[e,t[e]]}))};if(2<=arguments.length)return o.apply(this,[function(e){i(a(r(e)))},t]);return new Promise(function(t,e){o.apply(n,[function(e){t(a(r(e)))},e])}).then(i,e)})},n.shimSenderReceiverGetStats=function(e){var n,t,i,a;"object"===(void 0===e?"undefined":s(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver&&("getStats"in e.RTCRtpSender.prototype||((n=e.RTCPeerConnection.prototype.getSenders)&&(e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=n.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),(t=e.RTCPeerConnection.prototype.addTrack)&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=t.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(e){return c.filterStats(e,t.track,!0)})}),"getStats"in e.RTCRtpReceiver.prototype||((i=e.RTCPeerConnection.prototype.getReceivers)&&(e.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=i.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),c.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(e){return c.filterStats(e,t.track,!1)})}),"getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype&&(a=e.RTCPeerConnection.prototype.getStats,e.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],n=void 0,i=void 0,r=void 0;return this.getSenders().forEach(function(e){e.track===t&&(n?r=!0:n=e)}),this.getReceivers().forEach(function(e){return e.track===t&&(i?r=!0:i=e),e.track===t}),r||n&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):n?n.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return a.apply(this,arguments)}))},n.shimAddTrackRemoveTrackWithNative=d,n.shimAddTrackRemoveTrack=function(r){if(r.RTCPeerConnection){var e=c.detectBrowser(r);if(r.RTCPeerConnection.prototype.addTrack&&65<=e.version)return d(r);var n=r.RTCPeerConnection.prototype.getLocalStreams;r.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this,e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(function(e){return t._reverseStreams[e.id]})};var i=r.RTCPeerConnection.prototype.addStream;r.RTCPeerConnection.prototype.addStream=function(e){var t,n=this;this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},e.getTracks().forEach(function(t){if(n.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")}),this._reverseStreams[e.id]||(t=new r.MediaStream(e.getTracks()),this._streams[e.id]=t,this._reverseStreams[t.id]=e,e=t),i.apply(this,[e])};var t=r.RTCPeerConnection.prototype.removeStream;r.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[(this._streams[e.id]||e).id],delete this._streams[e.id]},r.RTCPeerConnection.prototype.addTrack=function(t,e){var n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};i=this._streams[e.id];return i?(i.addTrack(t),Promise.resolve().then(function(){n.dispatchEvent(new Event("negotiationneeded"))})):(i=new r.MediaStream([t]),this._streams[e.id]=i,this._reverseStreams[i.id]=e,this.addStream(i)),this.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(e){var i=r.RTCPeerConnection.prototype[e],t=l({},e,function(){var t=this,n=arguments;return arguments.length&&"function"==typeof arguments[0]?i.apply(this,[function(e){e=s(t,e);n[0].apply(null,[e])},function(e){n[1]&&n[1].apply(null,e)},arguments[2]]):i.apply(this,arguments).then(function(e){return s(t,e)})});r.RTCPeerConnection.prototype[e]=t[e]});var a=r.RTCPeerConnection.prototype.setLocalDescription;r.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type&&(arguments[0]=(n=this,i=(e=arguments[0]).sdp,Object.keys(n._reverseStreams||[]).forEach(function(e){var t=n._reverseStreams[e],e=n._streams[t.id];i=i.replace(new RegExp(t.id,"g"),e.id)}),new RTCSessionDescription({type:e.type,sdp:i}))),a.apply(this,arguments);var n,e,i};var o=Object.getOwnPropertyDescriptor(r.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(r.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=o.get.apply(this);return""===e.type?e:s(this,e)}}),r.RTCPeerConnection.prototype.removeTrack=function(t){var n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!t._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(t._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var i=void 0;Object.keys(this._streams).forEach(function(e){n._streams[e].getTracks().find(function(e){return t.track===e})&&(i=n._streams[e])}),i&&(1===i.getTracks().length?this.removeStream(this._reverseStreams[i.id]):i.removeTrack(t.track),this.dispatchEvent(new Event("negotiationneeded")))}}function s(n,e){var i=e.sdp;return Object.keys(n._reverseStreams||[]).forEach(function(e){var t=n._reverseStreams[e],e=n._streams[t.id];i=i.replace(new RegExp(e.id,"g"),t.id)}),new RTCSessionDescription({type:e.type,sdp:i})}},n.shimPeerConnection=function(i){var e,t=c.detectBrowser(i);!i.RTCPeerConnection&&i.webkitRTCPeerConnection&&(i.RTCPeerConnection=i.webkitRTCPeerConnection);i.RTCPeerConnection&&(t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=i.RTCPeerConnection.prototype[e],n=l({},e,function(){return arguments[0]=new("addIceCandidate"===e?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)});i.RTCPeerConnection.prototype[e]=n[e]}),e=i.RTCPeerConnection.prototype.addIceCandidate,i.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})},n.fixNegotiationNeeded=function(e){c.wrapPeerConnectionEvent(e,"negotiationneeded",function(e){if("stable"===e.target.signalingState)return e})};var c=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("../utils.js"));function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(e){return t._shimmedLocalStreams[e][0]})};var i=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,t){if(!t)return i.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=i.apply(this,arguments);return this._shimmedLocalStreams[t.id]?-1===this._shimmedLocalStreams[t.id].indexOf(n)&&this._shimmedLocalStreams[t.id].push(n):this._shimmedLocalStreams[t.id]=[t,n],n};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(function(t){if(n.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")});var t=this.getSenders();r.apply(this,arguments);var i=this.getSenders().filter(function(e){return-1===t.indexOf(e)});this._shimmedLocalStreams[e.id]=[e].concat(i)};var t=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],t.apply(this,arguments)};var a=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(n){var i=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},n&&Object.keys(this._shimmedLocalStreams).forEach(function(e){var t=i._shimmedLocalStreams[e].indexOf(n);-1!==t&&i._shimmedLocalStreams[e].splice(t,1),1===i._shimmedLocalStreams[e].length&&delete i._shimmedLocalStreams[e]}),a.apply(this,arguments)}}},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(a,e){a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices||a.navigator.mediaDevices&&("function"==typeof e?a.navigator.mediaDevices.getDisplayMedia=function(r){return e(r).then(function(e){var t=r.video&&r.video.width,n=r.video&&r.video.height,i=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxFrameRate:i||3}},t&&(r.video.mandatory.maxWidth=t),n&&(r.video.mandatory.maxHeight=n),a.navigator.mediaDevices.getUserMedia(r)})}:void 0)}},{}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.shimGetUserMedia=function(e){var t,o,i,r,n,s=e&&e.navigator;s.mediaDevices&&(t=a.detectBrowser(e),o=function(r){if("object"!==(void 0===r?"undefined":c(r))||r.mandatory||r.optional)return r;var a={};return Object.keys(r).forEach(function(t){var n,i,e;"require"!==t&&"advanced"!==t&&"mediaSource"!==t&&(void 0!==(n="object"===c(r[t])?r[t]:{ideal:r[t]}).exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact),i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t},void 0!==n.ideal&&(a.optional=a.optional||[],e={},"number"==typeof n.ideal?(e[i("min",t)]=n.ideal,a.optional.push(e),(e={})[i("max",t)]=n.ideal):e[i("",t)]=n.ideal,a.optional.push(e)),void 0!==n.exact&&"number"!=typeof n.exact?(a.mandatory=a.mandatory||{},a.mandatory[i("",t)]=n.exact):["min","max"].forEach(function(e){void 0!==n[e]&&(a.mandatory=a.mandatory||{},a.mandatory[i(e,t)]=n[e])}))}),r.advanced&&(a.optional=(a.optional||[]).concat(r.advanced)),a},i=function(n,i){if(61<=t.version)return i(n);if((n=JSON.parse(JSON.stringify(n)))&&"object"===c(n.audio)&&((e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])})((n=JSON.parse(JSON.stringify(n))).audio,"autoGainControl","googAutoGainControl"),e(n.audio,"noiseSuppression","googNoiseSuppression"),n.audio=o(n.audio)),n&&"object"===c(n.video)){var r=(r=n.video.facingMode)&&("object"===(void 0===r?"undefined":c(r))?r:{ideal:r}),e=t.version<66;if(r&&("user"===r.exact||"environment"===r.exact||"user"===r.ideal||"environment"===r.ideal)&&(!s.mediaDevices.getSupportedConstraints||!s.mediaDevices.getSupportedConstraints().facingMode||e)){delete n.video.facingMode;var a=void 0;if("environment"===r.exact||"environment"===r.ideal?a=["back","rear"]:"user"!==r.exact&&"user"!==r.ideal||(a=["front"]),a)return s.mediaDevices.enumerateDevices().then(function(e){var t=(e=e.filter(function(e){return"videoinput"===e.kind})).find(function(t){return a.some(function(e){return t.label.toLowerCase().includes(e)})});return(t=!t&&e.length&&a.includes("back")?e[e.length-1]:t)&&(n.video.deviceId=r.exact?{exact:t.deviceId}:{ideal:t.deviceId}),n.video=o(n.video),l("chrome: "+JSON.stringify(n)),i(n)})}n.video=o(n.video)}return l("chrome: "+JSON.stringify(n)),i(n)},r=function(e){return 64<=t.version?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},s.getUserMedia=function(e,t,n){i(e,function(e){s.webkitGetUserMedia(e,t,function(e){n&&n(r(e))})})}.bind(s),s.mediaDevices.getUserMedia&&(n=s.mediaDevices.getUserMedia.bind(s.mediaDevices),s.mediaDevices.getUserMedia=function(e){return i(e,function(t){return n(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return e},function(e){return Promise.reject(r(e))})})}))};var a=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("../utils.js"));var l=a.log},{"../utils.js":15}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.shimRTCIceCandidate=function(t){var r;!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype||(r=t.RTCIceCandidate,t.RTCIceCandidate=function(e){if("object"===(void 0===e?"undefined":a(e))&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var t=new r(e),n=o.default.parseCandidate(e.candidate),i=Object.assign(t,n);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new r(e)},t.RTCIceCandidate.prototype=r.prototype,s.wrapPeerConnectionEvent(t,"icecandidate",function(e){return e.candidate&&Object.defineProperty(e,"candidate",{value:new t.RTCIceCandidate(e.candidate),writable:"false"}),e}))},n.shimMaxMessageSize=function(e){var r,a;e.RTCPeerConnection&&(r=s.detectBrowser(e),"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}}),a=e.RTCPeerConnection.prototype.setRemoteDescription,e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e,t,n,i;return this._sctp=null,"chrome"===r.browser&&76<=r.version&&"plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0}),function(e){if(!e||!e.sdp)return!1;e=o.default.splitSections(e.sdp);return e.shift(),e.some(function(e){e=o.default.parseMLine(e);return e&&"application"===e.kind&&-1!==e.protocol.indexOf("SCTP")})}(arguments[0])&&(t=function(e){e=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===e||e.length<2)return-1;e=parseInt(e[1],10);return e!=e?-1:e}(arguments[0]),n=t,i=65536,i=i="firefox"===r.browser?r.version<57?-1===n?16384:2147483637:r.version<60?57===r.version?65535:65536:2147483637:i,t=function(e,t){var n=65536;"firefox"===r.browser&&57===r.version&&(n=65535);e=o.default.matchPrefix(e.sdp,"a=max-message-size:");return 0<e.length?n=parseInt(e[0].substr(19),10):"firefox"===r.browser&&-1!==t&&(n=2147483637),n}(arguments[0],t),e=void 0,e=0===i&&0===t?Number.POSITIVE_INFINITY:0===i||0===t?Math.max(i,t):Math.min(i,t),t={},Object.defineProperty(t,"maxMessageSize",{get:function(){return e}}),this._sctp=t),a.apply(this,arguments)})},n.shimSendThrowTypeError=function(e){var t;function n(t,n){var i=t.send;t.send=function(){var e=arguments[0],e=e.length||e.size||e.byteLength;if("open"===t.readyState&&n.sctp&&e>n.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+n.sctp.maxMessageSize+" bytes)");return i.apply(t,arguments)}}e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype&&(t=e.RTCPeerConnection.prototype.createDataChannel,e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return n(e,this),e},s.wrapPeerConnectionEvent(e,"datachannel",function(e){return n(e.channel,e.target),e}))},n.shimConnectionState=function(e){var n;!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype||(n=e.RTCPeerConnection.prototype,Object.defineProperty(n,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(n,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(e){var t=n[e];n[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t,n=e.target;return n._lastConnectionState!==n.connectionState&&(n._lastConnectionState=n.connectionState,t=new Event("connectionstatechange",e),n.dispatchEvent(t)),e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),t.apply(this,arguments)}}))},n.removeAllowExtmapMixed=function(e){var t,n;e.RTCPeerConnection&&("chrome"===(t=s.detectBrowser(e)).browser&&71<=t.version||(n=e.RTCPeerConnection.prototype.setRemoteDescription,e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter(function(e){return"a=extmap-allow-mixed"!==e.trim()}).join("\n")),n.apply(this,arguments)}))};var i,r=e("sdp"),o=(i=r)&&i.__esModule?i:{default:i},s=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("./utils"))},{"./utils":15,sdp:17}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=n.shimGetUserMedia=void 0;var i=e("./getusermedia");Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}});var r=e("./getdisplaymedia");Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return r.shimGetDisplayMedia}}),n.shimPeerConnection=function(e){var t=o.detectBrowser(e);{var n;e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025&&(n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled"),Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})))}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}});e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var i=(0,l.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,s.filterIceServers)(e.iceServers,t.version),o.log("ICE servers after filtering:",e.iceServers)),new i(e)},e.RTCPeerConnection.prototype=i.prototype},n.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)};var a,o=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("../utils")),s=e("./filtericeservers"),c=e("rtcpeerconnection-shim"),l=(a=c)&&a.__esModule?a:{default:a}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.filterIceServers=function(e,t){var i=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&r.deprecated("RTCIceServer.url","RTCIceServer.urls");var n="string"==typeof t,t=(t=n?[t]:t).filter(function(e){if(0===e.indexOf("stun:"))return!1;e=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return e&&!i&&(i=!0)});return delete e.url,e.urls=n?t[0]:t,!!t.length}})};var r=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("../utils"))},{"../utils":15}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}},{}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var e=e&&e.navigator,t=e.mediaDevices.getUserMedia.bind(e.mediaDevices);e.mediaDevices.getUserMedia=function(e){return t(e).catch(function(e){return Promise.reject({name:{PermissionDeniedError:"NotAllowedError"}[(e=e).name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}})})}}},{}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=n.shimGetUserMedia=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("./getusermedia");Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}});var r=e("./getdisplaymedia");Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return r.shimGetDisplayMedia}}),n.shimOnTrack=function(e){"object"===(void 0===e?"undefined":o(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimPeerConnection=function(i){var e,r,n,a=s.detectBrowser(i);"object"===(void 0===i?"undefined":o(i))&&(i.RTCPeerConnection||i.mozRTCPeerConnection)&&(!i.RTCPeerConnection&&i.mozRTCPeerConnection&&(i.RTCPeerConnection=i.mozRTCPeerConnection),a.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=i.RTCPeerConnection.prototype[e],n=function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}({},e,function(){return arguments[0]=new("addIceCandidate"===e?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)});i.RTCPeerConnection.prototype[e]=n[e]}),a.version<68&&(e=i.RTCPeerConnection.prototype.addIceCandidate,i.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}),r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=i.RTCPeerConnection.prototype.getStats,i.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),t=e[0],i=e[1],e=e[2];return n.apply(this,[t||null]).then(function(n){if(a.version<53&&!i)try{n.forEach(function(e){e.type=r[e.type]||e.type})}catch(e){if("TypeError"!==e.name)throw e;n.forEach(function(e,t){n.set(t,Object.assign({},e,{type:r[e.type]||e.type}))})}return n}).then(i,e)})},n.shimSenderGetStats=function(e){var n,t;"object"===(void 0===e?"undefined":o(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype||((n=e.RTCPeerConnection.prototype.getSenders)&&(e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=n.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),(t=e.RTCPeerConnection.prototype.addTrack)&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=t.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}))},n.shimReceiverGetStats=function(e){var n;"object"===(void 0===e?"undefined":o(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype||((n=e.RTCPeerConnection.prototype.getReceivers)&&(e.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=n.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),s.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}))},n.shimRemoveStream=function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(t){var n=this;s.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(e){e.track&&t.getTracks().includes(e.track)&&n.removeTrack(e)})})},n.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},n.shimAddTransceiver=function(e){var r;"object"!==(void 0===e?"undefined":o(e))||!e.RTCPeerConnection||(r=e.RTCPeerConnection.prototype.addTransceiver)&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],t=e&&"sendEncodings"in e;t&&e.sendEncodings.forEach(function(e){if("rid"in e)if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(1<=parseFloat(e.scaleResolutionDownBy)))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(0<=parseFloat(e.maxFramerate)))throw new RangeError("max_framerate must be >= 0.0")});var n,i=r.apply(this,arguments);return t&&("encodings"in(t=(n=i.sender).getParameters())||(t.encodings=e.sendEncodings,this.setParametersPromises.push(n.setParameters(t).catch(function(){})))),i})},n.shimCreateOffer=function(e){var n;"object"===(void 0===e?"undefined":o(e))&&e.RTCPeerConnection&&(n=e.RTCPeerConnection.prototype.createOffer,e.RTCPeerConnection.prototype.createOffer=function(){var e=this,t=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return n.apply(e,t)}).finally(function(){e.setParametersPromises=[]}):n.apply(this,arguments)})},n.shimCreateAnswer=function(e){var n;"object"===(void 0===e?"undefined":o(e))&&e.RTCPeerConnection&&(n=e.RTCPeerConnection.prototype.createAnswer,e.RTCPeerConnection.prototype.createAnswer=function(){var e=this,t=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return n.apply(e,t)}).finally(function(){e.setParametersPromises=[]}):n.apply(this,arguments)})};var s=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(t,n){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(e){if(e&&e.video)return!0===e.video?e.video={mediaSource:n}:e.video.mediaSource=n,t.navigator.mediaDevices.getUserMedia(e);e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)})}},{}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.shimGetUserMedia=function(e){var t=c.detectBrowser(e),i=e&&e.navigator,e=e&&e.MediaStreamTrack;{var n,r,a,o;i.getUserMedia=function(e,t,n){c.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(e).then(t,n)},55<t.version&&"autoGainControl"in i.mediaDevices.getSupportedConstraints()||(n=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},r=i.mediaDevices.getUserMedia.bind(i.mediaDevices),i.mediaDevices.getUserMedia=function(e){return"object"===(void 0===e?"undefined":s(e))&&"object"===s(e.audio)&&(e=JSON.parse(JSON.stringify(e)),n(e.audio,"autoGainControl","mozAutoGainControl"),n(e.audio,"noiseSuppression","mozNoiseSuppression")),r(e)},e&&e.prototype.getSettings&&(a=e.prototype.getSettings,e.prototype.getSettings=function(){var e=a.apply(this,arguments);return n(e,"mozAutoGainControl","autoGainControl"),n(e,"mozNoiseSuppression","noiseSuppression"),e}),e&&e.prototype.applyConstraints&&(o=e.prototype.applyConstraints,e.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(void 0===e?"undefined":s(e))&&(e=JSON.parse(JSON.stringify(e)),n(e,"autoGainControl","mozAutoGainControl"),n(e,"noiseSuppression","mozNoiseSuppression")),o.apply(this,[e])}))}};var c=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("../utils"))},{"../utils":15}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.shimLocalStreamsAPI=function(e){var i;"object"===(void 0===e?"undefined":c(e))&&e.RTCPeerConnection&&("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),"addStream"in e.RTCPeerConnection.prototype||(i=e.RTCPeerConnection.prototype.addTrack,e.RTCPeerConnection.prototype.addStream=function(t){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getAudioTracks().forEach(function(e){return i.call(n,e,t)}),t.getVideoTracks().forEach(function(e){return i.call(n,e,t)})},e.RTCPeerConnection.prototype.addTrack=function(e){var t=arguments[1];return t&&(this._localStreams?this._localStreams.includes(t)||this._localStreams.push(t):this._localStreams=[t]),i.apply(this,arguments)}),"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var n,i=this._localStreams.indexOf(e);-1!==i&&(this._localStreams.splice(i,1),n=e.getTracks(),this.getSenders().forEach(function(e){n.includes(e.track)&&t.removeTrack(e)}))}))},n.shimRemoteStreamsAPI=function(e){var t;"object"===(void 0===e?"undefined":c(e))&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams||[]}),"onaddstream"in e.RTCPeerConnection.prototype||(Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var n=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){var t;n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.includes(e)||(n._remoteStreams.push(e),(t=new Event("addstream")).stream=e,n.dispatchEvent(t))})})}}),t=e.RTCPeerConnection.prototype.setRemoteDescription,e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){var t;n._remoteStreams||(n._remoteStreams=[]),0<=n._remoteStreams.indexOf(e)||(n._remoteStreams.push(e),(t=new Event("addstream")).stream=e,n.dispatchEvent(t))})}),t.apply(n,arguments)}))},n.shimCallbacksAPI=function(e){var t,i,r,a,o,s;"object"===(void 0===e?"undefined":c(e))&&e.RTCPeerConnection&&(t=e.RTCPeerConnection.prototype,i=t.createOffer,r=t.createAnswer,a=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate,t.createOffer=function(e,t){var n=i.apply(this,[2<=arguments.length?arguments[2]:e]);return t?(n.then(e,t),Promise.resolve()):n},t.createAnswer=function(e,t){var n=r.apply(this,[2<=arguments.length?arguments[2]:e]);return t?(n.then(e,t),Promise.resolve()):n},e=function(e,t,n){e=a.apply(this,[e]);return n?(e.then(t,n),Promise.resolve()):e},t.setLocalDescription=e,e=function(e,t,n){e=o.apply(this,[e]);return n?(e.then(t,n),Promise.resolve()):e},t.setRemoteDescription=e,e=function(e,t,n){e=s.apply(this,[e]);return n?(e.then(t,n),Promise.resolve()):e},t.addIceCandidate=e)},n.shimGetUserMedia=function(e){var i=e&&e.navigator;{var t;i.mediaDevices&&i.mediaDevices.getUserMedia&&(e=i.mediaDevices,t=e.getUserMedia.bind(e),i.mediaDevices.getUserMedia=function(e){return t(r(e))})}!i.getUserMedia&&i.mediaDevices&&i.mediaDevices.getUserMedia&&(i.getUserMedia=function(e,t,n){i.mediaDevices.getUserMedia(e).then(t,n)}.bind(i))},n.shimConstraints=r,n.shimRTCIceServerUrls=function(e){var a=e.RTCPeerConnection;e.RTCPeerConnection=function(e,t){if(e&&e.iceServers){for(var n=[],i=0;i<e.iceServers.length;i++){var r=e.iceServers[i];!r.hasOwnProperty("urls")&&r.hasOwnProperty("url")?(o.deprecated("RTCIceServer.url","RTCIceServer.urls"),(r=JSON.parse(JSON.stringify(r))).urls=r.url,delete r.url,n.push(r)):n.push(e.iceServers[i])}e.iceServers=n}return new a(e,t)},e.RTCPeerConnection.prototype=a.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return a.generateCertificate}})},n.shimTrackEventTransceiver=function(e){"object"===(void 0===e?"undefined":c(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimCreateOfferLegacy=function(e){var n=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){var t;return e&&(void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio),t=this.getTransceivers().find(function(e){return"audio"===e.receiver.track.kind}),!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo),t=this.getTransceivers().find(function(e){return"video"===e.receiver.track.kind}),!1===e.offerToReceiveVideo&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveVideo||t||this.addTransceiver("video")),n.apply(this,arguments)}};var o=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("../utils"));function r(e){return e&&void 0!==e.video?Object.assign({},e,{video:o.compactObject(e.video)}):e}},{"../utils":15}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.extractVersion=s,n.wrapPeerConnectionEvent=function(e,i,r){var a,o;e.RTCPeerConnection&&(e=e.RTCPeerConnection.prototype,a=e.addEventListener,e.addEventListener=function(e,t){if(e!==i)return a.apply(this,arguments);function n(e){(e=r(e))&&t(e)}return this._eventMap=this._eventMap||{},this._eventMap[t]=n,a.apply(this,[e,n])},o=e.removeEventListener,e.removeEventListener=function(e,t){if(e!==i||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);var n=this._eventMap[t];return delete this._eventMap[t],o.apply(this,[e,n])},Object.defineProperty(e,"on"+i,{get:function(){return this["_on"+i]},set:function(e){this["_on"+i]&&(this.removeEventListener(i,this["_on"+i]),delete this["_on"+i]),e&&this.addEventListener(i,this["_on"+i]=e)},enumerable:!0,configurable:!0}))},n.disableLog=function(e){return"boolean"==typeof e?(r=e)?"adapter.js logging disabled":"adapter.js logging enabled":new Error("Argument type: "+(void 0===e?"undefined":i(e))+". Please use a boolean.")},n.disableWarnings=function(e){return"boolean"==typeof e?(a=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled")):new Error("Argument type: "+(void 0===e?"undefined":i(e))+". Please use a boolean.")},n.log=function(){"object"===("undefined"==typeof window?"undefined":i(window))&&(r||"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments))},n.deprecated=function(e,t){a&&void 0},n.detectBrowser=function(e){var t=e.navigator,n={browser:null,version:null};if(void 0===e||!e.navigator)return n.browser="Not a browser.",n;if(t.mozGetUserMedia)n.browser="firefox",n.version=s(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)n.browser="chrome",n.version=s(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=s(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=s(t.userAgent,/AppleWebKit\/(\d+)\./,1),n.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return n},n.compactObject=function r(a){if(!c(a))return a;return Object.keys(a).reduce(function(e,t){var n=c(a[t]),i=n?r(a[t]):a[t],n=n&&!Object.keys(i).length;return void 0===i||n?e:Object.assign(e,o({},t,i))},{})},n.walkStats=l,n.filterStats=function(n,t,e){var i=e?"outbound-rtp":"inbound-rtp",r=new Map;if(null===t)return r;var a=[];return n.forEach(function(e){"track"===e.type&&e.trackIdentifier===t.id&&a.push(e)}),a.forEach(function(t){n.forEach(function(e){e.type===i&&e.trackId===t.id&&l(n,e,r)})}),r};var r=!0,a=!0;function s(e,t,n){t=e.match(t);return t&&t.length>=n&&parseInt(t[n],10)}function c(e){return"[object Object]"===Object.prototype.toString.call(e)}function l(t,n,i){n&&!i.has(n.id)&&(i.set(n.id,n),Object.keys(n).forEach(function(e){e.endsWith("Id")?l(t,t.get(n[e]),i):e.endsWith("Ids")&&n[e].forEach(function(e){l(t,t.get(e),i)})}))}},{}],16:[function(e,t,n){"use strict";var O=e("sdp");function o(e,t,n,i,r){t=O.writeRtpDescription(e.kind,t);return t+=O.writeIceParameters(e.iceGatherer.getLocalParameters()),t+=O.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":r||"active"),t+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?t+="a=sendrecv\r\n":e.rtpSender?t+="a=sendonly\r\n":e.rtpReceiver?t+="a=recvonly\r\n":t+="a=inactive\r\n",e.rtpSender&&(r=e.rtpSender._initialTrackId||e.rtpSender.track.id,e.rtpSender._initialTrackId=r,t+="a="+(r="msid:"+(i?i.id:"-")+" "+r+"\r\n"),t+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+r,e.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+r,t+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")),t+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+O.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+O.localCName+"\r\n"),t}function x(i,r){function a(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]}var o={codecs:[],headerExtensions:[],fecMechanisms:[]};return i.codecs.forEach(function(n){for(var e=0;e<r.codecs.length;e++){var t=r.codecs[e];if(n.name.toLowerCase()===t.name.toLowerCase()&&n.clockRate===t.clockRate&&("rtx"!==n.name.toLowerCase()||!n.parameters||!t.parameters.apt||function(e,t,n,i){n=a(e.parameters.apt,n),i=a(t.parameters.apt,i);return n&&i&&n.name.toLowerCase()===i.name.toLowerCase()}(n,t,i.codecs,r.codecs))){(t=JSON.parse(JSON.stringify(t))).numChannels=Math.min(n.numChannels,t.numChannels),o.codecs.push(t),t.rtcpFeedback=t.rtcpFeedback.filter(function(e){for(var t=0;t<n.rtcpFeedback.length;t++)if(n.rtcpFeedback[t].type===e.type&&n.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}}),i.headerExtensions.forEach(function(e){for(var t=0;t<r.headerExtensions.length;t++){var n=r.headerExtensions[t];if(e.uri===n.uri){o.headerExtensions.push(n);break}}}),o}function a(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function M(e,t){var n=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return n||e.addRemoteCandidate(t),!n}function p(e,t){t=new Error(t);return t.name=e,t.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],t}t.exports=function(R,I){function L(e,t){t.addTrack(e),t.dispatchEvent(new R.MediaStreamTrackEvent("addtrack",{track:e}))}function r(e,t,n,i){var r=new Event("track");r.track=t,r.receiver=n,r.transceiver={receiver:n},r.streams=i,R.setTimeout(function(){e._dispatchEvent("track",r)})}function i(e){var t,i,r,n=this,a=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){n[e]=a[e].bind(a)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",e=JSON.parse(JSON.stringify(e||{})),this.usingBundle="max-bundle"===e.bundlePolicy,"negotiate"===e.rtcpMuxPolicy)throw p("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(e.rtcpMuxPolicy||(e.rtcpMuxPolicy="require"),e.iceTransportPolicy){case"all":case"relay":break;default:e.iceTransportPolicy="all"}switch(e.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:e.bundlePolicy="balanced"}if(e.iceServers=(t=e.iceServers||[],i=I,r=!1,(t=JSON.parse(JSON.stringify(t))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&void 0;var n="string"==typeof t,t=(t=n?[t]:t).filter(function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||r?0===e.indexOf("stun:")&&14393<=i&&-1===e.indexOf("?transport=udp"):r=!0});return delete e.url,e.urls=n?t[0]:t,!!t.length}})),this._iceGatherers=[],e.iceCandidatePoolSize)for(var o=e.iceCandidatePoolSize;0<o;o--)this._iceGatherers.push(new R.RTCIceGatherer({iceServers:e.iceServers,gatherPolicy:e.iceTransportPolicy}));else e.iceCandidatePoolSize=0;this._config=e,this.transceivers=[],this._sdpSessionId=O.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1}Object.defineProperty(i.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(i.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),i.prototype.onicecandidate=null,i.prototype.onaddstream=null,i.prototype.ontrack=null,i.prototype.onremovestream=null,i.prototype.onsignalingstatechange=null,i.prototype.oniceconnectionstatechange=null,i.prototype.onconnectionstatechange=null,i.prototype.onicegatheringstatechange=null,i.prototype.onnegotiationneeded=null,i.prototype.ondatachannel=null,i.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},i.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},i.prototype.getConfiguration=function(){return this._config},i.prototype.getLocalStreams=function(){return this.localStreams},i.prototype.getRemoteStreams=function(){return this.remoteStreams},i.prototype._createTransceiver=function(e,t){var n=0<this.transceivers.length,e={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};return this.usingBundle&&n?(e.iceTransport=this.transceivers[0].iceTransport,e.dtlsTransport=this.transceivers[0].dtlsTransport):(n=this._createIceAndDtlsTransports(),e.iceTransport=n.iceTransport,e.dtlsTransport=n.dtlsTransport),t||this.transceivers.push(e),e},i.prototype.addTrack=function(t,e){if(this._isClosed)throw p("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var n;if(this.transceivers.find(function(e){return e.track===t}))throw p("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(n=this.transceivers[i]);return n=n||this._createTransceiver(t.kind),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(e)&&this.localStreams.push(e),n.track=t,n.stream=e,n.rtpSender=new R.RTCRtpSender(t,n.dtlsTransport),n.rtpSender},i.prototype.addStream=function(t){var i,n=this;15025<=I?t.getTracks().forEach(function(e){n.addTrack(e,t)}):(i=t.clone(),t.getTracks().forEach(function(e,t){var n=i.getTracks()[t];e.addEventListener("enabled",function(e){n.enabled=e.enabled})}),i.getTracks().forEach(function(e){n.addTrack(e,i)}))},i.prototype.removeTrack=function(t){if(this._isClosed)throw p("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof R.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var e=this.transceivers.find(function(e){return e.rtpSender===t});if(!e)throw p("InvalidAccessError","Sender was not created by this connection.");var n=e.stream;e.rtpSender.stop(),e.rtpSender=null,e.track=null,e.stream=null,-1===this.transceivers.map(function(e){return e.stream}).indexOf(n)&&-1<this.localStreams.indexOf(n)&&this.localStreams.splice(this.localStreams.indexOf(n),1),this._maybeFireNegotiationNeeded()},i.prototype.removeStream=function(e){var n=this;e.getTracks().forEach(function(t){var e=n.getSenders().find(function(e){return e.track===t});e&&n.removeTrack(e)})},i.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},i.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},i.prototype._createIceGatherer=function(n,e){var i=this;if(e&&0<n)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var r=new R.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(r,"state",{value:"new",writable:!0}),this.transceivers[n].bufferedCandidateEvents=[],this.transceivers[n].bufferCandidates=function(e){var t=!e.candidate||0===Object.keys(e.candidate).length;r.state=t?"completed":"gathering",null!==i.transceivers[n].bufferedCandidateEvents&&i.transceivers[n].bufferedCandidateEvents.push(e)},r.addEventListener("localcandidate",this.transceivers[n].bufferCandidates),r},i.prototype._gather=function(r,a){var e,o=this,s=this.transceivers[a].iceGatherer;s.onlocalcandidate||(e=this.transceivers[a].bufferedCandidateEvents,this.transceivers[a].bufferedCandidateEvents=null,s.removeEventListener("localcandidate",this.transceivers[a].bufferCandidates),s.onlocalcandidate=function(e){var t,n,i;o.usingBundle&&0<a||((t=new Event("icecandidate")).candidate={sdpMid:r,sdpMLineIndex:a},(e=!(n=e.candidate)||0===Object.keys(n).length)?"new"!==s.state&&"gathering"!==s.state||(s.state="completed"):("new"===s.state&&(s.state="gathering"),n.component=1,n.ufrag=s.getLocalParameters().usernameFragment,i=O.writeCandidate(n),t.candidate=Object.assign(t.candidate,O.parseCandidate(i)),t.candidate.candidate=i,t.candidate.toJSON=function(){return{candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex,usernameFragment:t.candidate.usernameFragment}}),(i=O.getMediaSections(o._localDescription.sdp))[t.candidate.sdpMLineIndex]+=e?"a=end-of-candidates\r\n":"a="+t.candidate.candidate+"\r\n",o._localDescription.sdp=O.getDescription(o._localDescription.sdp)+i.join(""),i=o.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}),"gathering"!==o.iceGatheringState&&(o.iceGatheringState="gathering",o._emitGatheringStateChange()),e||o._dispatchEvent("icecandidate",t),i&&(o._dispatchEvent("icecandidate",new Event("icecandidate")),o.iceGatheringState="complete",o._emitGatheringStateChange()))},R.setTimeout(function(){e.forEach(function(e){s.onlocalcandidate(e)})},0))},i.prototype._createIceAndDtlsTransports=function(){var e=this,t=new R.RTCIceTransport(null);t.onicestatechange=function(){e._updateIceConnectionState(),e._updateConnectionState()};var n=new R.RTCDtlsTransport(t);return n.ondtlsstatechange=function(){e._updateConnectionState()},n.onerror=function(){Object.defineProperty(n,"state",{value:"failed",writable:!0}),e._updateConnectionState()},{iceTransport:t,dtlsTransport:n}},i.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);t=this.transceivers[e].iceTransport;t&&(delete t.onicestatechange,delete this.transceivers[e].iceTransport);t=this.transceivers[e].dtlsTransport;t&&(delete t.ondtlsstatechange,delete t.onerror,delete this.transceivers[e].dtlsTransport)},i.prototype._transceive=function(e,t,n){var i=x(e.localCapabilities,e.remoteCapabilities);t&&e.rtpSender&&(i.encodings=e.sendEncodingParameters,i.rtcp={cname:O.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(i.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(i)),n&&e.rtpReceiver&&0<i.codecs.length&&("video"===e.kind&&e.recvEncodingParameters&&I<15019&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),e.recvEncodingParameters.length?i.encodings=e.recvEncodingParameters:i.encodings=[{}],i.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(i.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(i.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(i))},i.prototype.setLocalDescription=function(e){var t,l,d,h=this;return-1===["offer","answer"].indexOf(e.type)?Promise.reject(p("TypeError",'Unsupported type "'+e.type+'"')):!a("setLocalDescription",e.type,h.signalingState)||h._isClosed?Promise.reject(p("InvalidStateError","Can not set local "+e.type+" in state "+h.signalingState)):("offer"===e.type?(t=O.splitSections(e.sdp),l=t.shift(),t.forEach(function(e,t){e=O.parseRtpParameters(e);h.transceivers[t].localCapabilities=e}),h.transceivers.forEach(function(e,t){h._gather(e.mid,t)})):"answer"===e.type&&(l=(t=O.splitSections(h._remoteDescription.sdp)).shift(),d=0<O.matchPrefix(l,"a=ice-lite").length,t.forEach(function(e,t){var n,i=h.transceivers[t],r=i.iceGatherer,a=i.iceTransport,o=i.dtlsTransport,s=i.localCapabilities,c=i.remoteCapabilities;O.isRejected(e)&&0===O.matchPrefix(e,"a=bundle-only").length||i.rejected||(n=O.getIceParameters(e,l),e=O.getDtlsParameters(e,l),d&&(e.role="server"),h.usingBundle&&0!==t||(h._gather(i.mid,t),"new"===a.state&&a.start(r,n,d?"controlling":"controlled"),"new"===o.state&&o.start(e)),c=x(s,c),h._transceive(i,0<c.codecs.length,!1))})),h._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?h._updateSignalingState("have-local-offer"):h._updateSignalingState("stable"),Promise.resolve())},i.prototype.setRemoteDescription=function(_){var C=this;if(-1===["offer","answer"].indexOf(_.type))return Promise.reject(p("TypeError",'Unsupported type "'+_.type+'"'));if(!a("setRemoteDescription",_.type,C.signalingState)||C._isClosed)return Promise.reject(p("InvalidStateError","Can not set remote "+_.type+" in state "+C.signalingState));var S={};C.remoteStreams.forEach(function(e){S[e.id]=e});var T=[],e=O.splitSections(_.sdp),E=e.shift(),k=0<O.matchPrefix(E,"a=ice-lite").length,P=0<O.matchPrefix(E,"a=group:BUNDLE ").length;C.usingBundle=P;var t=O.matchPrefix(E,"a=ice-options:")[0];return C.canTrickleIceCandidates=!!t&&0<=t.substr(14).split(" ").indexOf("trickle"),e.forEach(function(e,t){var n,i,r,a,o,s,c,l,d,h,p,u,m=O.splitLines(e),f=O.getKind(e),v=O.isRejected(e)&&0===O.matchPrefix(e,"a=bundle-only").length,y=m[0].substr(2).split(" ")[2],g=O.getDirection(e,E),b=O.parseMsid(e),w=O.getMid(e)||O.generateIdentifier();v||"application"===f&&("DTLS/SCTP"===y||"UDP/DTLS/SCTP"===y)?C.transceivers[t]={mid:w,kind:f,protocol:y,rejected:!0}:(!v&&C.transceivers[t]&&C.transceivers[t].rejected&&(C.transceivers[t]=C._createTransceiver(f,!0)),r=O.parseRtpParameters(e),v||(a=O.getIceParameters(e,E),(o=O.getDtlsParameters(e,E)).role="client"),s=O.parseRtpEncodingParameters(e),c=O.parseRtcpParameters(e),l=0<O.matchPrefix(e,"a=end-of-candidates",E).length,m=O.matchPrefix(e,"a=candidate:").map(function(e){return O.parseCandidate(e)}).filter(function(e){return 1===e.component}),("offer"===_.type||"answer"===_.type)&&!v&&P&&0<t&&C.transceivers[t]&&(C._disposeIceAndDtlsTransports(t),C.transceivers[t].iceGatherer=C.transceivers[0].iceGatherer,C.transceivers[t].iceTransport=C.transceivers[0].iceTransport,C.transceivers[t].dtlsTransport=C.transceivers[0].dtlsTransport,C.transceivers[t].rtpSender&&C.transceivers[t].rtpSender.setTransport(C.transceivers[0].dtlsTransport),C.transceivers[t].rtpReceiver&&C.transceivers[t].rtpReceiver.setTransport(C.transceivers[0].dtlsTransport)),"offer"!==_.type||v?"answer"!==_.type||v||(y=(n=C.transceivers[t]).iceGatherer,e=n.iceTransport,v=n.dtlsTransport,u=n.rtpReceiver,d=n.sendEncodingParameters,i=n.localCapabilities,C.transceivers[t].recvEncodingParameters=s,C.transceivers[t].remoteCapabilities=r,C.transceivers[t].rtcpParameters=c,m.length&&"new"===e.state&&(!k&&!l||P&&0!==t?m.forEach(function(e){M(n.iceTransport,e)}):e.setRemoteCandidates(m)),P&&0!==t||("new"===e.state&&e.start(y,a,"controlling"),"new"===v.state&&v.start(o)),!x(n.localCapabilities,n.remoteCapabilities).codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&n.sendEncodingParameters[0].rtx&&delete n.sendEncodingParameters[0].rtx,C._transceive(n,"sendrecv"===g||"recvonly"===g,"sendrecv"===g||"sendonly"===g),!u||"sendrecv"!==g&&"sendonly"!==g?delete n.rtpReceiver:(p=u.track,b?(S[b.stream]||(S[b.stream]=new R.MediaStream),L(p,S[b.stream]),T.push([p,u,S[b.stream]])):(S.default||(S.default=new R.MediaStream),L(p,S.default),T.push([p,u,S.default])))):((n=C.transceivers[t]||C._createTransceiver(f)).mid=w,n.iceGatherer||(n.iceGatherer=C._createIceGatherer(t,P)),m.length&&"new"===n.iceTransport.state&&(!l||P&&0!==t?m.forEach(function(e){M(n.iceTransport,e)}):n.iceTransport.setRemoteCandidates(m)),i=R.RTCRtpReceiver.getCapabilities(f),I<15019&&(i.codecs=i.codecs.filter(function(e){return"rtx"!==e.name})),d=n.sendEncodingParameters||[{ssrc:1001*(2*t+2)}],m=!1,"sendrecv"===g||"sendonly"===g?(m=!n.rtpReceiver,u=n.rtpReceiver||new R.RTCRtpReceiver(n.dtlsTransport,f),m&&(p=u.track,(h=!b||"-"!==b.stream?b?(S[b.stream]||(S[b.stream]=new R.MediaStream,Object.defineProperty(S[b.stream],"id",{get:function(){return b.stream}})),Object.defineProperty(p,"id",{get:function(){return b.track}}),S[b.stream]):(S.default||(S.default=new R.MediaStream),S.default):h)&&(L(p,h),n.associatedRemoteMediaStreams.push(h)),T.push([p,u,h]))):n.rtpReceiver&&n.rtpReceiver.track&&(n.associatedRemoteMediaStreams.forEach(function(e){var t=e.getTracks().find(function(e){return e.id===n.rtpReceiver.track.id});t&&(t=t,(e=e).removeTrack(t),e.dispatchEvent(new R.MediaStreamTrackEvent("removetrack",{track:t})))}),n.associatedRemoteMediaStreams=[]),n.localCapabilities=i,n.remoteCapabilities=r,n.rtpReceiver=u,n.rtcpParameters=c,n.sendEncodingParameters=d,n.recvEncodingParameters=s,C._transceive(C.transceivers[t],!1,m)))}),void 0===C._dtlsRole&&(C._dtlsRole="offer"===_.type?"active":"passive"),C._remoteDescription={type:_.type,sdp:_.sdp},"offer"===_.type?C._updateSignalingState("have-remote-offer"):C._updateSignalingState("stable"),Object.keys(S).forEach(function(e){var t,i=S[e];i.getTracks().length&&(-1===C.remoteStreams.indexOf(i)&&(C.remoteStreams.push(i),(t=new Event("addstream")).stream=i,R.setTimeout(function(){C._dispatchEvent("addstream",t)})),T.forEach(function(e){var t=e[0],n=e[1];i.id===e[2].id&&r(C,t,n,[i])}))}),T.forEach(function(e){e[2]||r(C,e[0],e[1],[])}),R.setTimeout(function(){C&&C.transceivers&&C.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&0<e.iceTransport.getRemoteCandidates().length&&(void 0,e.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},i.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},i.prototype._updateSignalingState=function(e){this.signalingState=e;e=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",e)},i.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,R.setTimeout(function(){var e;t.needNegotiation&&(t.needNegotiation=!1,e=new Event("negotiationneeded"),t._dispatchEvent("negotiationneeded",e))},0))},i.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++}),e="new",0<t.failed?e="failed":0<t.checking?e="checking":0<t.disconnected?e="disconnected":0<t.new?e="new":0<t.connected?e="connected":0<t.completed&&(e="completed"),e!==this.iceConnectionState&&(this.iceConnectionState=e,e=new Event("iceconnectionstatechange"),this._dispatchEvent("iceconnectionstatechange",e))},i.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)}),t.connected+=t.completed,e="new",0<t.failed?e="failed":0<t.connecting?e="connecting":0<t.disconnected?e="disconnected":0<t.new?e="new":0<t.connected&&(e="connected"),e!==this.connectionState&&(this.connectionState=e,e=new Event("connectionstatechange"),this._dispatchEvent("connectionstatechange",e))},i.prototype.createOffer=function(){var a=this;if(a._isClosed)return Promise.reject(p("InvalidStateError","Can not call createOffer after close"));var t=a.transceivers.filter(function(e){return"audio"===e.kind}).length,n=a.transceivers.filter(function(e){return"video"===e.kind}).length,e=arguments[0];if(e){if(e.mandatory||e.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==e.offerToReceiveAudio&&(t=!0===e.offerToReceiveAudio?1:!1===e.offerToReceiveAudio?0:e.offerToReceiveAudio),void 0!==e.offerToReceiveVideo&&(n=!0===e.offerToReceiveVideo?1:!1===e.offerToReceiveVideo?0:e.offerToReceiveVideo)}for(a.transceivers.forEach(function(e){"audio"===e.kind?--t<0&&(e.wantReceive=!1):"video"===e.kind&&--n<0&&(e.wantReceive=!1)});0<t||0<n;)0<t&&(a._createTransceiver("audio"),t--),0<n&&(a._createTransceiver("video"),n--);var i=O.writeSessionBoilerplate(a._sdpSessionId,a._sdpSessionVersion++);a.transceivers.forEach(function(e,t){var n=e.track,i=e.kind,r=e.mid||O.generateIdentifier();e.mid=r,e.iceGatherer||(e.iceGatherer=a._createIceGatherer(t,a.usingBundle));r=R.RTCRtpSender.getCapabilities(i);I<15019&&(r.codecs=r.codecs.filter(function(e){return"rtx"!==e.name})),r.codecs.forEach(function(t){"H264"===t.name&&void 0===t.parameters["level-asymmetry-allowed"]&&(t.parameters["level-asymmetry-allowed"]="1"),e.remoteCapabilities&&e.remoteCapabilities.codecs&&e.remoteCapabilities.codecs.forEach(function(e){t.name.toLowerCase()===e.name.toLowerCase()&&t.clockRate===e.clockRate&&(t.preferredPayloadType=e.payloadType)})}),r.headerExtensions.forEach(function(t){(e.remoteCapabilities&&e.remoteCapabilities.headerExtensions||[]).forEach(function(e){t.uri===e.uri&&(t.id=e.id)})});t=e.sendEncodingParameters||[{ssrc:1001*(2*t+1)}];n&&15019<=I&&"video"===i&&!t[0].rtx&&(t[0].rtx={ssrc:t[0].ssrc+1}),e.wantReceive&&(e.rtpReceiver=new R.RTCRtpReceiver(e.dtlsTransport,i)),e.localCapabilities=r,e.sendEncodingParameters=t}),"max-compat"!==a._config.bundlePolicy&&(i+="a=group:BUNDLE "+a.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),i+="a=ice-options:trickle\r\n",a.transceivers.forEach(function(e,t){i+=o(e,e.localCapabilities,"offer",e.stream,a._dtlsRole),i+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===a.iceGatheringState||0!==t&&a.usingBundle||(e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1,i+="a="+O.writeCandidate(e)+"\r\n"}),"completed"===e.iceGatherer.state&&(i+="a=end-of-candidates\r\n"))});e=new R.RTCSessionDescription({type:"offer",sdp:i});return Promise.resolve(e)},i.prototype.createAnswer=function(){var i=this;if(i._isClosed)return Promise.reject(p("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==i.signalingState&&"have-local-pranswer"!==i.signalingState)return Promise.reject(p("InvalidStateError","Can not call createAnswer in signalingState "+i.signalingState));var r=O.writeSessionBoilerplate(i._sdpSessionId,i._sdpSessionVersion++);i.usingBundle&&(r+="a=group:BUNDLE "+i.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),r+="a=ice-options:trickle\r\n";var a=O.getMediaSections(i._remoteDescription.sdp).length;i.transceivers.forEach(function(e,t){if(!(a<t+1)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?r+="m=application 0 DTLS/SCTP 5000\r\n":r+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?r+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(r+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(r+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");e.stream&&("audio"===e.kind?n=e.stream.getAudioTracks()[0]:"video"===e.kind&&(n=e.stream.getVideoTracks()[0]),n&&15019<=I&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var n=x(e.localCapabilities,e.remoteCapabilities);!n.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,r+=o(e,n,"answer",e.stream,i._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(r+="a=rtcp-rsize\r\n")}});var e=new R.RTCSessionDescription({type:"answer",sdp:r});return Promise.resolve(e)},i.prototype.addIceCandidate=function(s){var c,l=this;return s&&void 0===s.sdpMLineIndex&&!s.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(e,t){if(!l._remoteDescription)return t(p("InvalidStateError","Can not add ICE candidate without a remote description"));if(s&&""!==s.candidate){var n=s.sdpMLineIndex;if(s.sdpMid)for(var i=0;i<l.transceivers.length;i++)if(l.transceivers[i].mid===s.sdpMid){n=i;break}var r=l.transceivers[n];if(!r)return t(p("OperationError","Can not add ICE candidate"));if(r.rejected)return e();var a=0<Object.keys(s.candidate).length?O.parseCandidate(s.candidate):{};if("tcp"===a.protocol&&(0===a.port||9===a.port))return e();if(a.component&&1!==a.component)return e();if((0===n||0<n&&r.iceTransport!==l.transceivers[0].iceTransport)&&!M(r.iceTransport,a))return t(p("OperationError","Can not add ICE candidate"));t=s.candidate.trim();0===t.indexOf("a=")&&(t=t.substr(2)),(c=O.getMediaSections(l._remoteDescription.sdp))[n]+="a="+(a.type?t:"end-of-candidates")+"\r\n",l._remoteDescription.sdp=O.getDescription(l._remoteDescription.sdp)+c.join("")}else for(var o=0;o<l.transceivers.length&&(l.transceivers[o].rejected||(l.transceivers[o].iceTransport.addRemoteCandidate({}),(c=O.getMediaSections(l._remoteDescription.sdp))[o]+="a=end-of-candidates\r\n",l._remoteDescription.sdp=O.getDescription(l._remoteDescription.sdp)+c.join(""),!l.usingBundle));o++);e()})},i.prototype.getStats=function(t){if(t&&t instanceof R.MediaStreamTrack){var n=null;if(this.transceivers.forEach(function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)}),!n)throw p("InvalidAccessError","Invalid selector.");return n.getStats()}var i=[];return this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(e){t[e]&&i.push(t[e].getStats())})}),Promise.all(i).then(function(e){var t=new Map;return e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})}),t})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(e){var t,e=R[e];e&&e.prototype&&e.prototype.getStats&&(t=e.prototype.getStats,e.prototype.getStats=function(){return t.apply(this).then(function(n){var i=new Map;return Object.keys(n).forEach(function(e){var t;n[e].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(t=n[e]).type]||t.type,i.set(e,n[e])}),i})})});var e=["createOffer","createAnswer"];return e.forEach(function(e){var n=i.prototype[e];i.prototype[e]=function(){var t=arguments;return"function"==typeof t[0]||"function"==typeof t[1]?n.apply(this,[arguments[2]]).then(function(e){"function"==typeof t[0]&&t[0].apply(null,[e])},function(e){"function"==typeof t[1]&&t[1].apply(null,[e])}):n.apply(this,arguments)}}),(e=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(e){var n=i.prototype[e];i.prototype[e]=function(){var t=arguments;return"function"==typeof t[1]||"function"==typeof t[2]?n.apply(this,arguments).then(function(){"function"==typeof t[1]&&t[1].apply(null)},function(e){"function"==typeof t[2]&&t[2].apply(null,[e])}):n.apply(this,arguments)}}),["getStats"].forEach(function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),i}},{sdp:17}],17:[function(e,t,n){"use strict";var l={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};l.localCName=l.generateIdentifier(),l.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},l.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(0<t?"m="+e:e).trim()+"\r\n"})},l.getDescription=function(e){e=l.splitSections(e);return e&&e[0]},l.getMediaSections=function(e){e=l.splitSections(e);return e.shift(),e},l.matchPrefix=function(e,t){return l.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},l.parseCandidate=function(e){for(var t=(0===e.indexOf("a=candidate:")?e.substring(12):e.substring(10)).split(" "),n={foundation:t[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},i=8;i<t.length;i+=2)switch(t[i]){case"raddr":n.relatedAddress=t[i+1];break;case"rport":n.relatedPort=parseInt(t[i+1],10);break;case"tcptype":n.tcpType=t[i+1];break;case"ufrag":n.ufrag=t[i+1],n.usernameFragment=t[i+1];break;default:n[t[i]]=t[i+1]}return n},l.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},l.parseIceOptions=function(e){return e.substr(14).split(" ")},l.parseRtpMap=function(e){var t=e.substr(9).split(" "),e={payloadType:parseInt(t.shift(),10)},t=t[0].split("/");return e.name=t[0],e.clockRate=parseInt(t[1],10),e.channels=3===t.length?parseInt(t[2],10):1,e.numChannels=e.channels,e},l.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},l.parseExtmap=function(e){e=e.substr(9).split(" ");return{id:parseInt(e[0],10),direction:0<e[0].indexOf("/")?e[0].split("/")[1]:"sendrecv",uri:e[1]}},l.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},l.parseFmtp=function(e){for(var t,n={},i=e.substr(e.indexOf(" ")+1).split(";"),r=0;r<i.length;r++)n[(t=i[r].trim().split("="))[0].trim()]=t[1];return n},l.writeFmtp=function(t){var n,e="",i=t.payloadType;return void 0!==t.preferredPayloadType&&(i=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length&&(n=[],Object.keys(t.parameters).forEach(function(e){t.parameters[e]?n.push(e+"="+t.parameters[e]):n.push(e)}),e+="a=fmtp:"+i+" "+n.join(";")+"\r\n"),e},l.parseRtcpFb=function(e){e=e.substr(e.indexOf(" ")+1).split(" ");return{type:e.shift(),parameter:e.join(" ")}},l.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},l.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},i=e.indexOf(":",t);return-1<i?(n.attribute=e.substr(t+1,i-t-1),n.value=e.substr(i+1)):n.attribute=e.substr(t+1),n},l.parseSsrcGroup=function(e){e=e.substr(13).split(" ");return{semantics:e.shift(),ssrcs:e.map(function(e){return parseInt(e,10)})}},l.getMid=function(e){e=l.matchPrefix(e,"a=mid:")[0];if(e)return e.substr(6)},l.parseFingerprint=function(e){e=e.substr(14).split(" ");return{algorithm:e[0].toLowerCase(),value:e[1]}},l.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:l.matchPrefix(e+t,"a=fingerprint:").map(l.parseFingerprint)}},l.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},l.getIceParameters=function(e,t){e=l.splitLines(e);return{usernameFragment:(e=e.concat(l.splitLines(t))).filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:e.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)}},l.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},l.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=l.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var r=n[i],a=l.matchPrefix(e,"a=rtpmap:"+r+" ")[0];if(a){var o=l.parseRtpMap(a),a=l.matchPrefix(e,"a=fmtp:"+r+" ");switch(o.parameters=a.length?l.parseFmtp(a[0]):{},o.rtcpFeedback=l.matchPrefix(e,"a=rtcp-fb:"+r+" ").map(l.parseRtcpFb),t.codecs.push(o),o.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(o.name.toUpperCase())}}}return l.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(l.parseExtmap(e))}),t},l.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=0<t.codecs.length?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n+=l.writeRtpMap(e),n+=l.writeFmtp(e),n+=l.writeRtcpFb(e)});var i=0;return t.codecs.forEach(function(e){e.maxptime>i&&(i=e.maxptime)}),0<i&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach(function(e){n+=l.writeExtmap(e)}),n},l.parseRtpEncodingParameters=function(e){var t,n=[],i=l.parseRtpParameters(e),r=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),o=l.matchPrefix(e,"a=ssrc:").map(function(e){return l.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),s=0<o.length&&o[0].ssrc,o=l.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substr(17).split(" ").map(function(e){return parseInt(e,10)})});0<o.length&&1<o[0].length&&o[0][0]===s&&(t=o[0][1]),i.codecs.forEach(function(e){"RTX"===e.name.toUpperCase()&&e.parameters.apt&&(e={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)},s&&t&&(e.rtx={ssrc:t}),n.push(e),r&&((e=JSON.parse(JSON.stringify(e))).fec={ssrc:s,mechanism:a?"red+ulpfec":"red"},n.push(e)))}),0===n.length&&s&&n.push({ssrc:s});var c=l.matchPrefix(e,"b=");return c.length&&(c=0===c[0].indexOf("b=TIAS:")?parseInt(c[0].substr(7),10):0===c[0].indexOf("b=AS:")?1e3*parseInt(c[0].substr(5),10)*.95-16e3:void 0,n.forEach(function(e){e.maxBitrate=c})),n},l.parseRtcpParameters=function(e){var t={},n=l.matchPrefix(e,"a=ssrc:").map(function(e){return l.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);n=l.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=0<n.length,t.compound=0===n.length;e=l.matchPrefix(e,"a=rtcp-mux");return t.mux=0<e.length,t},l.parseMsid=function(e){var t,n=l.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};e=l.matchPrefix(e,"a=ssrc:").map(function(e){return l.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return 0<e.length?{stream:(t=e[0].value.split(" "))[0],track:t[1]}:void 0},l.parseSctpDescription=function(e){var t,n=l.parseMLine(e),i=l.matchPrefix(e,"a=max-message-size:");0<i.length&&(t=parseInt(i[0].substr(19),10)),isNaN(t)&&(t=65536);i=l.matchPrefix(e,"a=sctp-port:");if(0<i.length)return{port:parseInt(i[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};if(0<l.matchPrefix(e,"a=sctpmap:").length){e=l.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:t}}},l.writeSctpDescription=function(e,t){var n=[],n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"];return void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},l.generateSessionId=function(){return Math.random().toString().substr(2,21)},l.writeSessionBoilerplate=function(e,t,n){t=void 0!==t?t:2,e=e||l.generateSessionId();return"v=0\r\no="+(n||"thisisadapterortc")+" "+e+" "+t+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},l.writeMediaSection=function(e,t,n,i){t=l.writeRtpDescription(e.kind,t);return t+=l.writeIceParameters(e.iceGatherer.getLocalParameters()),t+=l.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),t+="a=mid:"+e.mid+"\r\n",e.direction?t+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?t+="a=sendrecv\r\n":e.rtpSender?t+="a=sendonly\r\n":e.rtpReceiver?t+="a=recvonly\r\n":t+="a=inactive\r\n",e.rtpSender&&(t+="a="+(i="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n"),t+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+i,e.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+i,t+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")),t+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+l.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+l.localCName+"\r\n"),t},l.getDirection=function(e,t){for(var n=l.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return t?l.getDirection(t):"sendrecv"},l.getKind=function(e){return l.splitLines(e)[0].split(" ")[0].substr(2)},l.isRejected=function(e){return"0"===e.split(" ",2)[1]},l.parseMLine=function(e){e=l.splitLines(e)[0].substr(2).split(" ");return{kind:e[0],port:parseInt(e[1],10),protocol:e[2],fmt:e.slice(3).join(" ")}},l.parseOLine=function(e){e=l.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:e[0],sessionId:e[1],sessionVersion:parseInt(e[2],10),netType:e[3],addressType:e[4],address:e[5]}},l.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=l.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=l)},{}]},{},[1])(1)}),function(e,t){"object"==typeof exports?module.exports=exports=t():"function"==typeof define&&define.amd?define([],t):e.CryptoJS=t()}(this,function(){var c,e,t,d,r,n,i,S,T,E,k,P,R,s,y,g,a,h,o,l,p,u,m,f,v,b,w,_,C,I,L,O,x,M,D,j,A,z,B=B||function(l){var i;if(!(i=!(i=!(i="undefined"!=typeof window&&window.crypto?window.crypto:i)&&"undefined"!=typeof window&&window.msCrypto?window.msCrypto:i)&&"undefined"!=typeof global&&global.crypto?global.crypto:i)&&"function"==typeof require)try{i=require("crypto")}catch(e){}var n=Object.create||function(e){return t.prototype=e,e=new t,t.prototype=null,e};function t(){}var e={},r=e.lib={},a=r.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),(t.init.prototype=t).$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},d=r.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes,r=e.sigBytes;if(this.clamp(),i%4)for(var a=0;a<r;a++){var o=n[a>>>2]>>>24-a%4*8&255;t[i+a>>>2]|=o<<24-(i+a)%4*8}else for(a=0;a<r;a+=4)t[i+a>>>2]=n[a>>>2];return this.sigBytes+=r,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=l.ceil(t/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(function(){if(i){if("function"==typeof i.getRandomValues)try{return i.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof i.randomBytes)try{return i.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")}());return new d.init(t,e)}}),o=e.enc={},s=o.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var a=t[r>>>2]>>>24-r%4*8&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new d.init(n,t/2)}},c=o.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var a=t[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(a))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new d.init(n,t)}},h=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},p=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=h.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t,n=this._data,i=n.words,r=n.sigBytes,a=this.blockSize,o=r/(4*a),s=(o=e?l.ceil(o):l.max((0|o)-this._minBufferSize,0))*a,r=l.min(4*s,r);if(s){for(var c=0;c<s;c+=a)this._doProcessBlock(i,c);t=i.splice(0,s),n.sigBytes-=r}return new d.init(t,r)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),u=(r.Hasher=p.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(n){return function(e,t){return new n.init(t).finalize(e)}},_createHmacHelper:function(n){return function(e,t){return new u.HMAC.init(n,t).finalize(e)}}}),e.algo={});return e}(Math);function H(e,t,n){return e&t|~e&n}function F(e,t,n){return e&n|t&~n}function N(e,t){return e<<t|e>>>32-t}function U(e,t,n,i){var r,a=this._iv;a?(r=a.slice(0),this._iv=void 0):r=this._prevBlock,i.encryptBlock(r,0);for(var o=0;o<n;o++)e[t+o]^=r[o]}function V(e){var t,n,i;return 255==(e>>24&255)?(n=e>>8&255,i=255&e,255===(t=e>>16&255)?(t=0,255===n?(n=0,255===i?i=0:++i):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=i):e+=1<<24,e}function G(){for(var e=this._X,t=this._C,n=0;n<8;n++)L[n]=t[n];t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<L[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<L[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<L[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<L[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<L[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<L[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<L[6]>>>0?1:0)|0,this._b=t[7]>>>0<L[7]>>>0?1:0;for(n=0;n<8;n++){var i=e[n]+t[n],r=65535&i,a=i>>>16;O[n]=((r*r>>>17)+r*a>>>15)+a*a^((4294901760&i)*i|0)+((65535&i)*i|0)}e[0]=O[0]+(O[7]<<16|O[7]>>>16)+(O[6]<<16|O[6]>>>16)|0,e[1]=O[1]+(O[0]<<8|O[0]>>>24)+O[7]|0,e[2]=O[2]+(O[1]<<16|O[1]>>>16)+(O[0]<<16|O[0]>>>16)|0,e[3]=O[3]+(O[2]<<8|O[2]>>>24)+O[1]|0,e[4]=O[4]+(O[3]<<16|O[3]>>>16)+(O[2]<<16|O[2]>>>16)|0,e[5]=O[5]+(O[4]<<8|O[4]>>>24)+O[3]|0,e[6]=O[6]+(O[5]<<16|O[5]>>>16)+(O[4]<<16|O[4]>>>16)|0,e[7]=O[7]+(O[6]<<8|O[6]>>>24)+O[5]|0}function W(){for(var e=this._X,t=this._C,n=0;n<8;n++)A[n]=t[n];t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<A[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<A[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<A[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<A[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<A[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<A[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<A[6]>>>0?1:0)|0,this._b=t[7]>>>0<A[7]>>>0?1:0;for(n=0;n<8;n++){var i=e[n]+t[n],r=65535&i,a=i>>>16;z[n]=((r*r>>>17)+r*a>>>15)+a*a^((4294901760&i)*i|0)+((65535&i)*i|0)}e[0]=z[0]+(z[7]<<16|z[7]>>>16)+(z[6]<<16|z[6]>>>16)|0,e[1]=z[1]+(z[0]<<8|z[0]>>>24)+z[7]|0,e[2]=z[2]+(z[1]<<16|z[1]>>>16)+(z[0]<<16|z[0]>>>16)|0,e[3]=z[3]+(z[2]<<8|z[2]>>>24)+z[1]|0,e[4]=z[4]+(z[3]<<16|z[3]>>>16)+(z[2]<<16|z[2]>>>16)|0,e[5]=z[5]+(z[4]<<8|z[4]>>>24)+z[3]|0,e[6]=z[6]+(z[5]<<16|z[5]>>>16)+(z[4]<<16|z[4]>>>16)|0,e[7]=z[7]+(z[6]<<8|z[6]>>>24)+z[5]|0}return c=(o=B).lib.WordArray,o.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,i=this._map;e.clamp();for(var r=[],a=0;a<n;a+=3)for(var o=(t[a>>>2]>>>24-a%4*8&255)<<16|(t[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|t[a+2>>>2]>>>24-(a+2)%4*8&255,s=0;s<4&&a+.75*s<n;s++)r.push(i.charAt(o>>>6*(3-s)&63));var c=i.charAt(64);if(c)for(;r.length%4;)r.push(c);return r.join("")},parse:function(e){var t=e.length,n=this._map;if(!(i=this._reverseMap))for(var i=this._reverseMap=[],r=0;r<n.length;r++)i[n.charCodeAt(r)]=r;var a=n.charAt(64);return!a||-1!==(a=e.indexOf(a))&&(t=a),function(e,t,n){for(var i=[],r=0,a=0;a<t;a++){var o,s;a%4&&(o=n[e.charCodeAt(a-1)]<<a%4*2,s=n[e.charCodeAt(a)]>>>6-a%4*2,s=o|s,i[r>>>2]|=s<<24-r%4*8,r++)}return c.create(i,r)}(e,t,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(c){var e=B,t=e.lib,n=t.WordArray,i=t.Hasher,t=e.algo,k=[];!function(){for(var e=0;e<64;e++)k[e]=4294967296*c.abs(c.sin(e+1))|0}();t=t.MD5=i.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var i=t+n,r=e[i];e[i]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var a=this._hash.words,o=e[t+0],s=e[t+1],c=e[t+2],l=e[t+3],d=e[t+4],h=e[t+5],p=e[t+6],u=e[t+7],m=e[t+8],f=e[t+9],v=e[t+10],y=e[t+11],g=e[t+12],b=e[t+13],w=e[t+14],_=e[t+15],C=P(C=a[0],E=a[1],T=a[2],S=a[3],o,7,k[0]),S=P(S,C,E,T,s,12,k[1]),T=P(T,S,C,E,c,17,k[2]),E=P(E,T,S,C,l,22,k[3]);C=P(C,E,T,S,d,7,k[4]),S=P(S,C,E,T,h,12,k[5]),T=P(T,S,C,E,p,17,k[6]),E=P(E,T,S,C,u,22,k[7]),C=P(C,E,T,S,m,7,k[8]),S=P(S,C,E,T,f,12,k[9]),T=P(T,S,C,E,v,17,k[10]),E=P(E,T,S,C,y,22,k[11]),C=P(C,E,T,S,g,7,k[12]),S=P(S,C,E,T,b,12,k[13]),T=P(T,S,C,E,w,17,k[14]),C=R(C,E=P(E,T,S,C,_,22,k[15]),T,S,s,5,k[16]),S=R(S,C,E,T,p,9,k[17]),T=R(T,S,C,E,y,14,k[18]),E=R(E,T,S,C,o,20,k[19]),C=R(C,E,T,S,h,5,k[20]),S=R(S,C,E,T,v,9,k[21]),T=R(T,S,C,E,_,14,k[22]),E=R(E,T,S,C,d,20,k[23]),C=R(C,E,T,S,f,5,k[24]),S=R(S,C,E,T,w,9,k[25]),T=R(T,S,C,E,l,14,k[26]),E=R(E,T,S,C,m,20,k[27]),C=R(C,E,T,S,b,5,k[28]),S=R(S,C,E,T,c,9,k[29]),T=R(T,S,C,E,u,14,k[30]),C=I(C,E=R(E,T,S,C,g,20,k[31]),T,S,h,4,k[32]),S=I(S,C,E,T,m,11,k[33]),T=I(T,S,C,E,y,16,k[34]),E=I(E,T,S,C,w,23,k[35]),C=I(C,E,T,S,s,4,k[36]),S=I(S,C,E,T,d,11,k[37]),T=I(T,S,C,E,u,16,k[38]),E=I(E,T,S,C,v,23,k[39]),C=I(C,E,T,S,b,4,k[40]),S=I(S,C,E,T,o,11,k[41]),T=I(T,S,C,E,l,16,k[42]),E=I(E,T,S,C,p,23,k[43]),C=I(C,E,T,S,f,4,k[44]),S=I(S,C,E,T,g,11,k[45]),T=I(T,S,C,E,_,16,k[46]),C=L(C,E=I(E,T,S,C,c,23,k[47]),T,S,o,6,k[48]),S=L(S,C,E,T,u,10,k[49]),T=L(T,S,C,E,w,15,k[50]),E=L(E,T,S,C,h,21,k[51]),C=L(C,E,T,S,g,6,k[52]),S=L(S,C,E,T,l,10,k[53]),T=L(T,S,C,E,v,15,k[54]),E=L(E,T,S,C,s,21,k[55]),C=L(C,E,T,S,m,6,k[56]),S=L(S,C,E,T,_,10,k[57]),T=L(T,S,C,E,p,15,k[58]),E=L(E,T,S,C,b,21,k[59]),C=L(C,E,T,S,d,6,k[60]),S=L(S,C,E,T,y,10,k[61]),T=L(T,S,C,E,c,15,k[62]),E=L(E,T,S,C,f,21,k[63]),a[0]=a[0]+C|0,a[1]=a[1]+E|0,a[2]=a[2]+T|0,a[3]=a[3]+S|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;t[i>>>5]|=128<<24-i%32;var r=c.floor(n/4294967296),n=n;t[15+(64+i>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t[14+(64+i>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var t=this._hash,a=t.words,o=0;o<4;o++){var s=a[o];a[o]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return t},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function P(e,t,n,i,r,a,o){o=e+(t&n|~t&i)+r+o;return(o<<a|o>>>32-a)+t}function R(e,t,n,i,r,a,o){o=e+(t&i|n&~i)+r+o;return(o<<a|o>>>32-a)+t}function I(e,t,n,i,r,a,o){o=e+(t^n^i)+r+o;return(o<<a|o>>>32-a)+t}function L(e,t,n,i,r,a,o){o=e+(n^(t|~i))+r+o;return(o<<a|o>>>32-a)+t}e.MD5=i._createHelper(t),e.HmacMD5=i._createHmacHelper(t)}(Math),D=(M=B).lib,e=D.WordArray,t=D.Hasher,D=M.algo,d=[],D=D.SHA1=t.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],r=n[1],a=n[2],o=n[3],s=n[4],c=0;c<80;c++){c<16?d[c]=0|e[t+c]:(l=d[c-3]^d[c-8]^d[c-14]^d[c-16],d[c]=l<<1|l>>>31);var l=(i<<5|i>>>27)+s+d[c];l+=c<20?1518500249+(r&a|~r&o):c<40?1859775393+(r^a^o):c<60?(r&a|r&o|a&o)-1894007588:(r^a^o)-899497514,s=o,o=a,a=r<<30|r>>>2,r=i,i=l}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+a|0,n[3]=n[3]+o|0,n[4]=n[4]+s|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[14+(64+i>>>9<<4)]=Math.floor(n/4294967296),t[15+(64+i>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e}}),M.SHA1=t._createHelper(D),M.HmacSHA1=t._createHmacHelper(D),function(r){var e=B,t=e.lib,n=t.WordArray,i=t.Hasher,t=e.algo,a=[],m=[];!function(){function e(e){return 4294967296*(e-(0|e))|0}for(var t=2,n=0;n<64;)!function(e){for(var t=r.sqrt(e),n=2;n<=t;n++)if(!(e%n))return;return 1}(t)||(n<8&&(a[n]=e(r.pow(t,.5))),m[n]=e(r.pow(t,1/3)),n++),t++}();var f=[],t=t.SHA256=i.extend({_doReset:function(){this._hash=new n.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],r=n[1],a=n[2],o=n[3],s=n[4],c=n[5],l=n[6],d=n[7],h=0;h<64;h++){h<16?f[h]=0|e[t+h]:(p=f[h-15],u=f[h-2],f[h]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+f[h-7]+((u<<15|u>>>17)^(u<<13|u>>>19)^u>>>10)+f[h-16]);var p=i&r^i&a^r&a,u=d+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&c^~s&l)+m[h]+f[h],d=l,l=c,c=s,s=o+u|0,o=a,a=r,r=i,i=u+(((i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22))+p)|0}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+a|0,n[3]=n[3]+o|0,n[4]=n[4]+s|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+d|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[14+(64+i>>>9<<4)]=r.floor(n/4294967296),t[15+(64+i>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA256=i._createHelper(t),e.HmacSHA256=i._createHmacHelper(t)}(Math),function(){var e=B,r=e.lib.WordArray,e=e.enc;e.Utf16=e.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r+=2){var a=t[r>>>2]>>>16-r%4*8&65535;i.push(String.fromCharCode(a))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i++)n[i>>>1]|=e.charCodeAt(i)<<16-i%2*16;return r.create(n,2*t)}};function o(e){return e<<8&4278255360|e>>>8&16711935}e.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r+=2){var a=o(t[r>>>2]>>>16-r%4*8&65535);i.push(String.fromCharCode(a))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i++)n[i>>>1]|=o(e.charCodeAt(i)<<16-i%2*16);return r.create(n,2*t)}}}(),"function"==typeof ArrayBuffer&&(x=B.lib.WordArray,r=x.init,(x.init=function(e){if((e=(e=e instanceof ArrayBuffer?new Uint8Array(e):e)instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e)instanceof Uint8Array){for(var t=e.byteLength,n=[],i=0;i<t;i++)n[i>>>2]|=e[i]<<24-i%4*8;r.call(this,n,t)}else r.apply(this,arguments)}).prototype=x),Math,M=(o=B).lib,n=M.WordArray,i=M.Hasher,M=o.algo,S=n.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),T=n.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),E=n.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),k=n.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),P=n.create([0,1518500249,1859775393,2400959708,2840853838]),R=n.create([1352829926,1548603684,1836072691,2053994217,0]),M=M.RIPEMD160=i.extend({_doReset:function(){this._hash=n.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var i=t+n,r=e[i];e[i]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}for(var a,o,s,c,l,d,h=this._hash.words,p=P.words,u=R.words,m=S.words,f=T.words,v=E.words,y=k.words,g=a=h[0],b=o=h[1],w=s=h[2],_=c=h[3],C=l=h[4],n=0;n<80;n+=1)d=a+e[t+m[n]]|0,d+=n<16?(o^s^c)+p[0]:n<32?H(o,s,c)+p[1]:n<48?((o|~s)^c)+p[2]:n<64?F(o,s,c)+p[3]:(o^(s|~c))+p[4],d=(d=N(d|=0,v[n]))+l|0,a=l,l=c,c=N(s,10),s=o,o=d,d=g+e[t+f[n]]|0,d+=n<16?(b^(w|~_))+u[0]:n<32?F(b,w,_)+u[1]:n<48?((b|~w)^_)+u[2]:n<64?H(b,w,_)+u[3]:(b^w^_)+u[4],d=(d=N(d|=0,y[n]))+C|0,g=C,C=_,_=N(w,10),w=b,b=d;d=h[1]+s+_|0,h[1]=h[2]+c+C|0,h[2]=h[3]+l+g|0,h[3]=h[4]+a+b|0,h[4]=h[0]+o+w|0,h[0]=d},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;t[i>>>5]|=128<<24-i%32,t[14+(64+i>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var t=this._hash,r=t.words,a=0;a<5;a++){var o=r[a];r[a]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}return t},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}}),o.RIPEMD160=i._createHelper(M),o.HmacRIPEMD160=i._createHmacHelper(M),x=(D=B).lib.Base,s=D.enc.Utf8,D.algo.HMAC=x.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=s.parse(t));var n=e.blockSize,i=4*n;(t=t.sigBytes>i?e.finalize(t):t).clamp();for(var e=this._oKey=t.clone(),t=this._iKey=t.clone(),r=e.words,a=t.words,o=0;o<n;o++)r[o]^=1549556828,a[o]^=909522486;e.sigBytes=t.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,e=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(e))}}),M=(o=B).lib,D=M.Base,y=M.WordArray,x=o.algo,M=x.SHA1,g=x.HMAC,a=x.PBKDF2=D.extend({cfg:D.extend({keySize:4,hasher:M,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,i=g.create(n.hasher,e),r=y.create(),a=y.create([1]),o=r.words,s=a.words,c=n.keySize,l=n.iterations;o.length<c;){var d=i.update(t).finalize(a);i.reset();for(var h=d.words,p=h.length,u=d,m=1;m<l;m++){u=i.finalize(u),i.reset();for(var f=u.words,v=0;v<p;v++)h[v]^=f[v]}r.concat(d),s[0]++}return r.sigBytes=4*c,r}}),o.PBKDF2=function(e,t,n){return a.create(n).compute(e,t)},D=(x=B).lib,M=D.Base,h=D.WordArray,o=x.algo,D=o.MD5,l=o.EvpKDF=M.extend({cfg:M.extend({keySize:4,hasher:D,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n,i=this.cfg,r=i.hasher.create(),a=h.create(),o=a.words,s=i.keySize,c=i.iterations;o.length<s;){n&&r.update(n),n=r.update(e).finalize(t),r.reset();for(var l=1;l<c;l++)n=r.finalize(n),r.reset();a.concat(n)}return a.sigBytes=4*s,a}}),x.EvpKDF=function(e,t,n){return l.create(n).compute(e,t)},p=(M=B).lib.WordArray,D=M.algo,u=D.SHA256,D=D.SHA224=u.extend({_doReset:function(){this._hash=new p.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=u._doFinalize.call(this);return e.sigBytes-=4,e}}),M.SHA224=u._createHelper(D),M.HmacSHA224=u._createHmacHelper(D),M=(x=B).lib,m=M.Base,f=M.WordArray,(x=x.x64={}).Word=m.extend({init:function(e,t){this.high=e,this.low=t}}),x.WordArray=m.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],i=0;i<t;i++){var r=e[i];n.push(r.high),n.push(r.low)}return f.create(n,this.sigBytes)},clone:function(){for(var e=m.clone.call(this),t=e.words=this.words.slice(0),n=t.length,i=0;i<n;i++)t[i]=t[i].clone();return e}}),function(d){var e=B,t=e.lib,h=t.WordArray,i=t.Hasher,p=e.x64.Word,t=e.algo,k=[],P=[],R=[];!function(){for(var e=1,t=0,n=0;n<24;n++){k[e+5*t]=(n+1)*(n+2)/2%64;var i=(2*e+3*t)%5;e=t%5,t=i}for(e=0;e<5;e++)for(t=0;t<5;t++)P[e+5*t]=t+(2*e+3*t)%5*5;for(var r=1,a=0;a<24;a++){for(var o,s=0,c=0,l=0;l<7;l++)1&r&&((o=(1<<l)-1)<32?c^=1<<o:s^=1<<o-32),128&r?r=r<<1^113:r<<=1;R[a]=p.create(s,c)}}();var I=[];!function(){for(var e=0;e<25;e++)I[e]=p.create()}();t=t.SHA3=i.extend({cfg:i.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new p.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,i=this.blockSize/2,r=0;r<i;r++){var a=e[t+2*r],o=e[t+2*r+1],a=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8);(C=n[r]).high^=o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),C.low^=a}for(var s=0;s<24;s++){for(var c=0;c<5;c++){for(var l=0,d=0,h=0;h<5;h++)l^=(C=n[c+5*h]).high,d^=C.low;var p=I[c];p.high=l,p.low=d}for(c=0;c<5;c++)for(var u=I[(c+4)%5],m=I[(c+1)%5],f=m.high,m=m.low,l=u.high^(f<<1|m>>>31),d=u.low^(m<<1|f>>>31),h=0;h<5;h++)(C=n[c+5*h]).high^=l,C.low^=d;for(var v=1;v<25;v++){var y=(C=n[v]).high,g=C.low,b=k[v];d=b<32?(l=y<<b|g>>>32-b,g<<b|y>>>32-b):(l=g<<b-32|y>>>64-b,y<<b-32|g>>>64-b);b=I[P[v]];b.high=l,b.low=d}var w=I[0],_=n[0];w.high=_.high,w.low=_.low;for(c=0;c<5;c++)for(h=0;h<5;h++){var C=n[v=c+5*h],S=I[v],T=I[(c+1)%5+5*h],E=I[(c+2)%5+5*h];C.high=S.high^~T.high&E.high,C.low=S.low^~T.low&E.low}C=n[0],_=R[s];C.high^=_.high,C.low^=_.low}},_doFinalize:function(){var e=this._data,t=e.words,n=(this._nDataBytes,8*e.sigBytes),i=32*this.blockSize;t[n>>>5]|=1<<24-n%32,t[(d.ceil((1+n)/i)*i>>>5)-1]|=128,e.sigBytes=4*t.length,this._process();for(var r=this._state,t=this.cfg.outputLength/8,a=t/8,o=[],s=0;s<a;s++){var c=r[s],l=c.high,c=c.low,l=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8);o.push(c=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)),o.push(l)}return new h.init(o,t)},clone:function(){for(var e=i.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});e.SHA3=i._createHelper(t),e.HmacSHA3=i._createHmacHelper(t)}(Math),function(){var e=B,t=e.lib.Hasher,n=e.x64,i=n.Word,r=n.WordArray,n=e.algo;function a(){return i.create.apply(i,arguments)}var ee=[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)],te=[];!function(){for(var e=0;e<80;e++)te[e]=a()}();n=n.SHA512=t.extend({_doReset:function(){this._hash=new r.init([new i.init(1779033703,4089235720),new i.init(3144134277,2227873595),new i.init(1013904242,4271175723),new i.init(2773480762,1595750129),new i.init(1359893119,2917565137),new i.init(2600822924,725511199),new i.init(528734635,4215389547),new i.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],r=n[1],a=n[2],o=n[3],s=n[4],c=n[5],l=n[6],d=n[7],h=i.high,p=i.low,u=r.high,m=r.low,f=a.high,v=a.low,y=o.high,g=o.low,b=s.high,w=s.low,_=c.high,C=c.low,S=l.high,T=l.low,E=d.high,n=d.low,k=h,P=p,R=u,I=m,L=f,O=v,x=y,M=g,D=b,j=w,A=_,z=C,B=S,H=T,F=E,N=n,U=0;U<80;U++){var V,G,W=te[U];U<16?(G=W.high=0|e[t+2*U],V=W.low=0|e[t+2*U+1]):(Q=(J=te[U-15]).high,$=J.low,X=(Y=te[U-2]).high,K=Y.low,q=(Z=te[U-7]).high,J=Z.low,Z=(Y=te[U-16]).high,G=(G=((Q>>>1|$<<31)^(Q>>>8|$<<24)^Q>>>7)+q+((V=(q=($>>>1|Q<<31)^($>>>8|Q<<24)^($>>>7|Q<<25))+J)>>>0<q>>>0?1:0))+((X>>>19|K<<13)^(X<<3|K>>>29)^X>>>6)+((V+=$=(K>>>19|X<<13)^(K<<3|X>>>29)^(K>>>6|X<<26))>>>0<$>>>0?1:0),V+=Q=Y.low,W.high=G=G+Z+(V>>>0<Q>>>0?1:0),W.low=V);var J=D&A^~D&B,q=j&z^~j&H,K=k&R^k&L^R&L,X=(P>>>28|k<<4)^(P<<30|k>>>2)^(P<<25|k>>>7),$=ee[U],Y=$.high,Z=$.low,Q=N+((j>>>14|D<<18)^(j>>>18|D<<14)^(j<<23|D>>>9)),W=F+((D>>>14|j<<18)^(D>>>18|j<<14)^(D<<23|j>>>9))+(Q>>>0<N>>>0?1:0),$=X+(P&I^P&O^I&O),F=B,N=H,B=A,H=z,A=D,z=j,D=x+(W=(W=(W=W+J+((Q=Q+q)>>>0<q>>>0?1:0))+Y+((Q=Q+Z)>>>0<Z>>>0?1:0))+G+((Q=Q+V)>>>0<V>>>0?1:0))+((j=M+Q|0)>>>0<M>>>0?1:0)|0,x=L,M=O,L=R,O=I,R=k,I=P,k=W+(((k>>>28|P<<4)^(k<<30|P>>>2)^(k<<25|P>>>7))+K+($>>>0<X>>>0?1:0))+((P=Q+$|0)>>>0<Q>>>0?1:0)|0}p=i.low=p+P,i.high=h+k+(p>>>0<P>>>0?1:0),m=r.low=m+I,r.high=u+R+(m>>>0<I>>>0?1:0),v=a.low=v+O,a.high=f+L+(v>>>0<O>>>0?1:0),g=o.low=g+M,o.high=y+x+(g>>>0<M>>>0?1:0),w=s.low=w+j,s.high=b+D+(w>>>0<j>>>0?1:0),C=c.low=C+z,c.high=_+A+(C>>>0<z>>>0?1:0),T=l.low=T+H,l.high=S+B+(T>>>0<H>>>0?1:0),n=d.low=n+N,d.high=E+F+(n>>>0<N>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[30+(128+i>>>10<<5)]=Math.floor(n/4294967296),t[31+(128+i>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(n),e.HmacSHA512=t._createHmacHelper(n)}(),M=(D=B).x64,v=M.Word,b=M.WordArray,M=D.algo,w=M.SHA512,M=M.SHA384=w.extend({_doReset:function(){this._hash=new b.init([new v.init(3418070365,3238371032),new v.init(1654270250,914150663),new v.init(2438529370,812702999),new v.init(355462360,4144912697),new v.init(1731405415,4290775857),new v.init(2394180231,1750603025),new v.init(3675008525,1694076839),new v.init(1203062813,3204075428)])},_doFinalize:function(){var e=w._doFinalize.call(this);return e.sigBytes-=16,e}}),D.SHA384=w._createHelper(M),D.HmacSHA384=w._createHmacHelper(M),B.lib.Cipher||function(){var e=B,t=e.lib,n=t.Base,o=t.WordArray,i=t.BufferedBlockAlgorithm,r=e.enc,a=(r.Utf8,r.Base64),s=e.algo.EvpKDF,c=t.Cipher=i.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(i){return{encrypt:function(e,t,n){return l(t).encrypt(i,e,t,n)},decrypt:function(e,t,n){return l(t).decrypt(i,e,t,n)}}}});function l(e){return"string"==typeof e?m:u}t.StreamCipher=c.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var d=e.mode={},r=t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),r=d.CBC=((d=r.extend()).Encryptor=d.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize;h.call(this,e,t,i),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+i)}}),d.Decryptor=d.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,r=e.slice(t,t+i);n.decryptBlock(e,t),h.call(this,e,t,i),this._prevBlock=r}}),d);function h(e,t,n){var i,r=this._iv;r?(i=r,this._iv=void 0):i=this._prevBlock;for(var a=0;a<n;a++)e[t+a]^=i[a]}var d=(e.pad={}).Pkcs7={pad:function(e,t){for(var t=4*t,n=t-e.sigBytes%t,i=n<<24|n<<16|n<<8|n,r=[],a=0;a<n;a+=4)r.push(i);t=o.create(r,n);e.concat(t)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},p=(t.BlockCipher=c.extend({cfg:c.cfg.extend({mode:r,padding:d}),reset:function(){var e;c.reset.call(this);var t=this.cfg,n=t.iv,t=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=t.createEncryptor:(e=t.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,n&&n.words):(this._mode=e.call(t,this,n&&n.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4}),t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),d=(e.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,e=e.salt,t=e?o.create([1398893684,1701076831]).concat(e).concat(t):t;return t.toString(a)},parse:function(e){var t,n=a.parse(e),e=n.words;return 1398893684==e[0]&&1701076831==e[1]&&(t=o.create(e.slice(2,4)),e.splice(0,4),n.sigBytes-=16),p.create({ciphertext:n,salt:t})}},u=t.SerializableCipher=n.extend({cfg:n.extend({format:d}),encrypt:function(e,t,n,i){i=this.cfg.extend(i);var r=e.createEncryptor(n,i),t=r.finalize(t),r=r.cfg;return p.create({ciphertext:t,key:n,iv:r.iv,algorithm:e,mode:r.mode,padding:r.padding,blockSize:e.blockSize,formatter:i.format})},decrypt:function(e,t,n,i){return i=this.cfg.extend(i),t=this._parse(t,i.format),e.createDecryptor(n,i).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),e=(e.kdf={}).OpenSSL={execute:function(e,t,n,i){i=i||o.random(8);e=s.create({keySize:t+n}).compute(e,i),n=o.create(e.words.slice(t),4*n);return e.sigBytes=4*t,p.create({key:e,iv:n,salt:i})}},m=t.PasswordBasedCipher=u.extend({cfg:u.cfg.extend({kdf:e}),encrypt:function(e,t,n,i){n=(i=this.cfg.extend(i)).kdf.execute(n,e.keySize,e.ivSize);i.iv=n.iv;i=u.encrypt.call(this,e,t,n.key,i);return i.mixIn(n),i},decrypt:function(e,t,n,i){i=this.cfg.extend(i),t=this._parse(t,i.format);n=i.kdf.execute(n,e.keySize,e.ivSize,t.salt);return i.iv=n.iv,u.decrypt.call(this,e,t,n.key,i)}})}(),B.mode.CFB=((x=B.lib.BlockCipherMode.extend()).Encryptor=x.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize;U.call(this,e,t,i,n),this._prevBlock=e.slice(t,t+i)}}),x.Decryptor=x.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,r=e.slice(t,t+i);U.call(this,e,t,i,n),this._prevBlock=r}}),x),B.mode.ECB=((D=B.lib.BlockCipherMode.extend()).Encryptor=D.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),D.Decryptor=D.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),D),B.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,t=4*t,t=t-n%t,n=n+t-1;e.clamp(),e.words[n>>>2]|=t<<24-n%4*8,e.sigBytes+=t},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},B.pad.Iso10126={pad:function(e,t){t*=4,t-=e.sigBytes%t;e.concat(B.lib.WordArray.random(t-1)).concat(B.lib.WordArray.create([t<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},B.pad.Iso97971={pad:function(e,t){e.concat(B.lib.WordArray.create([2147483648],1)),B.pad.ZeroPadding.pad(e,t)},unpad:function(e){B.pad.ZeroPadding.unpad(e),e.sigBytes--}},B.mode.OFB=(M=B.lib.BlockCipherMode.extend(),x=M.Encryptor=M.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,r=this._iv,a=this._keystream;r&&(a=this._keystream=r.slice(0),this._iv=void 0),n.encryptBlock(a,0);for(var o=0;o<i;o++)e[t+o]^=a[o]}}),M.Decryptor=x,M),B.pad.NoPadding={pad:function(){},unpad:function(){}},_=(D=B).lib.CipherParams,C=D.enc.Hex,D.format.Hex={stringify:function(e){return e.ciphertext.toString(C)},parse:function(e){e=C.parse(e);return _.create({ciphertext:e})}},function(){var e=B,t=e.lib.BlockCipher,n=e.algo,l=[],d=[],h=[],p=[],u=[],m=[],f=[],v=[],y=[],g=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;for(var n=0,i=0,t=0;t<256;t++){var r=i^i<<1^i<<2^i<<3^i<<4;l[n]=r=r>>>8^255&r^99;var a=e[d[r]=n],o=e[a],s=e[o],c=257*e[r]^16843008*r;h[n]=c<<24|c>>>8,p[n]=c<<16|c>>>16,u[n]=c<<8|c>>>24,m[n]=c,f[r]=(c=16843009*s^65537*o^257*a^16843008*n)<<24|c>>>8,v[r]=c<<16|c>>>16,y[r]=c<<8|c>>>24,g[r]=c,n?(n=a^e[e[e[s^a]]],i^=e[e[i]]):n=i=1}}();var b=[0,1,2,4,8,16,32,64,128,27,54],n=n.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,i=4*(1+(this._nRounds=6+n)),r=this._keySchedule=[],a=0;a<i;a++)a<n?r[a]=t[a]:(c=r[a-1],a%n?6<n&&a%n==4&&(c=l[c>>>24]<<24|l[c>>>16&255]<<16|l[c>>>8&255]<<8|l[255&c]):(c=l[(c=c<<8|c>>>24)>>>24]<<24|l[c>>>16&255]<<16|l[c>>>8&255]<<8|l[255&c],c^=b[a/n|0]<<24),r[a]=r[a-n]^c);for(var o=this._invKeySchedule=[],s=0;s<i;s++){var c,a=i-s;c=s%4?r[a]:r[a-4],o[s]=s<4||a<=4?c:f[l[c>>>24]]^v[l[c>>>16&255]]^y[l[c>>>8&255]]^g[l[255&c]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,h,p,u,m,l)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,f,v,y,g,d);n=e[t+1];e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,i,r,a,o,s){for(var c=this._nRounds,l=e[t]^n[0],d=e[t+1]^n[1],h=e[t+2]^n[2],p=e[t+3]^n[3],u=4,m=1;m<c;m++)var f=i[l>>>24]^r[d>>>16&255]^a[h>>>8&255]^o[255&p]^n[u++],v=i[d>>>24]^r[h>>>16&255]^a[p>>>8&255]^o[255&l]^n[u++],y=i[h>>>24]^r[p>>>16&255]^a[l>>>8&255]^o[255&d]^n[u++],g=i[p>>>24]^r[l>>>16&255]^a[d>>>8&255]^o[255&h]^n[u++],l=f,d=v,h=y,p=g;f=(s[l>>>24]<<24|s[d>>>16&255]<<16|s[h>>>8&255]<<8|s[255&p])^n[u++],v=(s[d>>>24]<<24|s[h>>>16&255]<<16|s[p>>>8&255]<<8|s[255&l])^n[u++],y=(s[h>>>24]<<24|s[p>>>16&255]<<16|s[l>>>8&255]<<8|s[255&d])^n[u++],g=(s[p>>>24]<<24|s[l>>>16&255]<<16|s[d>>>8&255]<<8|s[255&h])^n[u++];e[t]=f,e[t+1]=v,e[t+2]=y,e[t+3]=g},keySize:8});e.AES=t._createHelper(n)}(),function(){var e=B,t=e.lib,i=t.WordArray,n=t.BlockCipher,t=e.algo,l=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],d=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],h=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],p=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],u=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],r=t.DES=n.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var i=l[n]-1;t[n]=e[i>>>5]>>>31-i%32&1}for(var r=this._subKeys=[],a=0;a<16;a++){for(var o=r[a]=[],s=h[a],n=0;n<24;n++)o[n/6|0]|=t[(d[n]-1+s)%28]<<31-n%6,o[4+(n/6|0)]|=t[28+(d[n+24]-1+s)%28]<<31-n%6;o[0]=o[0]<<1|o[0]>>>31;for(n=1;n<7;n++)o[n]=o[n]>>>4*(n-1)+3;o[7]=o[7]<<5|o[7]>>>27}for(var c=this._invSubKeys=[],n=0;n<16;n++)c[n]=r[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],m.call(this,4,252645135),m.call(this,16,65535),f.call(this,2,858993459),f.call(this,8,16711935),m.call(this,1,1431655765);for(var i=0;i<16;i++){for(var r=n[i],a=this._lBlock,o=this._rBlock,s=0,c=0;c<8;c++)s|=p[c][((o^r[c])&u[c])>>>0];this._lBlock=o,this._rBlock=a^s}var l=this._lBlock;this._lBlock=this._rBlock,this._rBlock=l,m.call(this,1,1431655765),f.call(this,8,16711935),f.call(this,2,858993459),m.call(this,16,65535),m.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function m(e,t){t=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=t,this._lBlock^=t<<e}function f(e,t){t=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=t,this._rBlock^=t<<e}e.DES=n._createHelper(r);t=t.TripleDES=n.extend({_doReset:function(){var e=this._key.words;if(2!==e.length&&4!==e.length&&e.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var t=e.slice(0,2),n=e.length<4?e.slice(0,2):e.slice(2,4),e=e.length<6?e.slice(0,2):e.slice(4,6);this._des1=r.createEncryptor(i.create(t)),this._des2=r.createEncryptor(i.create(n)),this._des3=r.createEncryptor(i.create(e))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=n._createHelper(t)}(),function(){var e=B,t=e.lib.StreamCipher,n=e.algo,i=n.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,i=this._S=[],r=0;r<256;r++)i[r]=r;for(var r=0,a=0;r<256;r++){var o=r%n,o=t[o>>>2]>>>24-o%4*8&255,a=(a+i[r]+o)%256,o=i[r];i[r]=i[a],i[a]=o}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=r.call(this)},keySize:8,ivSize:0});function r(){for(var e=this._S,t=this._i,n=this._j,i=0,r=0;r<4;r++){var n=(n+e[t=(t+1)%256])%256,a=e[t];e[t]=e[n],e[n]=a,i|=e[(e[t]+e[n])%256]<<24-8*r}return this._i=t,this._j=n,i}e.RC4=t._createHelper(i);n=n.RC4Drop=i.extend({cfg:i.cfg.extend({drop:192}),_doReset:function(){i._doReset.call(this);for(var e=this.cfg.drop;0<e;e--)r.call(this)}});e.RC4Drop=t._createHelper(n)}(),B.mode.CTRGladman=(x=B.lib.BlockCipherMode.extend(),M=x.Encryptor=x.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,r=this._iv,a=this._counter;r&&(a=this._counter=r.slice(0),this._iv=void 0),0===((r=a)[0]=V(r[0]))&&(r[1]=V(r[1]));var o=a.slice(0);n.encryptBlock(o,0);for(var s=0;s<i;s++)e[t+s]^=o[s]}}),x.Decryptor=M,x),M=(D=B).lib.StreamCipher,x=D.algo,I=[],L=[],O=[],x=x.Rabbit=M.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);for(var i=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],r=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]],n=this._b=0;n<4;n++)G.call(this);for(n=0;n<8;n++)r[n]^=i[n+4&7];if(t){var a=t.words,o=a[0],s=a[1],t=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),a=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),o=t>>>16|4294901760&a,s=a<<16|65535&t;r[0]^=t,r[1]^=o,r[2]^=a,r[3]^=s,r[4]^=t,r[5]^=o,r[6]^=a,r[7]^=s;for(n=0;n<4;n++)G.call(this)}},_doProcessBlock:function(e,t){var n=this._X;G.call(this),I[0]=n[0]^n[5]>>>16^n[3]<<16,I[1]=n[2]^n[7]>>>16^n[5]<<16,I[2]=n[4]^n[1]>>>16^n[7]<<16,I[3]=n[6]^n[3]>>>16^n[1]<<16;for(var i=0;i<4;i++)I[i]=16711935&(I[i]<<8|I[i]>>>24)|4278255360&(I[i]<<24|I[i]>>>8),e[t+i]^=I[i]},blockSize:4,ivSize:2}),D.Rabbit=M._createHelper(x),B.mode.CTR=(D=B.lib.BlockCipherMode.extend(),M=D.Encryptor=D.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,r=this._iv,a=this._counter;r&&(a=this._counter=r.slice(0),this._iv=void 0);var o=a.slice(0);n.encryptBlock(o,0),a[i-1]=a[i-1]+1|0;for(var s=0;s<i;s++)e[t+s]^=o[s]}}),D.Decryptor=M,D),M=(x=B).lib.StreamCipher,D=x.algo,j=[],A=[],z=[],D=D.RabbitLegacy=M.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],i=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]],r=this._b=0;r<4;r++)W.call(this);for(r=0;r<8;r++)i[r]^=n[r+4&7];if(t){var a=t.words,o=a[0],e=a[1],t=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),a=16711935&(e<<8|e>>>24)|4278255360&(e<<24|e>>>8),o=t>>>16|4294901760&a,e=a<<16|65535&t;i[0]^=t,i[1]^=o,i[2]^=a,i[3]^=e,i[4]^=t,i[5]^=o,i[6]^=a,i[7]^=e;for(r=0;r<4;r++)W.call(this)}},_doProcessBlock:function(e,t){var n=this._X;W.call(this),j[0]=n[0]^n[5]>>>16^n[3]<<16,j[1]=n[2]^n[7]>>>16^n[5]<<16,j[2]=n[4]^n[1]>>>16^n[7]<<16,j[3]=n[6]^n[3]>>>16^n[1]<<16;for(var i=0;i<4;i++)j[i]=16711935&(j[i]<<8|j[i]>>>24)|4278255360&(j[i]<<24|j[i]>>>8),e[t+i]^=j[i]},blockSize:4,ivSize:2}),x.RabbitLegacy=M._createHelper(D),B.pad.ZeroPadding={pad:function(e,t){t*=4;e.clamp(),e.sigBytes+=t-(e.sigBytes%t||t)},unpad:function(e){for(var t=e.words,n=e.sigBytes-1,n=e.sigBytes-1;0<=n;n--)if(t[n>>>2]>>>24-n%4*8&255){e.sigBytes=n+1;break}}},B}),window.onload=function(){var e=document.createElement("iframe");e.id="zhugeio",e.style.display="none",document.body.appendChild(e);e=e.contentWindow;e.document.open(),e.document.write("<!DOCTYPE html><html><head><script>\n      (function() {\n        window.zhuge = window.zhuge || []\n        window.zhuge.methods = '_init identify track getDid getSid getKey setSuperProperty setUserProperties setWxProperties setPlatform setUTM'.split(' ')\n        window.zhuge.factory = function(b) {\n          return function() {\n            var a = Array.prototype.slice.call(arguments)\n            a.unshift(b)\n            window.zhuge.push(a)\n            return window.zhuge\n          }\n        }\n        for (var i = 0; i < window.zhuge.methods.length; i++) {\n          var key = window.zhuge.methods[i]\n          window.zhuge[key] = window.zhuge.factory(key)\n        }\n        let _href = window.location.href\n        let src = ''\n        let appkey = ''\n        console.log(_href)\n        if (_href.match('prd')) {\n          src = \"https://datain.longfor.com/zhuge.js?v=\"\n          appkey = \"18b7a40e9b184dbaa301c18f6b89854e\"\n        } else {\n          src = \"https://dataintest.longfor.com/zhuge.js?v=\"\n          appkey = \"3d483b7310944f8a9d617217c8b99c7e\"\n        }\n        window.zhuge.load = function(b, x) {\n          if (!document.getElementById('zhuge-js')) {\n            var a = document.createElement('script')\n            var verDate = new Date()\n            var verStr = verDate.getFullYear().toString() + verDate.getMonth().toString() + verDate.getDate().toString()\n      \n            a.type = 'text/javascript'\n            a.id = 'zhuge-js'\n            a.async = !0\n            a.src = src + verStr\n            a.onerror = function() {\n              window.zhuge.identify = window.zhuge.track = function(ename, props, callback) {\n                if (callback && Object.prototype.toString.call(callback) === '[object Function]') {\n                  callback()\n                } else if (Object.prototype.toString.call(props) === '[object Function]') {\n                  props()\n                }\n              }\n            }\n            var c = document.getElementsByTagName('script')[0]\n            c.parentNode.insertBefore(a, c)\n            window.zhuge._init(b, x)\n          }\n        }\n\n        window.zhuge.load(appkey, { //配置应用的AppKey\n          superProperty: { //全局的事件属性(选填)\n            '控件名称': 'webrtc播放器'\n          },\n          debug:false, // 开启实时调试\n          adTrack: false,//广告监测开关，默认为false\n          autoTrack: false,\n          //启用全埋点采集（选填，默认false）\n          singlePage: false //是否是单页面应用（SPA），启用autoTrack后生效（选填，默认false）\n        })\n      })();\n    <\/script></head><body></body></html>"),window.webrtcPlayerIO=e.zhuge},function(){var e=window.navigator.userAgent.toLowerCase(),t=(window.location.origin,document.getElementsByTagName("head")[0]),n=document.createElement("link"),i=(new Date).getTime();n.type="text/css",n.rel="stylesheet",n.href="https://static-iot.longfor.com/lfplayer-v2/0.5.2.4/css/index.css?t=".concat(i),t.appendChild(n);var r=document.createElement("script");r.type="text/javascript",r.src="https://s.longfor.com/public/js/axios.min.js",t.appendChild(r);i=navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i);i&&((r=document.createElement("script")).type="text/javascript",r.src="https://s.longfor.com/public/js/maiaH5.min.js",t.appendChild(r)),i&&-1!==e.indexOf("maiawebkit")&&((r=document.createElement("script")).type="text/javascript",r.src="https://lch.longfor.com/jsbridge3.0/lxjsSdk.js",t.appendChild(r)),0<=e.indexOf("android")||0<=e.indexOf("firefox")?((n=document.createElement("link")).type="text/css",n.rel="stylesheet",n.href="https://static-iot.longfor.com/lfplayer-v2/0.5.2.4/css/video.min.css",t.appendChild(n),(r=document.createElement("script")).type="text/javascript",r.src="https://static-iot.longfor.com/lfplayer-v2/0.5.2.4/js/video.min.js",t.appendChild(r)):(!window.WebSocket||!(window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection)||0<=e.indexOf("msie")||0<=e.indexOf("edge"))&&((r=document.createElement("script")).type="text/javascript",r.src="https://static-iot.longfor.com/lfplayer-v2/0.5.2.4/js/flv.min.js",t.appendChild(r))}(),function(){var i=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,o=(document.fullscreenEnabled||window.fullScreen||document.webkitIsFullScreen||document.msFullscreenEnabled,navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)),s=2001,c=2003,l=1002,d=1005,h=1006,r={applicationName:"未知",userId:"未知",gatewayName:"未知",gatewayId:"未知",deviceName:"未知",deviceId:"未知",width:480,height:270,autoplay:!0,fullscreen:!1,controls:!0,muted:!0,volume:.5,videoOverTime:20,constraints:"{ video: false, audio: false }",wsServer:"wss://webrtc-signal.longfor.com",maxReConnect:20,encoding:"vp8",duration:60,channel:1,toggleChannelAbility:!0,ptzAbility:!1,videoLayoutType:"fill",cameraId:"",isLargeScreen:!1,watermark:"",screenshotType:"front",mode:"webrtc",command:"playReq",startTime:"",endTime:"",showTimeEle:!0,isCheckPlayMtd:!1,env:"prod",pushOnly:!1,advanceTime:15,hlsErrorMaxReconnect:5,errorLogo:1,poster:"",isUseFullscreen:!0,accessChannel:"",isHuiyan:!1,Authorization:"",module:"",moduleText:"",projectId:"",testPlayMtd:"aliVideoLive"},e=function(){function n(e,t){_classCallCheck(this,n),this.options=Object.assign({},r,t),e?"object"===_typeof(e)?this.container=e:"string"==typeof e&&(this.container=document.querySelector(e)):this.container=document.body,this.mediaRecorder=null,this.mediaRecordTimer=null,this.mediaRecordStartTime=null,this.videoContainer=null,this.status=null,this.errorCode=null,this.posterImageUrl="",this.firstPlay=!0,this.videoStreamTimer_a=null,this.videoStreamTimer_b=null,this.durationTimer=null,this.timeLooper=null,this.playInitTime=0,this.rangeTimeOfPlayed=0,this.manualCloseSocketCode=4e3,this.currentShowVideoFlag="a",this.isChangeChannel=!1,this.createSecondVideoFlag=!1,this.cycleTimeout=null,this.isFirefox=0<=navigator.userAgent.indexOf("Firefox"),this.isPause=!1,this.isPlayHandler=!1,this.statisticsStartTime=new Date,this.statisticsEndTime=new Date,this.isDestroy=!1,this.continueTime=this.options.duration-this.options.advanceTime,this.useType="",this.currentTime=-1,this.hlsErrorAttempt=0,this.muted=this.options.muted,this.flvCanplay=!1,this.flvCanplaySetInterval=null,this.flvCanplaySetTimeout=null,this.isOpenWebSocket=!1,this.webrtcStartTime=(new Date).getTime(),this.watermarkInfo={};e=this.options.env;this.options.isHuiyan?"prod"===e?(this.gaiaKey="b95bcd2f-dcec-4e42-aa0c-b2663da47d58",this.baseUrl="https://openapi.longfor.com/iot-video-insight-r-prd"):"sit"===e?(this.gaiaKey="c6c095ac-21b9-4057-8630-ab1f31c96cee",this.baseUrl="https://testapi.longfor.com/video-demonstrate-uat"):"pre"===e?(this.gaiaKey="19943f00-33e0-401a-9ce6-2ab4b4c15f14",this.baseUrl="https://openapi-pre.longfor.com/iot-video-insight-npre"):(this.gaiaKey="85f0938d-3e74-4a90-bd30-56293b546b3e",this.baseUrl="http://api.longfor.uat/iot-video-insight-n-uat"):"prod"===e?(this.gaiaKey="7c70d80c-f8e9-4f29-b6f0-cdc9ddd161b7",this.baseUrl="https://openapi.longfor.com/iot-api-video-open-prd/v2"):"sit"===e?(this.gaiaKey="97e9f599-fbd2-4ccf-a3b8-58ed5c7155b8",this.baseUrl="https://testapi.longfor.com/iot-api-video-open/v2"):(this.gaiaKey="c3cb2428-01bd-407b-a680-f79d07daf75b",this.baseUrl="https://testapi.longfor.com/iot-api-video-base-uat/v2");e=navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i);this.isMobile=e,this.clientType=e?"移动端":"PC端",this.options.pushOnly?this.pushStream():(this.initData(),this.initDOM(),e=this.optionsCheck(),this.options.autoplay&&e&&(window.webrtcPlayerIO&&window.webrtcPlayerIO.identify&&window.webrtcPlayerIO.identify(this.options.watermark),this.statusChangeHandler(h),this.createVideo_a(),this.initPlay_a()))}return _createClass(n,[{key:"pushStream",value:function(){var i=this;this.getCameraStatus(this.options.cameraId).then(function(e){var t,n=JSON.parse(e);200===parseInt(n.code)&&(t=n.data.useType,e=i.options.mode,n=i.isMobile?"hls":"flv",i.useType=t,i.options.mode="webRtc"===t?"webrtc":"isc"===t?"hls":"webrtc"===e?n:e,"webrtc"!==i.options.mode&&i.useFlv_a())})}},{key:"initData",value:function(){var e,t;"number"==typeof this.options.width||+this.options.width?this.options.width="".concat(this.options.width,"px"):+this.options.width.replace("%","")||+this.options.width.replace("px","")||(this.options.width="480px"),"number"==typeof this.options.height||+this.options.height?this.options.height="".concat(this.options.height,"px"):+this.options.height.replace("%","")||+this.options.height.replace("px","")||(this.options.height="270px"),this.connect_attempts=0,this.candidateType_a=[],this.candidateType_b=[],"undefined"==typeof videojs&&(e=document.getElementsByTagName("head")[0],(t=document.createElement("link")).type="text/css",t.rel="stylesheet",t.href="https://static-iot.longfor.com/lfplayer-v2/0.5.2.4/css/video.min.css",e.appendChild(t),(t=document.createElement("script")).type="text/javascript",t.src="https://static-iot.longfor.com/lfplayer-v2/0.5.2.4/js/video.min.js",e.appendChild(t)),"undefined"==typeof flvjs&&(e=document.getElementsByTagName("head")[0],(t=document.createElement("script")).type="text/javascript",t.src="https://static-iot.longfor.com/lfplayer-v2/0.5.2.4/js/flv.min.js",e.appendChild(t))}},{key:"initDOM",value:function(){var e=this;this.videoContainer||(this.videoContainer=document.createElement("div"),this.videoContainer.classList.add("webrtc-video-container"),this.videoContainer.style.width=this.options.width,this.videoContainer.style.height=this.options.height,this.container.appendChild(this.videoContainer),this.createLoadingDOM(),this.createCoverDOM(),this.createPosterDOM(),this.createControlDOM(),this.createPtzDOM(),this.createCodeStreamDom(),this.createErrorDOM(),window.addEventListener("beforeunload",function(){e.playStartTime&&(e.playStartTime=0)}),window.onoffline=function(){e.statusChangeHandler(d,2e3),e.disconnect()},window.ononline=function(){e.config(e.options,!0)})}},{key:"clearImgTimeout",value:function(){var e=this.getImgTimeOut;e&&(clearTimeout(e),this.getImgTimeOut=null)}},{key:"formatTime",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"yyyy-MM-dd hh:mm:ss";if(e){var n,i=new Date(Number(e)),r={"M+":i.getMonth()+1,"d+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds(),"q+":Math.floor((i.getMonth()+3)/3),S:i.getMilliseconds()};for(n in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(i.getFullYear()+"").substr(4-RegExp.$1.length))),r)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?r[n]:("00"+r[n]).substr((""+r[n]).length)))}else t="";return t}},{key:"optionsCheck",value:function(){var n=this,e=!1,t=this.options.isLargeScreen,i=this.options.watermark,r=this.options.accessChannel;return"playBackReq"===this.options.command&&(this.options.startTime&&this.options.endTime||(this.statusChangeHandler(997),e=!0)),i||t||(this.statusChangeHandler(998),e=!0),this.options.cameraId||(this.statusChangeHandler(999),e=!0),r||(this.statusChangeHandler(401),e=!0),e||this.getCameraCoverImage(this.options.cameraId).then(function(i){var t;200==+(i=JSON.parse(i)).code?(i.data&&i.data.serials&&(1<i.data.serials.length&&(n.options.toggleChannelAbility=!0),1===i.data.serials.length&&(n.options.toggleChannelAbility=!1,n.options.channel=i.data.serials[0],n.toggleChannelEle.innerHTML=0==+n.options.channel?"高清":"标清"),0===i.data.serials.length&&(n.disconnect(),n.statusChangeHandler(d,s))),i.data&&i.data.name&&(n.options.cameraName=i.data.name),i.data.imageUrl&&(!n.options.autoplay&&n.firstPlay&&(n.statusChangeHandler(1001),n.firstPlay=!1),t=0,function e(){new Promise(function(e,t){var n=document.createElement("img");n.src=i.data.imageUrl,n.onload=function(){e()},n.onerror=function(){t()}}).then(function(){var e=i.data.imageUrl;n.posterImageUrl=e,n.options.poster||(n.posterImg.style.backgroundImage="url(".concat(e,")"))}).catch(function(){t++<5&&(n.clearImgTimeout(),n.getImgTimeOut=setTimeout(function(){e()},1e3))})}())):!n.options.autoplay&&n.firstPlay&&(n.statusChangeHandler(1001),n.firstPlay=!1)}),!e}},{key:"config",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.currentTime=-1,this.isDestroy=!1,this.isPause=!1,this.statisticsStartTime=new Date,this.isPlayHandler=!1,this.webrtcStartTime=(new Date).getTime(),this.volumeHide(),this.createSecondVideoFlag||(this.options.isLargeScreen&&this.clearTimeLooper(),this.ptzContainer.classList.contains("hide")||this.ptzContainer.classList.add("hide")),this.options=Object.assign({},this.options,e),this.coverPanelEle.removeChild(this.watermark),this.watermark=document.createElement("div"),this.watermark.classList.add("webrtc-watermark");void 0;for(var n=0;n<7;n++){var i=document.createElement("div");i.classList.add("webrtc-watermark-item"),o&&i.classList.add("mobile");var r=this.options.watermark,a=this.watermarkInfo;5===n?(r=a.projectName||"",i.classList.add("webrtc-watermark-project"),this.watermarkProject=i):6===n&&(r=a.pointName||"",i.classList.add("webrtc-watermark-point"),this.watermarkPoint=i),i.innerText=r,this.watermark.appendChild(i)}this.coverPanelEle.appendChild(this.watermark),this.connect_attempts=0,this.initData(),this.resetTimeOut(),this.optionsCheck()&&(window.webrtcPlayerIO&&window.webrtcPlayerIO.identify&&window.webrtcPlayerIO.identify(this.options.watermark),t&&this.statusChangeHandler(h),this.createSecondVideoFlag?"a"===this.currentShowVideoFlag?(this.createVideo_b(),this.initPlay_b()):(this.createVideo_a(),this.initPlay_a()):(this.disconnect(),"a"===this.currentShowVideoFlag?(this.createVideo_a(),this.initPlay_a()):(this.createVideo_b(),this.initPlay_b())))}},{key:"createSVG",value:function(e){var t=document.createElement("div");return t.classList.add("webrtc-btn"),t.classList.add(e),"webrtc-volume"===e&&(t.innerHTML='<div class="webrtc-volume-bg"></div><div class="webrtc-slider-vertical"><div class="webrtc-slider-track"></div><div class="webrtc-slider-thumb"></div></div>'),"volume-range"===e&&(t.innerHTML="<input type='range' id='volumeRange' value='0.5' max='1' min='0' step='0.1'>"),t}},{key:"statusChangeHandler",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";this.status=e,this.errorCode=t;function i(e,t){e&&e.classList.contains(t)&&e.classList.remove(t)}function r(e,t){e&&!e.classList.contains(t)&&e.classList.add(t)}function a(e,t,n){e&&e.classList.contains(t)&&(e.classList.remove(t),e.classList.add(n))}var o=this.options.ptzAbility;997===this.status&&(r(this.coverPanelEle,"hide"),r(this.posterPanelEle,"hide"),r(this.loadingPanelEle,"hide"),r(this.centerReconnectEle,"hide"),i(this.errorPanelEle,"hide"),this.centerErrorTxtEle.innerText="开始和结束时间不能为空"),998===this.status&&(r(this.coverPanelEle,"hide"),r(this.posterPanelEle,"hide"),r(this.loadingPanelEle,"hide"),r(this.centerReconnectEle,"hide"),i(this.errorPanelEle,"hide"),this.centerErrorTxtEle.innerText="水印文字不能为空"),400===this.status&&(r(this.coverPanelEle,"hide"),r(this.posterPanelEle,"hide"),r(this.loadingPanelEle,"hide"),r(this.centerReconnectEle,"hide"),i(this.errorPanelEle,"hide"),this.centerErrorTxtEle.innerText="该摄像头不支持回放"),999===this.status&&(r(this.coverPanelEle,"hide"),r(this.posterPanelEle,"hide"),r(this.loadingPanelEle,"hide"),r(this.centerReconnectEle,"hide"),i(this.errorPanelEle,"hide"),this.centerErrorTxtEle.innerText="摄像头ID不能为空"),401===this.status&&(r(this.coverPanelEle,"hide"),r(this.posterPanelEle,"hide"),r(this.loadingPanelEle,"hide"),r(this.centerReconnectEle,"hide"),i(this.errorPanelEle,"hide"),this.centerErrorTxtEle.innerText="渠道标识不能为空"),1001===this.status&&(r(this.coverPanelEle,"hide"),r(this.errorPanelEle,"hide"),r(this.loadingPanelEle,"hide"),i(this.posterPanelEle,"hide")),1e3===this.status&&(a(this.terminalEle,"webrtc-terminal","webrtc-restart"),a(this.playEle,"webrtc-stop","webrtc-play"),r(this["videoEle_".concat(this.currentShowVideoFlag)],"hide"),r(this.videoEle_b,"hide"),r(this.centerErrorLogo,"hide"),r(this.centerErrorTxtEle,"hide"),r(this.centerReconnectEle,"hide"),r(this.posterImg,"hide"),i(this.centerPlayEle,"hide")),this.status===d&&(t=this.options.isLargeScreen,this.disconnect(),t&&this.errorOverTimeConfig(),this.errorCode===s&&(t=n||"此设备已离线",a(this.playEle,"webrtc-stop","webrtc-play"),r(this.posterPanelEle,"hide"),r(this.loadingPanelEle,"hide"),r(this.coverPanelEle,"hide"),i(this.errorPanelEle,"hide"),this.centerErrorTxtEle.innerText=t),2002===this.errorCode&&(a(this.playEle,"webrtc-stop","webrtc-play"),r(this.posterPanelEle,"hide"),r(this.loadingPanelEle,"hide"),r(this.coverPanelEle,"hide"),i(this.errorPanelEle,"hide"),this.centerErrorTxtEle.innerText="网关已离线"),2007===this.errorCode&&(a(this.playEle,"webrtc-stop","webrtc-play"),r(this.posterPanelEle,"hide"),r(this.loadingPanelEle,"hide"),r(this.coverPanelEle,"hide"),r(this.centerReconnectEle,"hide"),i(this.errorPanelEle,"hide"),this.centerErrorTxtEle.innerText="摄像头不存在"),this.errorCode===c&&(a(this.playEle,"webrtc-stop","webrtc-play"),r(this.posterPanelEle,"hide"),r(this.loadingPanelEle,"hide"),r(this.coverPanelEle,"hide"),i(this.errorPanelEle,"hide"),this.centerErrorTxtEle.innerText="视频加载已超时"),2e3===this.errorCode&&(n=n||"网络连接异常",a(this.playEle,"webrtc-stop","webrtc-play"),r(this.posterPanelEle,"hide"),r(this.loadingPanelEle,"hide"),r(this.coverPanelEle,"hide"),r(this.toggleRecodEle,"disabled"),r(this.codeStreamEle,"disabled"),r(this.cameraEle,"disabled"),r(this.volumeEle,"disabled"),r(this.zoomInEle,"disabled"),r(this.zoomOutEle,"disabled"),r(this.mobileCameraEle,"disabled"),r(this.toggleChannelEle,"disabled"),i(this.errorPanelEle,"hide"),this.centerErrorTxtEle.innerText=n)),this.status===l?(a(this.playEle,"webrtc-play","webrtc-stop"),a(this.terminalEle,"webrtc-restart","webrtc-terminal"),i(this.controlContainer,"disabled"),i(this.toggleRecodEle,"disabled"),i(this.cameraEle,"disabled"),i(this.volumeEle,"disabled"),o&&(i(this.zoomInEle,"disabled"),i(this.zoomOutEle,"disabled")),"webrtc"===this.options.mode&&i(this.codeStreamEle,"disabled"),this.ptzControlEle(),i(this.mobileCameraEle,"disabled"),i(this.toggleChannelEle,"disabled"),r(this.posterPanelEle,"hide"),r(this.errorPanelEle,"hide"),r(this.loadingPanelEle,"hide"),i(this.centerPlayEle,"hide")):this.ptzControlEle("out"),this.status===h&&(a(this.playEle,"webrtc-stop","webrtc-play"),r(this.posterPanelEle,"hide"),r(this.errorPanelEle,"hide"),i(this.coverPanelEle,"hide"),i(this.centerReconnectEle,"hide"),i(this.loadingPanelEle,"hide"),i(this.posterPanelEle,"hide"),r(this.centerPlayEle,"hide")),1009===this.status&&r(this.controlContainer,"disabled"),1008===this.status&&((this.posterImageUrl?i:r)(this.posterImg,"hide"),a(this.terminalEle,"webrtc-terminal","webrtc-restart"),a(this.playEle,"webrtc-stop","webrtc-play"),r(this.cameraEle,"disabled"),r(this.volumeEle,"disabled"),r(this.zoomInEle,"disabled"),r(this.zoomOutEle,"disabled"),r(this.mobileCameraEle,"disabled"),r(this.toggleChannelEle,"disabled"),r(this.toggleRecodEle,"disabled"),r(this.codeStreamEle,"disabled"),r(this.loadingPanelEle,"hide"),r(this.errorPanelEle,"hide"),i(this.posterPanelEle,"hide"))}},{key:"clearAbortTimeOut",value:function(){var e=this.abortTimeOut;e&&(clearTimeout(e),this.abortTimeOut=null)}},{key:"ajax",value:function(){var t,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(n.type=(n.type||"GET").toUpperCase(),n.dataType=n.dataType||"json",window.XMLHttpRequest?t=new XMLHttpRequest:window.ActiveObject&&(t=new ActiveXobject("Microsoft.XMLHTTP")),t.withCredentials=!0,t.open(n.type,n.url,!0),e||n.url.match(/\.m3u8$/g)||t.setRequestHeader("accessChannel",this.options.accessChannel),n.headers)for(var i in n.headers)t.setRequestHeader(i,n.headers[i]);"GET"==n.type?t.send(null):"POST"==n.type&&(t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.send(params)),this.clearAbortTimeOut(),this.abortTimeOut=setTimeout(function(){4!=t.readySate&&t.abort()},n.timeout||1e4),t.onreadystatechange=function(){var e;4==t.readyState&&(200<=(e=t.status)&&e<300||304==e?n.success&&n.success(t.responseText,t.responseXML):n.error&&n.error(e))}}},{key:"isHuiyan",value:function(){return this.options.isHuiyan?0<arguments.length&&void 0!==arguments[0]?arguments[0]:"frontapi/frontapi":"api"}},{key:"getCameraStatus",value:function(i){var r=this;return new Promise(function(t,n){var e=r.isHuiyan();r.ajax({url:"".concat(r.baseUrl,"/").concat(e,"/camera/getCameraPlayCheckInfo?cid=").concat(i),headers:{"x-gaia-api-key":r.gaiaKey},success:function(e){t(e)},error:function(e){n(e)}})})}},{key:"getCameraCoverImage",value:function(i){var r=this;return new Promise(function(t,n){var e=r.isHuiyan();r.ajax({url:"".concat(r.baseUrl,"/").concat(e,"/camera/getCameraThumbnail?cid=").concat(i),headers:{"x-gaia-api-key":r.gaiaKey},success:function(e){t(e)},error:function(e){n(e)}})})}},{key:"getVideoTrackInfo",value:function(){var e=window.navigator.userAgent.toLowerCase(),t=e.match(/iphone/i)?"苹果手机":e.match(/android/i)?"安卓手机":"其他移动设备",n=e.match(/chrome/i)?"谷歌浏览器":e.match(/firefox/i)?"火狐浏览器":"其他浏览器",i=e.match(/android/i)||e.match(/webos/i)||e.match(/iphone/i)||e.match(/ipad/i)||e.match(/ipod/i)||e.match(/blackberry/i)||e.match(/windows phone/i);return{UA:e,equipmentType:i?"移动端":"PC端",equipmentOS:i?t:"",browserType:i?"":n,application:this.options.applicationName,playerWidth:this.options.width,playerHeight:this.options.height,userName:this.options.watermark,userId:this.options.userId,cameraId:this.options.cameraId,cameraName:this.options.cameraName||"未知",gatewayId:this.options.gatewayId||"未知",gatewayName:this.options.gatewayName||"未知",deviceId:this.options.deviceId||"未知",deviceName:this.options.deviceName||"未知",command:this.options.command}}},{key:"toggleRecord",value:function(){this.toggleRecodEle.classList.contains("webrtc-record")?this.startRecord():this.stopRecord()}},{key:"clearSaveVideoPhoto",value:function(){var e=this.saveVideoTimeOut;e&&(clearTimeout(e),this.saveVideoTimeOut=null)}},{key:"saveVideoPhoto",value:function(e,t){var n=document.createElement("a");n.style.display="none",n.href=e,n.target="_blank",n.download="".concat(t.name).concat((new Date).getTime(),".").concat(t.fileType),document.body.appendChild(n),n.click(),this.clearSaveVideoPhoto(),this.saveVideoTimeOut=setTimeout(function(){document.body.removeChild(n),window.URL.revokeObjectURL(e)},100),this.toast(t.tip),t.isPictureSave?(t=t.canvas,this.preview(e,t.width,t.height)):this.recordTitleEle.querySelector(".record-clock").innerHTML="00:00:00"}},{key:"clearMediaRecordTimer",value:function(){var e=this.mediaRecordTimer;e&&(window.clearInterval(e),this.mediaRecordTimer=null)}},{key:"startRecord",value:function(){var e,t,n=this;this.isPlaying&&!this.isChangeChannel?(this.toggleChannelEle.classList.contains("disabled")||this.toggleChannelEle.classList.add("disabled"),this.fullscreenEle.classList.contains("disabled")||this.fullscreenEle.classList.add("disabled"),this.playEle.classList.contains("disabled")||this.playEle.classList.add("disabled"),this.cameraEle.classList.contains("disabled")||this.cameraEle.classList.add("disabled"),this.toggleRecodEle.classList.contains("webrtc-record")&&(this.toggleRecodEle.classList.remove("webrtc-record"),this.toggleRecodEle.classList.add("webrtc-record-stop")),e=null,e=("a"===this.currentShowVideoFlag?this.videoEle_a:this.videoEle_b).captureStream(),t=[],this.mediaRecorder=new MediaRecorder(e,{mimeType:'video/webm; codecs="vp8"'}),this.mediaRecorder.onstop=function(){var e=new Blob(t,{type:"video/mp4"}),e=window.URL.createObjectURL(e);n.saveVideoPhoto(e,{isPictureSave:!1,name:"LfPlayer_videorecord_",fileType:"mp4",tip:"录像保存成功！"})},this.mediaRecorder.ondataavailable=function(e){t.push(e.data)},this.mediaRecorder.start(10),this.clearMediaRecordTimer(),this.recordTitleEle.classList.contains("hide")&&this.recordTitleEle.classList.remove("hide"),this.mediaRecordStartTime=(new Date).getTime(),this.mediaRecordTimer=setInterval(function(){n.recordTitleEle.querySelector(".record-clock").innerHTML=n.time_dis(n.mediaRecordStartTime),36e5<(new Date).getTime()-n.mediaRecordStartTime&&n.stopRecord()},1e3)):this.isPlaying?this.toast("清晰度切换中，请稍等"):this.toast("请先播放视频")}},{key:"stopRecord",value:function(){this.status===l&&(this.toggleChannelEle.classList.contains("disabled")&&this.toggleChannelEle.classList.remove("disabled"),this.fullscreenEle.classList.contains("disabled")&&this.fullscreenEle.classList.remove("disabled"),this.playEle.classList.contains("disabled")&&this.playEle.classList.remove("disabled"),this.cameraEle.classList.contains("disabled")&&this.cameraEle.classList.remove("disabled")),this.mediaRecorder&&(this.toggleRecodEle.classList.contains("webrtc-record-stop")&&(this.toggleRecodEle.classList.remove("webrtc-record-stop"),this.toggleRecodEle.classList.add("webrtc-record")),this.mediaRecorder.stop(),this.mediaRecorder=null),this.clearMediaRecordTimer(),this.recordTitleEle.classList.contains("hide")||this.recordTitleEle.classList.add("hide")}},{key:"destroyMediaRecorder",value:function(){this.status===l&&(this.toggleChannelEle.classList.contains("disabled")&&this.toggleChannelEle.classList.remove("disabled"),this.fullscreenEle.classList.contains("disabled")&&this.fullscreenEle.classList.remove("disabled"),this.playEle.classList.contains("disabled")&&this.playEle.classList.remove("disabled"),this.cameraEle.classList.contains("disabled")&&this.cameraEle.classList.remove("disabled")),this.mediaRecorder&&(this.mediaRecorder.pause(),this.mediaRecorder=null),this.clearMediaRecordTimer(),this.recordTitleEle.classList.contains("hide")||this.recordTitleEle.classList.add("hide"),this.toggleRecodEle.classList.contains("disabled")||this.toggleRecodEle.classList.add("disabled"),this.toggleRecodEle.classList.contains("webrtc-record-stop")&&(this.toggleRecodEle.classList.remove("webrtc-record-stop"),this.toggleRecodEle.classList.add("webrtc-record"))}},{key:"createLoadingDOM",value:function(){this.loadingPanelEle=document.createElement("div"),this.loadingPanelEle.classList.add("webrtc-poster","hide","flex-center","posterLoading"),this.loadingPanelEle.innerHTML='<div class="loading-container"><div class="webrtc-loading"></div><p class="webrtc-loading-txt">视频加载中...</p></div>',this.videoContainer.appendChild(this.loadingPanelEle)}},{key:"createCoverDOM",value:function(){this.coverPanelEle=document.createElement("div"),this.coverPanelEle.classList.add("webrtc-poster","z-index-top"),this.titleEle=document.createElement("span"),this.titleEle.classList.add("webrtc-title-txt"),this.recordTitleEle=document.createElement("div"),this.recordTitleEle.classList.add("webrtc-record-title","hide"),this.recordTitleEle.innerHTML='<i class="record-icon"></i><span class="record-txt">录像中</span><span class="record-clock">00:00:00</span>',this.watermark=document.createElement("div"),this.watermark.classList.add("webrtc-watermark");void 0;for(var e=0;e<7;e++){var t=document.createElement("div");t.classList.add("webrtc-watermark-item"),o&&t.classList.add("mobile");var n=this.options.watermark,i=this.watermarkInfo;5===e?(n=i.projectName||"",t.classList.add("webrtc-watermark-project"),this.watermarkProject=t):6===e&&(n=i.pointName||"",t.classList.add("webrtc-watermark-point"),this.watermarkPoint=t),t.innerText=n,this.watermark.appendChild(t)}this.coverPanelEle.appendChild(this.titleEle),this.coverPanelEle.appendChild(this.watermark),this.coverPanelEle.appendChild(this.recordTitleEle),this.videoContainer.appendChild(this.coverPanelEle)}},{key:"errorOverTimeConfig",value:function(){this.isDestroy||(this.status=null,this.config(this.options,!1))}},{key:"createErrorDOM",value:function(){var e=this,t=(this.options.isLargeScreen,this.options.errorLogo);this.errorPanelEle=document.createElement("div"),this.errorPanelEle.classList.add("webrtc-poster","flex-center","hide"),this.centerErrorLogo=document.createElement("div"),1===t?this.centerErrorLogo.classList.add("webrtc-center-error-logo"):this.centerErrorLogo.classList.add("webrtc-center-qianding-error-logo"),this.centerErrorTxtEle=document.createElement("span"),this.centerErrorTxtEle.classList.add("webrtc-center-error-message"),this.errorPanelEle.appendChild(this.centerErrorLogo),this.errorPanelEle.appendChild(this.centerErrorTxtEle),this.centerReconnectEle=document.createElement("div"),this.centerReconnectEle.innerText="重新加载",this.centerReconnectEle.classList.add("webrtc-reconnect-btn"),this.centerReconnectEle.addEventListener("click",function(){e.config(e.options,!0)}),this.errorPanelEle.appendChild(this.centerReconnectEle),this.videoContainer.appendChild(this.errorPanelEle)}},{key:"createPosterDOM",value:function(){var e=this;this.posterPanelEle=document.createElement("div"),this.posterPanelEle.classList.add("webrtc-poster"),this.options.isLargeScreen||(this.centerPlayEle=document.createElement("div"),this.centerPlayEle.classList.add("webrtc-center-play-icon"),this.centerPlayEle.addEventListener("click",function(){e.volumeHide(),e.config(e.options)}),this.posterPanelEle.appendChild(this.centerPlayEle)),this.posterImg=document.createElement("div"),"contain"===this.options.videoLayoutType?this.posterImg.classList.add("webrtc-poster-pic-contain"):this.posterImg.classList.add("webrtc-poster-pic-fill"),this.posterImg.style.backgroundImage="url(".concat(this.options.poster,")"),this.posterPanelEle.appendChild(this.posterImg),this.videoContainer.appendChild(this.posterPanelEle)}},{key:"codeStremHtml",value:function(e){var t=this.isMobile;this.codeStreamContainer.innerHTML="<ul class='".concat(t?"streamInfo mobile":"streamInfo","'>\n                                              <li>分辨率：").concat(e.dpi,"</li>\n                                              <li class='").concat(t?"hide":"show","'>帧率：").concat(e.fps,"</li>\n                                              <li>码率：").concat(e.kbps,"</li>\n                                              <li>编码格式: ").concat(e.encode,"</li>\n                                            </ul>")}},{key:"createCodeStreamDom",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{dpi:"",fps:"",kbps:"",encode:""};this.codeStreamContainer?this.codeStremHtml(e):(this.codeStreamContainer=document.createElement("div"),this.codeStremHtml(e),this.codeStreamContainer.classList.add("code-stream-container","hide"),this.videoContainer.appendChild(this.codeStreamContainer))}},{key:"createPtzDOM",value:function(){this.ptzContainer||(this.ptzContainer=document.createElement("div"),this.ptzContainer.classList.add("webrtc-ptz-container","hide"),o||this.ptzContainer.classList.add("big"),this.videoContainer.appendChild(this.ptzContainer),this.ptzTopEle=document.createElement("div"),this.ptzTopEle.classList.add("top","webrtc-ptz-btn"),o||this.ptzTopEle.classList.add("big"),this.ptzLeftEle=document.createElement("div"),this.ptzLeftEle.classList.add("left","webrtc-ptz-btn"),o||this.ptzLeftEle.classList.add("big"),this.ptzCenterEle=document.createElement("div"),this.ptzCenterEle.classList.add("webrtc-ptz-icon"),o||this.ptzCenterEle.classList.add("big"),this.ptzRightEle=document.createElement("div"),this.ptzRightEle.classList.add("right","webrtc-ptz-btn"),o||this.ptzRightEle.classList.add("big"),this.ptzBottomEle=document.createElement("div"),this.ptzBottomEle.classList.add("bottom","webrtc-ptz-btn"),o||this.ptzBottomEle.classList.add("big"),this.ptzContainer.appendChild(this.ptzTopEle),this.ptzContainer.appendChild(this.ptzLeftEle),this.ptzContainer.appendChild(this.ptzCenterEle),this.ptzContainer.appendChild(this.ptzRightEle),this.ptzContainer.appendChild(this.ptzBottomEle),this.initPtzEvent())}},{key:"ptzHandler",value:function(e){var t={id:this.options.cameraId,command:e,step:5,movement:"relative"},e=this.isHuiyan("frontapi/frontapi/point");return axios({url:this.baseUrl+"/".concat(e,"/ptzCamera"),method:"post",data:t,headers:{"x-gaia-api-key":this.gaiaKey,accessChannel:this.options.accessChannel,Authorization:this.options.Authorization}})}},{key:"getTrackMain",value:function(){var e=this.clientType,t=this.options.accessChannel,t="huiyan"===t?"慧眼":t;return"".concat(e,"_").concat(t,"_")}},{key:"initPtzEvent",value:function(){var t=this,n=this.getTrackMain();this.ptzTopEle.addEventListener("click",function(){var e=t.getVideoTrackInfo();window.webrtcPlayerIO&&window.webrtcPlayerIO.track&&window.webrtcPlayerIO.track("".concat(n,"云台控制向上"),_objectSpread(_objectSpread({},e),{},{timeStamp:(new Date).getTime()})),t.ptzHandler("up").then(function(){t.toast("操作成功",1e3)})}),this.ptzLeftEle.addEventListener("click",function(){var e=t.getVideoTrackInfo();window.webrtcPlayerIO&&window.webrtcPlayerIO.track&&window.webrtcPlayerIO.track("".concat(n,"云台控制向左"),_objectSpread(_objectSpread({},e),{},{timeStamp:(new Date).getTime()})),t.ptzHandler("left").then(function(){t.toast("操作成功",1e3)})}),this.ptzRightEle.addEventListener("click",function(){var e=t.getVideoTrackInfo();window.webrtcPlayerIO&&window.webrtcPlayerIO.track&&window.webrtcPlayerIO.track("".concat(n,"云台控制向右"),_objectSpread(_objectSpread({},e),{},{timeStamp:(new Date).getTime()})),t.ptzHandler("right").then(function(){t.toast("操作成功",1e3)})}),this.ptzBottomEle.addEventListener("click",function(){var e=t.getVideoTrackInfo();window.webrtcPlayerIO&&window.webrtcPlayerIO.track&&window.webrtcPlayerIO.track("".concat(n,"云台控制向下"),_objectSpread(_objectSpread({},e),{},{timeStamp:(new Date).getTime()})),t.ptzHandler("down").then(function(){t.toast("操作成功",1e3)})})}},{key:"createControlDOM",value:function(){var e,t;this.controlContainer||(t=this.options.isLargeScreen,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("webrtc-control-container"),t&&this.controlContainer.classList.add("hide"),this.controlContainer.style.position="absolute",this.videoContainer.appendChild(this.controlContainer),e=document.createDocumentFragment(),this.playEle=this.createSVG(this.options.autoplay?"webrtc-stop":"webrtc-play"),this.timeEle=document.createElement("span"),this.timeEle.classList.add("webrtc-time"),this.timeEle.innerText="00:00:00",this.disabledCover=document.createElement("div"),this.disabledCover.classList.add("disabled-cover"),this.terminalEle=this.createSVG("webrtc-restart"),(t=document.createElement("div")).style.flex=1,this.fullscreenEle=this.createSVG("webrtc-fullscreen"),this.cameraEle=this.createSVG("camera"),this.cameraEle.classList.add("disabled"),this.muted?this.volumeEle=this.createSVG("webrtc-muted"):this.volumeEle=this.createSVG("webrtc-volume"),this.volumeEle.classList.add("disabled"),o||(this.volumeRange=this.createSVG("volume-range"),this.volumeRange.classList.add("volume-range-hide")),this.mobileCameraEle=this.createSVG("camera"),this.mobileCameraEle.classList.add("disabled"),this.zoomInEle=this.createSVG("zoom-in"),this.zoomInEle.classList.add("disabled","hide"),this.zoomOutEle=this.createSVG("zoom-out"),this.zoomOutEle.classList.add("disabled","hide"),this.codeStreamEle=this.createSVG("codeStream"),this.codeStreamEle.classList.add("disabled","hide"),this.toggleChannelEle=document.createElement("div"),this.toggleChannelEle.classList.add("webrtc-toggle-channel-btn","disabled"),this.toggleChannelEle.innerHTML=0==+this.options.channel?"高清":"标清",this.toggleRecodEle=this.createSVG("webrtc-record"),this.toggleRecodEle.classList.add("disabled"),e.appendChild(this.terminalEle),o||this.volumeEle.appendChild(this.volumeRange),"playBackReq"===this.options.command&&e.appendChild(this.playEle),e.appendChild(this.disabledCover),this.options.isLargeScreen||"playReq"===this.options.command&&this.options.showTimeEle&&e.appendChild(this.timeEle),e.appendChild(t),e.appendChild(this.zoomInEle),e.appendChild(this.zoomOutEle),e.appendChild(this.codeStreamEle),this.options.isLargeScreen||(e.appendChild(this.toggleChannelEle),o||e.appendChild(this.toggleRecodEle),o||e.appendChild(this.cameraEle)),e.appendChild(this.volumeEle),e.appendChild(this.fullscreenEle),this.controlContainer.appendChild(e),this.initControlEvent())}},{key:"initControlEvent",value:function(){var i,e,r=this;this.playEle.addEventListener("click",function(){"a"===r.currentShowVideoFlag?r.togglePlay_a():r.togglePlay_b()}),this.terminalEle.addEventListener("click",function(){r.isPlayHandler=!1,"a"===r.currentShowVideoFlag?r.toggleStart_a():r.toggleStart_b()}),this.toggleRecodEle.addEventListener("click",function(){r.toggleRecord()}),this.toggleChannelEle.addEventListener("click",function(){var e,t;r.isPlayHandler=!1,r.options.toggleChannelAbility&&(r.isChangeChannel||r.mediaRecorder||(e=r.getVideoTrackInfo(),window.webrtcPlayerIO&&window.webrtcPlayerIO.track&&(t=r.getTrackMain(),window.webrtcPlayerIO.track("".concat(t,"切换").concat(0===r.options.channel?"标清":"高清"),_objectSpread(_objectSpread({},e),{},{timeStamp:(new Date).getTime()}))),r.createSecondVideoFlag=!0,r.isChangeChannel=!0,r.config({channel:Math.abs(r.options.channel-1)},!1),r.toast("高清/标清切换中…",0)))}),this.volumeEle.addEventListener("click",function(){var e;o?(e=null,e="webRtc"===r.useType?r.videoEle_a||r.videoEle_b:document.getElementById("video_a_html5_api")||document.getElementById("video_b_html5_api"),r.volumeEle.classList.contains("webrtc-muted")?(r.volumeEle.classList.add("webrtc-volume"),r.volumeEle.classList.remove("webrtc-muted")):(r.volumeEle.classList.add("webrtc-muted"),r.volumeEle.classList.remove("webrtc-volume")),e.muted?(e.muted=!1,e.volume=r.options.volume):e.muted=!0,r.muted=e.muted):r.volumeControl()},!0),this.cameraEle.addEventListener("click",function(){r.screenshot()}),this.zoomInEle.addEventListener("click",function(){r.zoomInOut("in")}),this.zoomOutEle.addEventListener("click",function(){r.zoomInOut("out")}),this.codeStreamEle.addEventListener("click",function(){r.codeStream()}),this.mobileCameraEle.addEventListener("click",function(){r.mobileScreenshot()}),this.fullscreenEle.addEventListener("click",function(){r.toggleFullscreen()}),o||((i=document.getElementById("volumeRange")).addEventListener("change",function(e){var t=i.value,n=r.videoEle_a||r.videoEle_b;0===parseFloat(t)?(r.volumeEle.classList.contains("webrtc-muted")||(r.volumeEle.classList.add("webrtc-muted"),r.volumeEle.classList.remove("webrtc-volume")),n.muted=!0):(r.volumeEle.classList.contains("webrtc-volume")||(r.volumeEle.classList.add("webrtc-volume"),r.volumeEle.classList.remove("webrtc-muted")),n.muted=!1),n.volume=parseFloat(t),r.muted=n.muted},!0),e=this.videoContainer,this.eventUtil().addHandler(e,"fullscreenchange",function(){r.checkFull()}))}},{key:"eventUtil",value:function(){return{addHandler:function(e,t,n){e.addEventListener?e.addEventListener(t,n):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},removeHandler:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n):e.deattachEvent?e.deattachEvent("on"+t,n):e["on"+t]=null}}}},{key:"checkFull",value:function(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement||!this.options.fullscreen||this.fullscreenExit(!1)}},{key:"volumeHide",value:function(){var e=this.volumeRange;e&&e.classList.contains("volume-range-show")&&(e.classList.add("volume-range-hide"),e.classList.remove("volume-range-show"))}},{key:"volumeControl",value:function(){var e=this.volumeRange;e.classList.contains("volume-range-hide")?(e.classList.add("volume-range-show"),e.classList.remove("volume-range-hide")):(e.classList.add("volume-range-hide"),e.classList.remove("volume-range-show"))}},{key:"toggleChannelEleDisabled",value:function(e){"playBackReq"!==this.options.command&&"gb28181"!==e||(this.toggleChannelEle.classList.add("disabledToggle"),this.options.channel=0)}},{key:"setTitle",value:function(e){var t;this.options.isLargeScreen||(t=e.data.areaCameraName)&&(e={projectName:(e=(t=(e=t.split("/"))[e.length-1].replace(/#/,"/")).split("/"))[0],pointName:e[1]},this.watermarkInfo=e,this.watermarkProject.innerText=e.projectName,this.watermarkPoint.innerText=e.pointName,this.titleEle.innerText=t)}},{key:"initPlay_a",value:function(){var r=this;this.openWebSocket("a"),this.getCameraStatus(this.options.cameraId).then(function(e){var t=JSON.parse(e),n=r.webrtcStartTime,i=(new Date).getTime(),e=Math.abs((i-n)/1e3);void 0,200===parseInt(t.code)&&t.data?(r.setTitle(t),i=t.data.ptzService,t.data.webRtcSignalServer?(n=t.data.webRtcSignalServer,e="wss"===t.data.webRtcSignalServer.split(":")[0]?"https":"http",r.options.wsServer=n,r.options.wsServerProtocol=e,sessionStorage.setItem("webrtcUrl",JSON.stringify({wsServer:n,wsServerProtocol:e})),r.options.wsServer.split("//")[1]?(i&&0!==parseInt(i)||(r.options.ptzAbility=!1),i&&"0"!==i&&r.zoomInEle.classList.contains("hide")&&(r.zoomInEle.classList.remove("hide"),r.zoomOutEle.classList.remove("hide")),r.options.gatewayName=t.data.gatewayName,r.options.gatewayId=t.data.gatewayId,r.options.deviceName=t.data.deviceName,r.options.deviceId=t.data.deviceId,e=t.data.useType,i=r.options.isCheckPlayMtd,e=r.options.isLargeScreen?r.options.testPlayMtd:o&&"isc"!==e?"webRtc":e,r.useType=e,r.toggleChannelEleDisabled(e),i||(r.options.mode="webRtc"===e?"webrtc":"isc"===e?"hls":"flv"),"webrtc"===r.options.mode?(r.codeStreamEle.classList.contains("hide")&&r.codeStreamEle.classList.remove("hide"),r.webrtcWebsocket("a")):r.websocketServerConnect_a()):r.statusChangeHandler(d,s)):r.statusChangeHandler(d,s)):(t=t.msg,r.statusChangeHandler(d,s,t))}).catch(function(e){r.statusChangeHandler(d,2e3,"获取设备状态失败")})}},{key:"webrtcServer",value:function(e){"a"===e?this.websocketServerConnect_a():this.websocketServerConnect_b()}},{key:"webrtcWebsocket",value:function(d){var h=this;try{this.ajax({url:"".concat(this.options.wsServerProtocol,"://").concat(this.options.wsServer.split("//")[1],"/servers"),success:function(e){if(e){var t=JSON.parse(e);if(t.encrypted){for(var n,i=-1;!(n=h.decrypt(t.encrypted,i++))&&i<=1;);h.iceServers=[];var r,a=_createForOfIteratorHelper(n.stun);try{for(a.s();!(r=a.n()).done;){var o=r.value;h.iceServers.push({urls:o.replace("//","")})}}catch(e){a.e(e)}finally{a.f()}var s,c=_createForOfIteratorHelper(n.turn);try{for(c.s();!(s=c.n()).done;){var l=s.value;h.iceServers.push({urls:l.serverAddress.replace("//",""),username:l.user,credential:l.password})}}catch(e){c.e(e)}finally{c.f()}h.webrtcServer(d)}}},error:function(e){h.iceServers=[{urls:"turn:40.73.35.178:3478",username:"longfor",credential:"longforiot"},{urls:"stun:40.73.22.130:3478"}],h.webrtcServer(d)}},!0)}catch(e){this.iceServers=[{urls:"turn:40.73.35.178:3478",username:"longfor",credential:"longforiot"},{urls:"stun:40.73.22.130:3478"}],this.webrtcServer(d)}}},{key:"canplaythroughHandler",value:function(){var e;this.codeStream("isShow"),this.flvCanplay=!0,this.videoEle_a&&(this.statusChangeHandler(l),this.isPlaying=!0,this.playStartTime=(new Date).getTime(),this.statisticsEndTime=new Date,e=this.statisticsStartTime,e=this.statisticsEndTime.getTime()-e.getTime(),void 0,this.play_a(),this.toggleChannelEle&&(this.toggleChannelEle.innerHTML=0==+this.options.channel?"高清":"标清"))}},{key:"clearDurationStreamTime",value:function(){var e=this.continueStreamTime;e&&(clearTimeout(e),this.continueStreamTime=null);e=this.continueStreamIntervalTime;e&&(clearTimeout(e),this.continueStreamIntervalTime=null)}},{key:"continueStreamRequest",value:function(){var t=this,e=this.baseUrl,n=this.isHuiyan(),e="".concat(e,"/").concat(n,"/camera/getPlayUrlByDirectMode?serial=").concat(this.options.channel,"&id=").concat(this.options.cameraId),n=this.gaiaKey;try{this.ajax({url:e,headers:{"x-gaia-api-key":n},success:function(e){200!=+JSON.parse(e).code?t.durationConfig():(t.resetTimeOut(),t.delayStop(),t.continueStreamIntervalTime=setTimeout(function(){t.continueStreamRequest()},1e3*t.continueTime))}})}catch(e){this.durationConfig()}}},{key:"continueStream",value:function(){var e=this;this.resetTimeOut();var t=this.options.mode,n=this.useType;"webrtc"!==t&&"gb28181"!==n&&(this.continueStreamTime=setTimeout(function(){e.continueStreamRequest()},1e3*this.continueTime))}},{key:"changeCodeStream",value:function(){this.destroy_b(),this.isChangeChannel?(this.videoContainer.appendChild(this.videoEle_a),this.toggleChannelEle.innerHTML=0==+this.options.channel?"高清":"标清",this.toast("已切换至".concat(this.toggleChannelEle.innerHTML),500),this.isPlaying=!0,this.isChangeChannel=!1):this.videoContainer.appendChild(this.videoEle_a),this.currentShowVideoFlag="a",this.toggleRecodEle.classList.contains("disabled")&&this.toggleRecodEle.classList.remove("disabled"),this.createSecondVideoFlag=!1}},{key:"flvCanplayFn",value:function(){var e=this;this.flvCanplaySetTimeout=setTimeout(function(){e.flvCanplay||(e.clearFlvCanplayInterval(),e.toast("切换超时，请重试"))},1e3*this.options.videoOverTime)}},{key:"playHandler",value:function(){var e,t,n=this,i=this.options.isLargeScreen;this.isPlayHandler=!0,this.flvCanplay=!1,this.clearFlvCanplayInterval(),this.clearFlvCanplayTimeout(),this.openAudio(),this.videoEle_a&&(this.connect_attempts=0,this.clearVideoStreamTimer_a(),this.createSecondVideoFlag?"flv"===(t=this.options.mode)||"hls"===t?(this.flvCanplaySetInterval=setInterval(function(){n.flvCanplay&&(n.changeCodeStream(),n.clearFlvCanplayTimeout(),clearInterval(n.flvCanplaySetInterval),n.flvCanplaySetInterval=null)},100),this.flvCanplayFn()):this.changeCodeStream():(e=this.getVideoTrackInfo(),window.webrtcPlayerIO&&window.webrtcPlayerIO.track&&(t=this.getTrackMain(),window.webrtcPlayerIO.track("".concat(t,"播放成功"),_objectSpread(_objectSpread({},e),{},{timeStamp:(new Date).getTime()}))),this.ptzControlEle(),0===this.playInitTime&&(this.playInitTime=(new Date).getTime()),this.status!==d&&(i||(this.clearTimeLooper(),this.timeLooper=setInterval(function(){n.timeEle.innerText=n.time_dis(n.playInitTime)},1e3)),0!==this.options.duration&&"playReq"===this.options.command&&this.continueStream()),this.videoContainer.appendChild(this.videoEle_a)),this.delayStop())}},{key:"clearDelaySetInvertal",value:function(){var e=this.delaySetInvertal;e&&(clearInterval(e),this.delaySetInvertal=null)}},{key:"delay",value:function(t){var n=this;this.clearDelaySetInvertal(),this.delaySetInvertal=setInterval(function(){var e=t.buffered;e.length&&10<e.end(0)-t.currentTime&&n.config(n.options)},1e3)}},{key:"delayStop",value:function(){this.monitorStop()}},{key:"clearStopSetIntertal",value:function(){var e=this.stopSetIntertal;e&&(clearInterval(e),this.stopSetIntertal=null)}},{key:"monitorStop",value:function(){var t=this;this.clearStopSetIntertal(),this.stopSetIntertal=setInterval(function(){var e=t.currentTime;t.isPlaying;-1!==e?t.currentTime=-1:(void 0,t.config(t.options))},5e3)}},{key:"durationConfig",value:function(){var t=this;this.clearDurationTimer(),this.durationTimer=setTimeout(function(){var e=!isLargeScreen;t.disconnect(),t.statusChangeHandler(1008),t.config(t.options,e)},1e3*this.options.duration)}},{key:"onPlayEnd",value:function(){this.config(this.options)}},{key:"endHandler",value:function(){"a"===this.currentShowVideoFlag&&"function"==typeof this.onPlayEnd&&this.onPlayEnd()}},{key:"openAudio",value:function(){var e=this.videoEle_a||this.videoEle_b;"hls"===this.options.mode&&(e=document.getElementById("video_a_html5_api")||document.getElementById("video_b_html5_api"));try{this.muted||(e.muted=!1)}catch(e){void 0}}},{key:"createVideo_a",value:function(){var n=this,e=o?"mobile":"pc",t=document.createElement("div");t.innerHTML='<video class="'.concat(e," ").concat("contain"===this.options.videoLayoutType?"webrtc-video":"webrtc-video-fill",'" id="video_a" crossorigin="anonymous" src="" webkit-playsinline playsinline autoplay muted>Your browser doesn\'t support video</video>'),this.videoEle_a=t.childNodes[0],this.videoEle_a.addEventListener("canplay",function(e){"webrtc"===n.options.mode&&(n.isPlayHandler||n.playHandler()),n.canplaythroughHandler()}),this.videoEle_a.addEventListener("play",function(){"webrtc"===n.options.mode&&n.isPlayHandler||n.playHandler()}),this.videoEle_a.addEventListener("ended",function(e){n.endHandler()}),this.videoEle_a.addEventListener("timeupdate",function(e){var t=n.videoEle_a;t&&(t=t.currentTime,n.currentTime=t)}),this.videoEle_a.addEventListener("error",function(e){})}},{key:"clearVideoStreamTimer_a",value:function(){var e=this.videoStreamTimer_a;e&&(clearTimeout(e),this.videoStreamTimer_a=null)}},{key:"clearVideoStreamTimer_b",value:function(){var e=this.videoStreamTimer_b;e&&(clearTimeout(e),this.videoStreamTimer_b=null)}},{key:"websocketServerConnect_a",value:function(){var n=this;if(this.clearVideoStreamTimer_a(),this.videoStreamTimer_a=setTimeout(function(){var e,t;n.createSecondVideoFlag?(n.videoEle_b&&(n.isChangeChannel&&(n.toast("切换超时，请重试"),n.options.channel=Math.abs(n.options.channel-1),n.toggleChannelEle.innerHTML=0==+n.options.channel?"高清":"标清",n.isChangeChannel=!1,t=n.getVideoTrackInfo(),window.webrtcPlayerIO&&window.webrtcPlayerIO.track&&(e=n.getTrackMain(),window.webrtcPlayerIO.track("".concat(e,"切换失败"),_objectSpread(_objectSpread({},t),{},{timeStamp:(new Date).getTime()})))),n.destroy_a()),n.createSecondVideoFlag=!1):n.status!==l&&n.status!==d&&(n.destroy_a(),n.playInitTime=0,n.rangeTimeOfPlayed=0,n.timeEle.innerText="00:00:00",n.clearTimeLooper(),e=n.getVideoTrackInfo(),window.webrtcPlayerIO&&window.webrtcPlayerIO.track&&(t=n.getTrackMain(),window.webrtcPlayerIO.track("".concat(t,"播放失败"),_objectSpread(_objectSpread({},e),{},{timeStamp:(new Date).getTime()}))),n.statusChangeHandler(d,c))},1e3*this.options.videoOverTime),this.options.mode&&"webrtc"!==this.options.mode||!window.WebSocket||!i)this.startTime=(new Date).getTime(),this.useFlv_a();else{if(this.connect_attempts++,"a"===this.currentShowVideoFlag&&this.status!==d&&this.statusChangeHandler(h),this.connect_attempts>this.options.maxReConnect)return"a"===this.currentShowVideoFlag?("function"==typeof this.onMaxReConnect&&this.onMaxReConnect(),this.clearTimeLooper(),this.status!==d&&this.statusChangeHandler(d,c),this.setError("Too many connection attempts, aborting. Refresh page to try again")):this.isChangeChannel&&(this.toast("切换超时，请重试"),this.isChangeChannel=!1,this.options.channel=Math.abs(this.options.channel-1),this.toggleChannelEle.innerHTML=0==+this.options.channel?"高清":"标清"),void this.destroy_a();if(sessionStorage.getItem("webrtcUrl")&&this.isOpenWebSocket)this.isOpenWebSocket?this.sendMsg_a(this.options):(this.clearSendMsgInterval(),this.sendMsgInterval=setInterval(function(){n.isOpenWebSocket&&(clearInterval(n.sendMsgInterval),n.sendMsgInterval=null,n.sendMsg_a(n.options))},10));else{if(window.location.protocol.startsWith("file"))e=this.options.wsServer||"127.0.0.1";else{if(!window.location.protocol.startsWith("http"))throw new Error("Don't know how to connect to the signalling server with uri"+window.location);e=this.options.wsServer||window.location.hostname}var e=e;this.setStatus("Connecting to server "+e),this.ws_conn_a=new WebSocket(e),this.ws_conn_a.addEventListener("open",function(e){void 0,n.sendMsg_a(n.options)})}try{this.ws_conn_a.addEventListener("error",function(){n.onServerError_a()}),this.ws_conn_a.addEventListener("message",function(e){n.onServerMessage_a(e)}),this.ws_conn_a.addEventListener("close",function(e){void 0,n.onServerClose_a(e)})}catch(e){void 0}}}},{key:"openWebSocket",value:function(){var n=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"a",t=sessionStorage.getItem("webrtcUrl");if(t){var i=JSON.parse(t),t=window.location.protocol;if(t.startsWith("file")||t.startsWith("app"))r=i.wsServer||"127.0.0.1";else{if(!t.startsWith("http"))throw new Error("Don't know how to connect to the signalling server with uri"+window.location);r=i.wsServer||window.location.hostname}var r=r;this.setStatus("Connecting to server "+r);try{var a=new WebSocket(r);this.isOpenWebSocket=!1,a.addEventListener("open",function(){var e=n.webrtcStartTime,t=(new Date).getTime(),e=Math.abs((t-e)/1e3);void 0,void 0,n.isOpenWebSocket=!0}),"a"===e?this.ws_conn_a=a:this.ws_conn_b=a}catch(e){void 0}}}},{key:"errorHandler",value:function(e){var t=this;void 0;var n="gb28181"===this.useType?6e4:500;this.connect_attempts<this.options.maxReConnect?(this.connect_attempts+=1,this.clearCycleTimeout(),this.cycleTimeout=setTimeout(function(){"a"===e?t.useFlv_a():t.useFlv_b()},n)):(this.currentShowVideoFlag===e?("function"==typeof this.onMaxReConnect&&this.onMaxReConnect(),this.statusChangeHandler(d,c),this.setError("m3u8/flv, aborting. Refresh page to try again")):this.isChangeChannel&&(this.toast("切换超时，请重试"),this.isChangeChannel=!1,this.options.channel=Math.abs(this.options.channel-1),this.toggleChannelEle.innerHTML=0==+this.options.channel?"高清":"标清"),"a"===e?this.destroy_a():this.destroy_b())}},{key:"playerHlsA",value:function(e){var t=this.muted,n=this;this.hlsplayer_a=videojs(this.videoEle_a,{html5:{hls:{overrideNative:!1},nativeVideoTracks:!0,nativeAtudioTracks:!0,nativeTextTracks:!0},poster:"",muted:t,controls:!1,sources:[{src:e.payload.hlsUrl,type:"application/x-mpegURL"}]},function(){this.on("canplay",function(){n.hlsErrorAttempt=0,n.canplaythroughHandler()}),this.on("play",function(){n.playHandler()}),this.on("ended",function(){n.endHandler()}),this.on("timeupdate",function(){try{var e=this.currentTime;n.currentTime=e}catch(e){}}),this.on("error",function(){})})}},{key:"hlsPlay_a",value:function(t){var n=this;this.ajax({url:t.payload.hlsUrl,success:function(e){n.videoContainer.appendChild(n.videoEle_a),n.videoEle_a.style.width=n.options.width,n.videoEle_a.style.height=n.options.height,"isc"===n.useType?(n.clearIscTimeout_a(),n.iscTimeout_a=setTimeout(function(){n.playerHlsA(t)},1500)):n.playerHlsA(t)},error:function(e){404==+e&&(n.connect_attempts<n.options.maxReConnect?window.navigator.onLine&&(n.connect_attempts+=1,n.hlsClearTimeOut_a(),n.hlsTimeOut_a=setTimeout(function(){n.hlsPlay_a(t)},500)):"a"===n.currentShowVideoFlag?("function"==typeof n.onMaxReConnect&&n.onMaxReConnect(),n.statusChangeHandler(d,c),n.setError("m3u8/flv, aborting. Refresh page to try again")):(n.isChangeChannel&&(n.toast("切换超时，请重试"),n.isChangeChannel=!1,n.options.channel=Math.abs(n.options.channel-1),n.toggleChannelEle.innerHTML=0==+n.options.channel?"高清":"标清"),n.destroy_a()))}})}},{key:"requestFlvA",value:function(e){var r=this,t=this.gaiaKey,a=this.options.pushOnly;try{this.ajax({url:e,headers:{"x-gaia-api-key":t},success:function(e){if(!a){var t=JSON.parse(e),n=t.code;if(200==+n){if("hls"===r.options.mode)r.hlsPlay_a(t);else if(flvjs.isSupported()){var i="playReq"===r.options.command,e=r.useType,e="isc"!==e&&"gb28181"!==e;try{r.flvPlayer_a=flvjs.createPlayer({type:"flv",isLive:i,url:t.payload.flvUrl,hasAudio:e,enableWorker:!0,enableStashBuffer:!1,autoCleanupSourceBuffer:!0});try{r.flvPlayer_a.attachMediaElement(r.videoEle_a),r.flvPlayer_a.load(),r.flvPlayer_a.play()}catch(e){}}catch(e){r.errorHandler("a")}}}else 400==+n?r.statusChangeHandler(400):(n=r.options.isLargeScreen,t=t.message,n||"不能得到播流地址"===t?r.errorHandler("a"):r.statusChangeHandler(d,2e3,t))}},error:function(e){a||r.errorHandler("a")}})}catch(e){a||this.errorHandler("a")}}},{key:"useFlv_a",value:function(){var e=this.baseUrl,t=this.isHuiyan("monitor"),n=this.isHuiyan("frontapi/frontapi/camera");this.isPlayHandler=!1,t="playReq"===this.options.command?"".concat(e,"/").concat(n,"/getPlayUrl?serial=").concat(this.options.channel,"&id=").concat(this.options.cameraId):"".concat(e,"/").concat(t,"/getBackPlayUrl?serial=").concat(this.options.channel,"&cid=").concat(this.options.cameraId,"&startTime=").concat(this.options.startTime,"&endTime=").concat(this.options.endTime),this.requestFlvA(t)}},{key:"handleIncomingError_a",value:function(e){this.setError("ERROR: "+e),this.resetState_a()}},{key:"onRemoteTrack_a",value:function(e){this.videoEle_a.srcObject!==e.streams[0]&&(this.videoEle_a.srcObject=null,this.videoEle_a.srcObject=e.streams[0])}},{key:"getStatus",value:function(){var r=this,a=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=this.peer_connection_a,t=this.peer_connection_b,n=null,o={dpi:"",fps:"",kbps:"",encode:""};(n=e||t)&&n.getStats().then(function(e){var i=r.isMobile;e.forEach(function(e){var t,n=e.type;"inbound-rtp"!==n||i?"track"===n&&i?(t={dpi:e.frameWidth?"".concat(e.frameWidth," * ").concat(e.frameHeight):""},Object.assign(o,t)):"codec"===n?(t={encode:r.options.encoding},Object.assign(o,t)):"transport"===n&&(a?(r.currentReport=e,n=r.baselineReport,n={kbps:((e.bytesReceived-n.bytesReceived)/(e.timestamp-n.timestamp)/1e3*8).toFixed(2)+"Mbps"},Object.assign(o,n)):r.baselineReport=e):(e={fps:e.framesPerSecond||"",dpi:e.frameWidth?"".concat(e.frameWidth," * ").concat(e.frameHeight):""},Object.assign(o,e))}),r.createCodeStreamDom(o)}),this.webrtcStatisticsInterval=setTimeout(function(){r.getStatus(!0)},1e3)}},{key:"createCall_a",value:function(e){var t=this;this.peer_connection_a=new i({iceServers:this.iceServers}),this.peer_connection_a.ontrack=function(e){t.onRemoteTrack_a(e)},e.sdp,this.peer_connection_a.onicecandidate=function(e){null!=e.candidate&&t.ws_conn_a.send(JSON.stringify({ice:e.candidate}))},this.setStatus("Created peer connection for call, waiting for SDP")}},{key:"onIncomingSDP_a",value:function(e){var t=this;this.peer_connection_a.setRemoteDescription(e).then(function(){t.setStatus("Remote SDP set"),"offer"==e.type&&(t.setStatus("Got SDP offer"),t.setStatus("Got local stream, creating answer"),t.peer_connection_a.createAnswer().then(function(e){t.onLocalDescription_a(e)}).catch(t.setError))}).catch(this.setError)}},{key:"onIncomingICE_a",value:function(e){var t,e=new RTCIceCandidate(e);e&&e.type&&(this.peer_connection_a.addIceCandidate(e).catch(this.setError),this.candidateType_a.push(e.type));try{this.peer_connection_a.getSenders&&this.peer_connection_a.getSenders()&&this.peer_connection_a.getSenders()[0]&&this.peer_connection_a.getSenders()[0].transport&&this.peer_connection_a.getSenders()[0].transport.iceTransport&&((t=this.peer_connection_a.getSenders()[0].transport.iceTransport).onselectedcandidatepairchange=function(e){t.getSelectedCandidatePair&&t.getSelectedCandidatePair()})}catch(e){}}},{key:"clearServerConnectTimeOut_a",value:function(){var e=this.serverConnectTimeOut_a;e&&(clearTimeout(e),this.serverConnectTimeOut_a=null)}},{key:"clearServerConnectTimeOut_b",value:function(){var e=this.serverConnectTimeOut_b;e&&(clearTimeout(e),this.serverConnectTimeOut_b=null)}},{key:"onServerError_a",value:function(e){var t,n=this,i=this.getVideoTrackInfo();window.webrtcPlayerIO&&window.webrtcPlayerIO.track&&(t=this.getTrackMain(),window.webrtcPlayerIO.track("".concat(t,"播放失败"),_objectSpread(_objectSpread({},i),{},{timeStamp:(new Date).getTime()}))),this.setError("Unable to connect to server, did you add an exception for the certificate?"),this.clearServerConnectTimeOut_a(),this.serverConnectTimeOut_a=setTimeout(function(){n.websocketServerConnect_a()},3e3)}},{key:"onServerMessage_a",value:function(t){var e=(new Date).getTime()-this.webrtcStartTime;if(void 0,void 0,"HELLO"!==t.data)if(t.data.startsWith("ERROR"))this.handleIncomingError_a(t.data);else try{var n,i=JSON.parse(t.data);null!=i.sdp?(this.peer_connection_a||this.createCall_a(i),this.onIncomingSDP_a(i.sdp)):null!=i.ice?this.onIncomingICE_a(i.ice):null!=i.msgId?"playRsp"===(n=i.command)||"playBackRsp"===n?i.success?(i.streamChannel,this.setStatus("Registering with server")):(void 0,void 0,this.statusChangeHandler(d,s,JSON.parse(i.result).result)):void 0:this.handleIncomingError_a("Unknown incoming JSON: "+i)}catch(e){return void(e instanceof SyntaxError?this.handleIncomingError_a("Error parsing incoming JSON: "+t.data):this.handleIncomingError_a("Unknown error parsing response: "+t.data))}else this.setStatus("Registered with server, waiting for call")}},{key:"clearServerClose_a",value:function(){var e=this.onServerCloseTimeOut_a;e&&(clearTimeout(e),this.onServerCloseTimeOut_a=null)}},{key:"clearServerClose_b",value:function(){var e=this.onServerCloseTimeOut_b;e&&(clearTimeout(e),this.onServerCloseTimeOut_b=null)}},{key:"onServerClose_a",value:function(e){var t=this;"a"===this.currentShowVideoFlag&&(this.playStartTime=0,this.destroyMediaRecorder(),this.isPlaying=!1),this.setStatus("Disconnected from server"),4e3!==e.code&&(this.peer_connection_a&&(this.peer_connection_a.close(),this.peer_connection_a=null),this.ws_conn_a&&(this.ws_conn_a.close(this.manualCloseSocketCode),this.ws_conn_a=null),this.container&&window.navigator.onLine&&(e&&"pair close"!==e.reason?(this.clearServerClose_a(),this.onServerCloseTimeOut_a=setTimeout(function(){t.websocketServerConnect_a()},1e3)):"function"==typeof this.onPlayEnd&&"a"===this.currentShowVideoFlag&&this.onPlayEnd()))}},{key:"onLocalDescription_a",value:function(e){var t=this;this.peer_connection_a.setLocalDescription(e).then(function(){t.setStatus("Sending SDP answer"),t.ws_conn_a.send(JSON.stringify({sdp:t.peer_connection_a.localDescription}))})}},{key:"sendMsg_a",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.isPlaying&&(this.resetVideo_a(),this.peer_connection_a&&(this.peer_connection_a.close(),this.peer_connection_a=null));var t={msgId:this.randomNumber(),version:parseFloat("1.0"),src:"player",command:e.command,encoding:e.encoding,channel:e.channel,ipc:"".concat(e.cameraId),duration:0};"playBackReq"===t.command&&(t.startTime=e.startTime,t.endTime=e.endTime),void 0,this.ws_conn_a&&1===this.ws_conn_a.readyState&&("a"===this.currentShowVideoFlag&&(this.startTime=(new Date).getTime()),this.ws_conn_a.send(JSON.stringify(t)))}},{key:"resetVideo_a",value:function(){this.videoEle_a&&(this.pause_a(),this.videoEle_a.src="",this.videoEle_a.load())}},{key:"resetState_a",value:function(){this.ws_conn_a&&this.ws_conn_a.close()}},{key:"togglePlay_a",value:function(){this.playEle.classList.contains("webrtc-stop")?this.play_a():this.pause_a()}},{key:"play_a",value:function(){this.playEle&&(this.playEle.classList.add("webrtc-stop"),this.playEle.classList.remove("webrtc-play"))}},{key:"pause_a",value:function(){this.playEle&&(this.playEle.classList.add("webrtc-play"),this.playEle.classList.remove("webrtc-stop")),this.videoEle_a&&"a"===this.currentShowVideoFlag&&(this.stopRecord(),this.toggleRecodEle.classList.contains("disabled")||this.toggleRecodEle.classList.add("disabled"),this.isPlaying=!1,this.videoEle_a.pause())}},{key:"toggleStart_a",value:function(){this.terminalEle.classList.contains("webrtc-terminal")?this.terminal_a():this.restart_a()}},{key:"playEndInfo",value:function(){var e=this.formatTime(this.webrtcStartTime),t=this.formatTime(+new Date),n=this.watermarkInfo.projectName,i=this.watermarkInfo.pointName,r=this.options,a=this.isMobile?"1":"0";return{module:r.module,metadata:{startTime:e,endTime:t,projectName:n,pointName:i,cid:r.cameraId,userName:r.watermark,clientType:a,projectId:r.projectId}}}},{key:"terminal_a",value:function(){this.codeStream("hide"),this.volumeHide(),this.isPause=!0;var e,t,n,i=this.getVideoTrackInfo(),r=this.playEndInfo();window.webrtcPlayerIO&&window.webrtcPlayerIO.track&&(n=this.options.moduleText,e="".concat(n?n+"_":""),t=this.formatTime(+new Date),n=this.getTrackMain(),window.webrtcPlayerIO.track("".concat(n).concat(e,"停止播放"),_objectSpread(_objectSpread(_objectSpread({},i),r),{},{timeStamp:t}))),this.statusChangeHandler(1008),this.clearTimeLooper(),this.rangeTimeOfPlayed=this.rangeTimeOfPlayed+((new Date).getTime()-this.playInitTime),this.playInitTime=0,this.pause_a(),this.disconnect(),this.stopRecord()}},{key:"restart_a",value:function(){this.config(this.options,!0)}},{key:"destroy_a",value:function(){if(this.resetTimeOut(),this.resetVideo_a(),this.videoEle_a&&(this.videoEle_a.parentNode===this.videoContainer&&this.videoContainer.removeChild(this.videoEle_a),this.videoEle_a=null),this.hlsplayer_a)this.hlsplayer_a.dispose(),this.hlsplayer_a=null,"a"===this.currentShowVideoFlag&&clearInterval(this.intervaler_a);else if(this.flvPlayer_a){try{this.flvPlayer_a.pause(),this.flvPlayer_a.unload(),this.flvPlayer_a.detachMediaElement(),this.flvPlayer_a.destroy()}catch(e){}this.flvPlayer_a=null}this.peer_connection_a&&(this.peer_connection_a.close(),this.peer_connection_a=null),this.ws_conn_a&&(this.ws_conn_a.close(this.manualCloseSocketCode),this.ws_conn_a=null)}},{key:"initPlay_b",value:function(){var i=this;this.openWebSocket("b"),this.getCameraStatus(this.options.cameraId).then(function(e){var t=i.webrtcStartTime,n=(new Date).getTime(),n=Math.abs((n-t)/1e3);void 0;t=JSON.parse(e);200===parseInt(t.code)&&t.data?(i.setTitle(t),n=t.data.ptzService,t.data.webRtcSignalServer?(i.options.wsServer=t.data.webRtcSignalServer,i.options.wsServerProtocol="wss"===t.data.webRtcSignalServer.split(":")[0]?"https":"http",i.options.wsServer.split("//")[1]?(n&&0!==parseInt(n)||(i.options.ptzAbility=!1),n&&"0"!==n&&i.zoomInEle.classList.contains("hide")&&(i.zoomInEle.classList.remove("hide"),i.zoomOutEle.classList.remove("hide")),i.options.gatewayName=t.data.gatewayName,i.options.gatewayId=t.data.gatewayId,i.options.deviceName=t.data.deviceName,i.options.deviceId=t.data.deviceId,e=t.data.useType,n=i.options.isCheckPlayMtd,e=i.options.isLargeScreen?i.options.testPlayMtd:o&&"isc"!==e?"webRtc":e,i.toggleChannelEleDisabled(e),i.useType=e,n||(i.options.mode="webRtc"===e?"webrtc":"isc"===e?"hls":"flv"),"webrtc"===i.options.mode?(i.codeStreamEle.classList.contains("hide")&&i.codeStreamEle.classList.remove("hide"),i.webrtcWebsocket("b")):i.websocketServerConnect_b()):i.statusChangeHandler(d,s)):i.statusChangeHandler(d,s)):(t=t.msg,i.statusChangeHandler(d,s,t))}).catch(function(e){i.statusChangeHandler(d,2e3,"获取设备状态失败")})}},{key:"canplaythroughHandler_b",value:function(){var e;this.codeStream("isShow"),this.flvCanplay=!0,this.videoEle_b&&(this.openAudio(),this.statusChangeHandler(l),this.isPlaying=!0,this.playStartTime=(new Date).getTime(),this.statisticsEndTime=new Date,e=this.statisticsStartTime,e=this.statisticsEndTime.getTime()-e.getTime(),void 0,this.play_b(),this.toggleChannelEle&&(this.toggleChannelEle.innerHTML=0==+this.options.channel?"高清":"标清"))}},{key:"changeCodeStream_b",value:function(){this.destroy_a(),this.isChangeChannel?(this.videoContainer.appendChild(this.videoEle_b),this.toggleChannelEle.innerHTML=0==+this.options.channel?"高清":"标清",this.toast("已切换至".concat(this.toggleChannelEle.innerHTML),500),this.isPlaying=!0,this.isChangeChannel=!1):this.videoContainer.appendChild(this.videoEle_b),this.currentShowVideoFlag="b",this.toggleRecodEle.classList.contains("disabled")&&this.toggleRecodEle.classList.remove("disabled"),this.createSecondVideoFlag=!1}},{key:"playHandler_b",value:function(){var e,t,n=this,i=this.options.isLargeScreen;this.isPlayHandler=!0,this.flvCanplay=!1,this.clearFlvCanplayInterval(),this.clearFlvCanplayTimeout(),this.openAudio(),this.videoEle_b&&(this.connect_attempts=0,this.clearVideoStreamTimer_b(),this.createSecondVideoFlag?"flv"===(t=this.options.mode)||"hls"===t?(this.flvCanplaySetInterval=setInterval(function(){n.flvCanplay&&(n.changeCodeStream_b(),n.clearFlvCanplayTimeout(),clearInterval(n.flvCanplaySetInterval),n.flvCanplaySetInterval=null)},100),this.flvCanplayFn()):this.changeCodeStream_b():(e=this.getVideoTrackInfo(),window.webrtcPlayerIO&&window.webrtcPlayerIO.track&&(t=this.getTrackMain(),window.webrtcPlayerIO.track("".concat(t,"播放成功"),_objectSpread(_objectSpread({},e),{},{timeStamp:(new Date).getTime()}))),this.ptzControlEle(),0===this.playInitTime&&(this.playInitTime=(new Date).getTime()),this.status!==d&&(i||(this.clearTimeLooper(),this.timeLooper=setInterval(function(){n.timeEle.innerText=n.time_dis(n.playInitTime)},1e3)),0!==this.options.duration&&"playReq"===this.options.command&&this.continueStream()),this.videoContainer.appendChild(this.videoEle_b)),this.delayStop())}},{key:"endHandler_b",value:function(){"b"===this.currentShowVideoFlag&&"function"==typeof this.onPlayEnd&&this.onPlayEnd()}},{key:"createVideo_b",value:function(){var n=this,e=o?"mobile":"pc",t=document.createElement("div");t.innerHTML='<video class="'.concat(e," ").concat("contain"===this.options.videoLayoutType?"webrtc-video":"webrtc-video-fill",'" id="video_b" crossorigin="anonymous" src="" webkit-playsinline playsinline autoplay muted>Your browser doesn\'t support video</video>'),this.videoEle_b=t.childNodes[0],this.videoEle_b.addEventListener("canplay",function(e){"webrtc"===n.options.mode&&(n.isPlayHandler||n.playHandler_b()),n.canplaythroughHandler_b()}),this.videoEle_b.addEventListener("play",function(){"webrtc"===n.options.mode&&n.isPlayHandler||n.playHandler_b()}),this.videoEle_b.addEventListener("ended",function(e){n.endHandler_b()}),this.videoEle_b.addEventListener("timeupdate",function(e){var t=n.videoEle_b;t&&(t=t.currentTime,n.currentTime=t)}),this.videoEle_b.addEventListener("error",function(e){})}},{key:"clearTimeLooper",value:function(){var e=this.timeLooper;e&&(window.clearInterval(e),this.timeLooper=null)}},{key:"websocketServerConnect_b",value:function(){var n=this;if(this.clearVideoStreamTimer_b(),this.videoStreamTimer_b=setTimeout(function(){var e,t;n.createSecondVideoFlag?(n.videoEle_a&&(n.isChangeChannel&&(n.isChangeChannel=!1,n.options.channel=Math.abs(n.options.channel-1),n.toggleChannelEle.innerHTML=0==+n.options.channel?"高清":"标清",n.toast("切换超时，请重试"),t=n.getVideoTrackInfo(),window.webrtcPlayerIO&&window.webrtcPlayerIO.track&&(e=n.getTrackMain(),window.webrtcPlayerIO.track("".concat(e,"切换失败"),_objectSpread(_objectSpread({},t),{},{timeStamp:(new Date).getTime()})))),n.destroy_b()),n.createSecondVideoFlag=!1):n.status!==l&&n.status!==d&&(n.destroy_b(),n.playInitTime=0,n.rangeTimeOfPlayed=0,n.timeEle.innerText="00:00:00",n.clearTimeLooper(),e=n.getVideoTrackInfo(),window.webrtcPlayerIO&&window.webrtcPlayerIO.track&&(t=n.getTrackMain(),window.webrtcPlayerIO.track("".concat(t,"播放失败"),_objectSpread(_objectSpread({},e),{},{timeStamp:(new Date).getTime()}))),n.statusChangeHandler(d,c))},1e3*this.options.videoOverTime),this.options.mode&&"webrtc"!==this.options.mode||!window.WebSocket||!i)this.startTime=(new Date).getTime(),this.useFlv_b();else{if(this.connect_attempts++,"b"===this.currentShowVideoFlag&&this.status!==d&&this.statusChangeHandler(h),this.connect_attempts>this.options.maxReConnect)return"b"===this.currentShowVideoFlag?("function"==typeof this.onMaxReConnect&&this.onMaxReConnect(),this.clearTimeLooper(),this.status!==d&&this.statusChangeHandler(d,c),this.setError("Too many connection attempts, aborting. Refresh page to try again")):this.isChangeChannel&&(this.toast("切换超时，请重试"),this.isChangeChannel=!1,this.options.channel=Math.abs(this.options.channel-1),this.toggleChannelEle.innerHTML=0==+this.options.channel?"高清":"标清"),void this.destroy_b();if(sessionStorage.getItem("webrtcUrl")&&this.isOpenWebSocket)this.isOpenWebSocket?this.sendMsg_b(this.options):(this.clearSendMsgInterval(),this.sendMsgInterval=setInterval(function(){n.isOpenWebSocket&&(clearInterval(n.sendMsgInterval),n.sendMsgInterval=null,n.sendMsg_b(n.options))},10));else{if(window.location.protocol.startsWith("file"))e=this.options.wsServer||"127.0.0.1";else{if(!window.location.protocol.startsWith("http"))throw new Error("Don't know how to connect to the signalling server with uri"+window.location);e=this.options.wsServer||window.location.hostname}var e=e;this.setStatus("Connecting to server "+e),this.ws_conn_b=new WebSocket(e),this.ws_conn_b.addEventListener("open",function(e){void 0,n.sendMsg_b(n.options)})}try{this.ws_conn_b.addEventListener("error",function(){n.onServerError_b()}),this.ws_conn_b.addEventListener("message",function(e){n.onServerMessage_b(e)}),this.ws_conn_b.addEventListener("close",function(e){void 0,n.onServerClose_b(e)})}catch(e){void 0}}}},{key:"hlsClearTimeOut_b",value:function(){var e=this.hlsTimeOut_b;e&&(clearTimeout(e),this.hlsTimeOut_b=null)}},{key:"hlsClearTimeOut_a",value:function(){var e=this.hlsTimeOut_a;e&&(clearTimeout(e),this.hlsTimeOut_a=null)}},{key:"playerHlsB",value:function(e){var t=this.muted,n=this;this.hlsplayer_b=videojs(this.videoEle_b,{html5:{hls:{overrideNative:!1},nativeVideoTracks:!0,nativeAtudioTracks:!0,nativeTextTracks:!0},poster:"",muted:t,controls:!1,sources:[{src:e.payload.hlsUrl,type:"application/x-mpegURL"}]},function(){this.on("canplay",function(){n.hlsErrorAttempt=0,n.canplaythroughHandler_b()}),this.on("play",function(){n.playHandler_b()}),this.on("ended",function(){n.endHandler_b()}),this.on("timeupdate",function(){try{var e=this.currentTime;n.currentTime=e}catch(e){}}),this.on("error",function(){})})}},{key:"hlsPlay_b",value:function(t){var n=this;this.ajax({url:t.payload.hlsUrl,success:function(e){n.videoContainer.appendChild(n.videoEle_b),n.videoEle_b.style.width=n.options.width,n.videoEle_b.style.height=n.options.height,"isc"===n.useType?(n.clearIscTimeout_b(),n.iscTimeout_b=setTimeout(function(){n.playerHlsB(t)},1500)):n.playerHlsB(t)},error:function(e){404==+e&&(n.connect_attempts<n.options.maxReConnect?window.navigator.onLine&&(n.connect_attempts+=1,n.hlsClearTimeOut_b(),n.hlsTimeOut_b=setTimeout(function(){n.hlsPlay_b(t)},500)):("b"===n.currentShowVideoFlag?("function"==typeof n.onMaxReConnect&&n.onMaxReConnect(),n.statusChangeHandler(d,c),n.setError("m3u8/flv, aborting. Refresh page to try again")):n.isChangeChannel&&(n.toast("切换超时，请重试"),n.isChangeChannel=!1,n.options.channel=Math.abs(n.options.channel-1),n.toggleChannelEle.innerHTML=0==+n.options.channel?"高清":"标清"),n.destroy_b()))}})}},{key:"requestFlvB",value:function(e){var a=this,t=this.gaiaKey;try{this.ajax({url:e,headers:{"x-gaia-api-key":t},success:function(e){var t=JSON.parse(e),e=t.code;if(200==+e){if("hls"===a.options.mode)a.hlsPlay_b(t);else if(flvjs.isSupported())try{var n="playReq"===a.options.command,i=a.useType,r="isc"!==i&&"gb28181"!==i;a.flvPlayer_b=flvjs.createPlayer({type:"flv",isLive:n,url:t.payload.flvUrl,hasAudio:r,enableWorker:!0,enableStashBuffer:!1,autoCleanupSourceBuffer:!0});try{a.flvPlayer_b.attachMediaElement(a.videoEle_b),a.flvPlayer_b.load(),a.flvPlayer_b.play()}catch(e){}}catch(e){a.errorHandler("b")}}else 400==+e?a.statusChangeHandler(400):(e=a.options.isLargeScreen,t=t.message,e||"不能得到播流地址"===t?a.errorHandler("b"):a.statusChangeHandler(d,2e3,t))},error:function(e){a.errorHandler("b")}})}catch(e){this.errorHandler("b")}}},{key:"useFlv_b",value:function(){var e=this.baseUrl;this.isPlayHandler=!1,e="playReq"===this.options.command?"".concat(e,"/api/getPlayUrl?serial=").concat(this.options.channel,"&id=").concat(this.options.cameraId):"".concat(e,"/api/getBackPlayUrl?serial=").concat(this.options.channel,"&cid=").concat(this.options.cameraId,"&startTime=").concat(this.options.startTime,"&endTime=").concat(this.options.endTime),this.requestFlvB(e)}},{key:"handleIncomingError_b",value:function(e){this.setError("ERROR: "+e),this.resetState_b()}},{key:"onRemoteTrack_b",value:function(e){this.videoEle_b.srcObject!==e.streams[0]&&(this.videoEle_b.srcObject=null,this.videoEle_b.srcObject=e.streams[0])}},{key:"createCall_b",value:function(e){var t=this;this.peer_connection_b=new i({iceServers:this.iceServers}),this.peer_connection_b.ontrack=function(e){t.onRemoteTrack_b(e)},e.sdp,this.peer_connection_b.onicecandidate=function(e){null!=e.candidate&&t.ws_conn_b&&1===t.ws_conn_b.readyState&&t.ws_conn_b.send(JSON.stringify({ice:e.candidate}))},this.setStatus("Created peer connection for call, waiting for SDP")}},{key:"onIncomingSDP_b",value:function(e){var t=this;this.peer_connection_b.setRemoteDescription(e).then(function(){t.setStatus("Remote SDP set"),"offer"==e.type&&(t.setStatus("Got SDP offer"),t.setStatus("Got local stream, creating answer"),t.peer_connection_b.createAnswer().then(function(e){t.onLocalDescription_b(e)}).catch(t.setError))}).catch(this.setError)}},{key:"onIncomingICE_b",value:function(e){var t,e=new RTCIceCandidate(e);e&&e.type&&(this.peer_connection_b.addIceCandidate(e).catch(this.setError),this.candidateType_b.push(e.type));try{this.peer_connection_b.getSenders&&this.peer_connection_b.getSenders()&&this.peer_connection_b.getSenders()[0]&&this.peer_connection_b.getSenders()[0].transport&&this.peer_connection_b.getSenders()[0].transport.iceTransport&&((t=this.peer_connection_b.getSenders()[0].transport.iceTransport).onselectedcandidatepairchange=function(e){t.getSelectedCandidatePair&&t.getSelectedCandidatePair()})}catch(e){}}},{key:"onServerError_b",value:function(e){var t,n=this,i=this.getVideoTrackInfo();window.webrtcPlayerIO&&window.webrtcPlayerIO.track&&(t=this.getTrackMain(),window.webrtcPlayerIO.track("".concat(t,"播放失败"),_objectSpread(_objectSpread({},i),{},{timeStamp:(new Date).getTime()}))),this.setError("Unable to connect to server, did you add an exception for the certificate?"),this.clearServerConnectTimeOut_b(),this.serverConnectTimeOut_b=setTimeout(function(){n.websocketServerConnect_b()},3e3)}},{key:"onServerMessage_b",value:function(t){var e=(new Date).getTime()-this.webrtcStartTime;if(void 0,void 0,"HELLO"!==t.data)if(t.data.startsWith("ERROR"))this.handleIncomingError_b(t.data);else try{var n,i,r=JSON.parse(t.data);null!=r.sdp?(this.peer_connection_b||this.createCall_b(r),this.onIncomingSDP_b(r.sdp)):null!=r.ice?this.onIncomingICE_b(r.ice):null!=r.msgId?"playRsp"!==(n=r.command)&&"playBackRsp"!==n||(r.success?(i=r.streamChannel,void 0,this.setStatus("Registering with server")):(void 0,void 0,this.statusChangeHandler(d,s,JSON.parse(r.result).result))):this.handleIncomingError_b("Unknown incoming JSON: "+r)}catch(e){return void(e instanceof SyntaxError?this.handleIncomingError_b("Error parsing incoming JSON: "+t.data):this.handleIncomingError_b("Unknown error parsing response: "+t.data))}else this.setStatus("Registered with server, waiting for call")}},{key:"onServerClose_b",value:function(e){var t=this;"b"===this.currentShowVideoFlag&&(this.playStartTime=0,this.destroyMediaRecorder(),this.isPlaying=!1),this.setStatus("Disconnected from server"),4e3!==e.code&&(this.peer_connection_b&&(this.peer_connection_b.close(),this.peer_connection_b=null),this.ws_conn_b&&(this.ws_conn_b.close(this.manualCloseSocketCode),this.ws_conn_b=null),this.container&&window.navigator.onLine&&(e&&"pair close"!==e.reason?(this.clearServerClose_b(),this.onServerCloseTimeOut_b=setTimeout(function(){t.websocketServerConnect_b()},1e3)):"function"==typeof this.onPlayEnd&&"b"===this.currentShowVideoFlag&&this.onPlayEnd()))}},{key:"onLocalDescription_b",value:function(e){var t=this;this.peer_connection_b.setLocalDescription(e).then(function(){t.setStatus("Sending SDP answer"),t.ws_conn_b.send(JSON.stringify({sdp:t.peer_connection_b.localDescription}))})}},{key:"sendMsg_b",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.isPlaying&&(this.resetVideo_b(),this.peer_connection_b&&(this.peer_connection_b.close(),this.peer_connection_b=null));var t={msgId:this.randomNumber(),version:parseFloat("1.0"),src:"player",command:e.command,encoding:e.encoding,channel:e.channel,ipc:"".concat(e.cameraId),duration:0};"playBackReq"===t.command&&(t.startTime=e.startTime,t.endTime=e.endTime),void 0,this.ws_conn_b&&1===this.ws_conn_b.readyState&&("b"===this.currentShowVideoFlag&&(this.startTime=(new Date).getTime()),this.ws_conn_b.send(JSON.stringify(t)))}},{key:"resetVideo_b",value:function(){this.videoEle_b&&(this.pause_b(),this.videoEle_b.src="",this.videoEle_b.load())}},{key:"resetState_b",value:function(){this.ws_conn_b&&this.ws_conn_b.close()}},{key:"togglePlay_b",value:function(){this.playEle.classList.contains("webrtc-stop")?this.play_b():this.pause_b()}},{key:"play_b",value:function(){this.playEle&&(this.playEle.classList.add("webrtc-stop"),this.playEle.classList.remove("webrtc-play"))}},{key:"pause_b",value:function(){this.playEle&&(this.playEle.classList.add("webrtc-play"),this.playEle.classList.remove("webrtc-stop")),this.videoEle_b&&"b"===this.currentShowVideoFlag&&(this.stopRecord(),this.toggleRecodEle.classList.contains("disabled")||this.toggleRecodEle.classList.add("disabled"),this.isPlaying=!1,this.videoEle_b.pause())}},{key:"toggleStart_b",value:function(){this.terminalEle.classList.contains("webrtc-terminal")?this.terminal_b():this.restart_b()}},{key:"terminal_b",value:function(){this.codeStream("hide"),this.isPause=!0;var e,t,n,i=this.getVideoTrackInfo(),r=this.playEndInfo();window.webrtcPlayerIO&&window.webrtcPlayerIO.track&&(n=this.options.moduleText,e="".concat(n?n+"_":""),t=this.formatTime(+new Date),n=this.getTrackMain(),window.webrtcPlayerIO.track("".concat(n).concat(e,"停止播放"),_objectSpread(_objectSpread(_objectSpread({},i),r),{},{timeStamp:t}))),this.statusChangeHandler(1008),this.clearTimeLooper(),this.rangeTimeOfPlayed=this.rangeTimeOfPlayed+((new Date).getTime()-this.playInitTime),this.playInitTime=0,this.pause_b(),this.disconnect(),this.stopRecord()}},{key:"restart_b",value:function(){this.config(this.options,!0)}},{key:"destroy_b",value:function(){if(this.resetTimeOut(),this.resetVideo_b(),this.videoEle_b&&(this.videoEle_b.parentNode===this.videoContainer&&this.videoContainer.removeChild(this.videoEle_b),this.videoEle_b=null),this.hlsplayer_b)this.hlsplayer_b.dispose(),this.hlsplayer_b=null,"b"===this.currentShowVideoFlag&&clearInterval(this.intervaler_b);else if(this.flvPlayer_b){try{this.flvPlayer_b.pause(),this.flvPlayer_b.unload(),this.flvPlayer_b.detachMediaElement(),this.flvPlayer_b.destroy()}catch(e){}this.flvPlayer_b=null}this.peer_connection_b&&(this.peer_connection_b.close(),this.peer_connection_b=null),this.ws_conn_b&&(this.ws_conn_b.close(this.manualCloseSocketCode),this.ws_conn_b=null)}},{key:"clearFullscreenTimeout",value:function(){var e=this.fullscreenTimeout;e&&(clearTimeout(e),this.fullscreenTimeout=null)}},{key:"iosRotateScreen",value:function(e){"function"==typeof this.rotateScreen&&this.rotateScreen(e)}},{key:"ptzControlEle",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"in",t=this.options,n=t.ptzAbility,t=t.fullscreen;n&&t?("in"===e&&this.ptzContainer.classList.contains("hide")&&this.ptzContainer.classList.remove("hide"),"out"!==e||this.ptzContainer.classList.contains("hide")||this.ptzContainer.classList.add("hide")):this.ptzContainer.classList.contains("hide")||this.ptzContainer.classList.add("hide")}},{key:"fullscreen",value:function(){var e,t=this,n=this.options.isLargeScreen,i=this.getVideoTrackInfo();window.webrtcPlayerIO&&window.webrtcPlayerIO.track&&(e=this.getTrackMain(),window.webrtcPlayerIO.track("".concat(e,"进入全屏"),_objectSpread(_objectSpread({},i),{},{timeStamp:(new Date).getTime()})));i=this.videoContainer;n?i&&(this.fullscreenEle.classList.contains("webrtc-fullscreen")&&(this.fullscreenEle.classList.remove("webrtc-fullscreen"),this.fullscreenEle.classList.add("webrtc-fullscreen-exit")),this.controlContainer.classList.contains("webrtc-control-fullscreen")||this.controlContainer.classList.add("webrtc-control-fullscreen"),"function"==typeof this.onFullscreen&&this.onFullscreen(),this.options.fullscreen=!0,document.body.style.overflow="hidden"):i&&(this.options.isUseFullscreen&&(i.requestFullscreen?i.requestFullscreen():i.mozRequestFullScreen?i.mozRequestFullScreen():i.webkitRequestFullscreen?i.webkitRequestFullscreen():i.msRequestFullscreen&&i.msRequestFullscreen()),this.fullscreenEle.classList.contains("webrtc-fullscreen")&&(this.fullscreenEle.classList.remove("webrtc-fullscreen"),this.fullscreenEle.classList.add("webrtc-fullscreen-exit"),this.videoContainer.classList.add("webrtc-fullscreen-container")),this.options.fullscreen=!0,document.body.style.overflow="hidden",this.clearFullscreenTimeout(),this.fullscreenTimeout=setTimeout(function(){t.controlContainer.style.bottom="-100%"},5e3),this.fullscreenMove=function(){t.fullscreenEle.classList.contains("webrtc-fullscreen-exit")&&(t.controlContainer.style.bottom="",t.clearFullscreenTimeout(),t.fullscreenTimeout=setTimeout(function(){t.controlContainer.style.bottom="-100%"},5e3))},this.videoContainer.addEventListener("mousemove",this.fullscreenMove,!1),this.videoContainer.addEventListener("touchstart",this.fullscreenMove,!1),"function"==typeof this.options.fullscreenCallback&&this.options.fullscreenCallback("enter"),this.iosRotateScreen(8)),this.isPlaying&&this.ptzControlEle()}},{key:"fullscreenExit",value:function(){var e,t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],n=this.options.isLargeScreen,i=this.getVideoTrackInfo();window.webrtcPlayerIO&&window.webrtcPlayerIO.track&&(e=this.getTrackMain(),window.webrtcPlayerIO.track("".concat(e,"退出全屏"),_objectSpread(_objectSpread({},i),{},{timeStamp:(new Date).getTime()}))),n?(this.fullscreenEle.classList.contains("webrtc-fullscreen-exit")&&(this.fullscreenEle.classList.add("webrtc-fullscreen"),this.fullscreenEle.classList.remove("webrtc-fullscreen-exit")),this.controlContainer.classList.contains("webrtc-control-fullscreen")&&this.controlContainer.classList.remove("webrtc-control-fullscreen"),"function"==typeof this.onFullscreenExit&&this.onFullscreenExit(),this.options.fullscreen=!1,document.body.style.overflow=""):(this.options.isUseFullscreen&&t&&(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.oRequestFullscreen?document.oCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()),this.fullscreenEle.classList.contains("webrtc-fullscreen-exit")&&(this.fullscreenEle.classList.add("webrtc-fullscreen"),this.fullscreenEle.classList.remove("webrtc-fullscreen-exit"),this.videoContainer.classList.remove("webrtc-fullscreen-container")),this.options.fullscreen=!1,document.body.style.overflow="",this.controlContainer.style.bottom="",this.clearFullscreenTimeout(),this.videoContainer.removeEventListener("mousemove",this.fullscreenMove,!1),"function"==typeof this.options.fullscreenCallback&&this.options.fullscreenCallback("exit"),this.iosRotateScreen(1)),this.ptzControlEle("out")}},{key:"onVideoHoverLeave",value:function(e){1===e?this.controlContainer.classList.remove("hide"):this.controlContainer.classList.add("hide")}},{key:"isFullscreen",value:function(){return this.fullscreenEle.classList.contains("webrtc-fullscreen-exit")}},{key:"toggleFullscreen",value:function(){this.isFullscreen()||this.fullscreenEle.classList.contains("webrtc-fullscreen-exit")?this.fullscreenExit():this.fullscreen()}},{key:"clearScreenshotTimeOut",value:function(){var e=this.screenshotTimeOut;e&&(clearTimeout(e),this.screenshotTimeOut=null)}},{key:"codeStream",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"normal",t=this.codeStreamContainer;"normal"===e?t.classList.contains("hide")?(t.classList.remove("hide"),this.getStatus()):(t.classList.add("hide"),this.clearWebrtcStatisticsInvertal()):"hide"===e?t.classList.contains("hide")||(t.classList.add("hide"),this.clearWebrtcStatisticsInvertal()):t.classList.contains("hide")||this.getStatus()}},{key:"zoomInOut",value:function(e){var t,n,i,r=this;this.options.ptzAbility&&(t=this.getVideoTrackInfo(),window.webrtcPlayerIO&&window.webrtcPlayerIO.track&&(n="in"===e?"放大":"缩小",i=this.getTrackMain(),window.webrtcPlayerIO.track("".concat(i,"云台控制").concat(n),_objectSpread(_objectSpread({},t),{},{timeStamp:(new Date).getTime()}))),this.ptzHandler("in"===e?"zoomin":"zoomout").then(function(){r.toast("操作成功",1e3)}))}},{key:"screenshot",value:function(){var n=this,e=this.getVideoTrackInfo();if(window.webrtcPlayerIO&&window.webrtcPlayerIO.track&&(i=this.getTrackMain(),window.webrtcPlayerIO.track("".concat(i,"截图操作"),_objectSpread(_objectSpread({},e),{},{timeStamp:(new Date).getTime()}))),"backend"===this.options.screenshotType){var t=this.isHuiyan("frontapi/frontapi/camera");this.ajax({url:"https://openapi.longfor.com/iot-api-video-prod/v2/".concat(t,"/realTimeSnapshots?serial=0&id=").concat(this.options.cameraId),headers:{"x-gaia-api-key":"e30cc725-f75d-410d-9351-81b2f9419299"},success:function(e){var t;!e||200==+(e=JSON.parse(e)).code&&((t=document.createElement("a")).style.display="none",t.target="_blank",t.href=e.data.url,t.download=e.data.fileName,document.body.appendChild(t),t.click(),n.clearScreenshotTimeOut(),n.screenshotTimeOut=setTimeout(function(){document.body.removeChild(t)},0))}})}else{var i=null,i="a"===this.currentShowVideoFlag?this.videoEle_a:this.videoEle_b,e=window.canvas=document.createElement("canvas");e.width=i.videoWidth,e.height=i.videoHeight,e.getContext("2d").drawImage(i,0,0,e.width,e.height);for(var t=e.toDataURL("image/".concat("jpg")).split(","),i=t[0].match(/:(.*?);/)[1],r=atob(t[1]),a=r.length,o=new Uint8Array(a);a--;)o[a]=r.charCodeAt(a);i=new Blob([o],{type:i}),i=window.URL.createObjectURL(i);this.saveVideoPhoto(i,{isPictureSave:!0,name:"LfPlayer_screenshot_",fileType:"jpg",canvas:e,tip:"图片保存成功！"})}}},{key:"mobileScreenshot",value:function(){var e=null,e="a"===this.currentShowVideoFlag?this.videoEle_a:this.videoEle_b,t=window.canvas=document.createElement("canvas");t.width=480,t.height=270,t.getContext("2d").drawImage(e,0,0,e.videoWidth,e.videoHeight,0,0,480,270);for(var e=t.toDataURL("image/".concat("jpg")).split(","),t=e[0].match(/:(.*?);/)[1],n=atob(e[1]),i=n.length,r=new Uint8Array(i);i--;)r[i]=n.charCodeAt(i);e=new Blob([r],{type:t}),t=new FormData;t.append("file",e,"capture.png"),axios({url:this.baseUrl+"/api/camera/uploadPicToOss",method:"post",data:t,headers:{"Content-Type":"multipart/form-data","x-gaia-api-key":this.gaiaKey,accessChannel:this.options.accessChannel,Authorization:this.options.Authorization}}).then(function(e){e=e.data;200==+e.code&&window.createIfm("previewImage","imageList="+encodeURIComponent(JSON.stringify([e.data]))+"&watermark=1&imageIndex=0")})}},{key:"clearPreviewTimeOut",value:function(){var e=this.previewTimeOut;e&&(clearTimeout(e),this.previewTimeOut=null)}},{key:"clearRemoveImgTimeOut",value:function(){var e=this.removeImgTimeOut;e&&(clearTimeout(e),this.removeImgTimeOut=null)}},{key:"preview",value:function(e,t,n){var i=this,r=document.createElement("img");r.className="webrtc_preview-img",r.src=e,r.width=getComputedStyle(this.videoContainer).width.replace("px","")/5,this.videoContainer.appendChild(r),this.clearPreviewTimeOut(),this.previewTimeOut=setTimeout(function(){r.style.opacity=0,i.clearRemoveImgTimeOut(),i.removeImgTimeOut=setTimeout(function(e){i.videoContainer.removeChild(r)},300)},2e3)}},{key:"clearToastTimeout",value:function(){var e=this.toastTimeout;e&&(clearTimeout(e),this.toastTimeout=null)}},{key:"toast",value:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2e3;e&&(this.isPlayHandler=!1,this.toastEle||(this.toastEle=document.createElement("div"),this.toastEle.className="webrtc-toast-container",this.videoContainer.appendChild(this.toastEle)),this.toastEle.innerHTML=e,this.toastEle.style.opacity=1,n&&(this.clearToastTimeout(),this.toastTimeout=setTimeout(function(){t.toastEle.style.opacity=0},n)))}},{key:"randomNumber",value:function(){return Math.floor(9999*Math.random())+1e3}},{key:"setError",value:function(e){void 0}},{key:"setStatus",value:function(e){}},{key:"clearDurationTimer",value:function(){this.durationTimer&&(window.clearTimeout(this.durationTimer),this.durationTimer=null)}},{key:"disconnect",value:function(){this.destroy_a(),this.destroy_b(),this.ptzContainer.classList.contains("hide")||this.ptzContainer.classList.add("hide"),this.toastEle&&(this.toastEle.style.opacity=0),this.destroyMediaRecorder(),this.isPlaying=!1}},{key:"clearCycleTimeout",value:function(){var e=this.cycleTimeout;e&&(clearTimeout(e),this.cycleTimeout=null)}},{key:"clearFlvCanplayInterval",value:function(){var e=this.flvCanplaySetInterval;e&&(clearInterval(e),this.flvCanplaySetInterval=null)}},{key:"clearFlvCanplayTimeout",value:function(){var e=this.flvCanplaySetTimeout;e&&(clearInterval(e),this.flvCanplaySetTimeout=null)}},{key:"clearIscTimeout_a",value:function(){var e=this.iscTimeout_a;e&&(clearInterval(e),this.iscTimeout_a=null)}},{key:"clearIscTimeout_b",value:function(){var e=this.iscTimeout_b;e&&(clearInterval(e),this.iscTimeout_b=null)}},{key:"clearWebrtcStatisticsInvertal",value:function(){var e=this.webrtcStatisticsInterval;e&&(clearTimeout(e),this.webrtcStatisticsInterval=null)}},{key:"clearSendMsgInterval",value:function(){var e=this.sendMsgInterval;e&&(clearInterval(e),this.sendMsgInterval=null)}},{key:"resetTimeOut",value:function(){this.options.isLargeScreen&&this.clearTimeLooper(),this.clearSendMsgInterval(),this.clearWebrtcStatisticsInvertal(),this.clearIscTimeout_a(),this.clearIscTimeout_b(),this.clearFlvCanplayInterval(),this.clearFlvCanplayTimeout(),this.clearDelaySetInvertal(),this.clearStopSetIntertal(),this.clearDurationStreamTime(),this.clearDurationTimer(),this.clearMediaRecordTimer(),this.clearRemoveImgTimeOut(),this.clearPreviewTimeOut(),this.clearScreenshotTimeOut(),this.clearServerClose_a(),this.clearServerClose_b(),this.clearSaveVideoPhoto(),this.clearAbortTimeOut(),this.clearVideoStreamTimer_a(),this.clearVideoStreamTimer_b(),this.clearImgTimeout(),this.clearFullscreenTimeout(),this.clearServerConnectTimeOut_a(),this.clearServerConnectTimeOut_b(),this.hlsClearTimeOut_b(),this.hlsClearTimeOut_a(),this.clearCycleTimeout()}},{key:"destroy",value:function(){this.clearTimeLooper(),this.isDestroy=!0,this.isPlayHandler=!1,this.mediaRecorder&&(this.mediaRecorder.onstop=null),this.disconnect(),this.videoContainer&&(this.container.removeChild(this.videoContainer),this.videoContainer=null)}},{key:"encrypt",value:function(e){var t=CryptoJS.enc.Utf8.parse("46cc793c53dc451b"),e=CryptoJS.enc.Utf8.parse(e);return CryptoJS.AES.encrypt(e,t,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7}).toString()}},{key:"decrypt",value:function(e,t){t=new Date((new Date).getTime()-864e5*(t||0)),t="".concat(t.getUTCDate()).concat(t.getUTCMonth()).concat(t.getUTCDay());try{var n=CryptoJS.AES.decrypt(e,"TheQuickBrownFoxJumpsOverTheLazyDog"+t);return JSON.parse(CryptoJS.enc.Utf8.stringify(n).toString())}catch(e){}}},{key:"time_dis",value:function(e){function t(e){return(Array(2).join("0")+e).slice(-2)}var n=(new Date).getTime();if(n<e)return!1;var i=((n+=this.rangeTimeOfPlayed)-e)%864e5,n=Math.floor(i/36e5),e=i%36e5,i=Math.floor(e/6e4),e=Math.floor(e%6e4/1e3);return"".concat(t(n),":").concat(t(i),":").concat(t(e))}},{key:"replay",value:function(e){if(e.startTime>=e.endTime)return this.setError("开始时间不能大于结束时间"),!1;this.config(Object.assign(this.options,{command:"playBackReq",startTime:e.startTime,endTime:e.endTime}))}}]),n}();"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=e:window.Player=e}();